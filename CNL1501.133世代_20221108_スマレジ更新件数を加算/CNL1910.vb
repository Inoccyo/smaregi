' --------------------------------------------------------------------------------
' 　機　　能：店舗内情報システム - サーバメンテナンス(全体制御)
' 　機能概要：省略
' 　引　　数：なし
' 　戻 り 値：なし
' 　履　　歴：2003.08.25 ソラン北陸 新規作成
' --------------------------------------------------------------------------------
Imports System.Data.SqlServerCe
Imports System.Collections.Generic

Module CNL1910

    '------------------------------
    ' 各バックアップ先パス
    '------------------------------
    ' --- (2003.12.09) Public化 - CNL1510で使用 -----------------------------
    Public Const LC_TBLBK_PATH As String = "TableBackup"
    Public Const LC_ITMBK_PATH As String = "ItemImage"
    Public Const LC_ADVBK_PATH As String = "AdvImage"
    Public Const LC_MNUBK_PATH As String = "MenuImage"
    Public Const LC_GRPBK_PATH As String = "GroupImage"
    Public Const LC_STMBK_PATH As String = "StoreMark"
    ' (2004.05.25) 追加　10.4ｲﾝﾁ用画像対応
    Public Const LC_MNUBK2_PATH As String = "MenuImage2"
    Public Const LC_MNUBK3_PATH As String = "MenuImage3"
    ' ----------------------------------------------------------------------

    '------------------------------
    ' 生成画像定数
    '------------------------------
    Private Const LC_SCREEN_WIDTH As Long = 804                             ' フレーム(画面)幅
    Private Const LC_TITLE_WIDTH As Long = 35                               ' 商品グループタイトル文字幅(始端マージンを含む)
    Private Const LC_TITLE_HEIGHT As Long = 19                                ' -(2006.05.20) ジャンル名サイズ変更
    'Private Const LC_TITLE_HEIGHT As Long = 23                              ' 商品グループタイトル文字高(１文字単位)
    Private Const LC_ITEM_WIDTH As Long = 19
    Private Const LC_ITEM_HEIGHT As Long = 15
    ' --- (2004.02.22) 描画領域再調整 --------------------------------------
    'Private Const LC_LEFT_MARGIN As Long = 25
    Private Const LC_LEFT_MARGIN As Long = 10
    ' ----------------------------------------------------------------------
    Private Const LC_RIGHT_MARGIN As Long = 10
    Private Const LC_GROUP_MARGIN As Long = 8                               ' 段組マージン

    '------------------------------------------------------------
    ' 生成画像定数２ ' (2004.05.25) 追加　10.4ｲﾝﾁ用画像対応
    '------------------------------------------------------------
    Private Const LC_SCREEN2_WIDTH As Long = 629                             ' フレーム(画面)幅
    Private Const LC_TITLE2_WIDTH As Long = 35 '22                               ' 商品グループタイトル文字幅(始端マージンを含む
    Private Const LC_TITLE2_HEIGHT As Long = 22  '16                           ' 商品グループタイトル文字高(１文字単位)
    Private Const LC_ITEM2_WIDTH As Long = 27 '19
    Private Const LC_ITEM2_HEIGHT As Long = 18 '12
    Private Const LC_LEFT2_MARGIN As Long = 10
    Private Const LC_RIGHT2_MARGIN As Long = 10
    Private Const LC_GROUP2_MARGIN As Long = 8                               ' 段組マージン
    ' ----------------------------------------------------------------------

    '------------------------------------------------------------
    ' 生成画像定数３ ' (2006.03.10) 追加　8ｲﾝﾁ用画像対応
    '------------------------------------------------------------
    'Private Const LC_SCREEN3_WIDTH As Long = 620                             ' フレーム(画面)幅
    'Private Const LC_TITLE3_WIDTH As Long = 35 '22                               ' 商品グループタイトル文字幅(始端マージンを含む
    'Private Const LC_TITLE3_HEIGHT As Long = 30  '16                           ' 商品グループタイトル文字高(１文字単位)
    'Private Const LC_ITEM3_WIDTH As Long = 27 '19
    'Private Const LC_ITEM3_HEIGHT As Long = 18 '12
    'Private Const LC_LEFT3_MARGIN As Long = 10
    'Private Const LC_RIGHT3_MARGIN As Long = 10
    'Private Const LC_GROUP3_MARGIN As Long = 8                               ' 段組マージン
    '------------------------------------------------------------
    ' 20060606 張本 ADD 生成画像定数３内容を7インチ版に変更
    '------------------------------------------------------------
    'Private Const LC_SCREEN3_WIDTH As Long = 680  '715 772                     ' フレーム(画面)幅
    Private Const LC_SCREEN3_WIDTH As Long = 750  '2006.11.08 　12インチ対応   ' フレーム(画面)幅
    Private Const LC_TITLE3_WIDTH As Long = 40 '22 35                              ' 商品グループタイトル文字幅(始端マージンを含む
    Private Const LC_TITLE3_HEIGHT As Long = 32  '16 30                        ' 商品グループタイトル文字高(１文字単位)
    Private Const LC_ITEM3_WIDTH As Long = 32 '19 27 32
    Private Const LC_ITEM3_HEIGHT As Long = 21 '12 18
    Private Const LC_LEFT3_MARGIN As Long = 10 '10
    Private Const LC_RIGHT3_MARGIN As Long = 10 '10
    Private Const LC_GROUP3_MARGIN As Long = 8 '8                              ' 段組マージン
    ' ----------------------------------------------------------------------

    Public Const GC_STNDLL_PATH As String = "C:\DATA"

    Private Structure typTPD020
        Dim MENUID As String
        Dim MENUBTNID As String
        Dim MENUGRPID As String
        Dim MENUGRPID2 As String
        Dim MENUGRPID3 As String
        Dim MENULV As String
        Dim LINE As String
        Dim REFID As String
        Dim REFGRP As String
        Dim DISPORDER As String
        Dim UPDID As String
        Dim UPDYMD As Date
        Dim SELLKBN As String
    End Structure

    Private Structure typPutVString
        Dim strPutStrings As String
        Dim lngPositionX As Long
        Dim lngCharLower As Long
        Dim objFont As Font
        Dim lngCharHeight As Long
        Dim lngCharWidth As Long
        Dim objColor As System.Drawing.Color
    End Structure

    Private Structure typPutHString
        Dim strPutStrings As String
        Dim lngPositionY As Long
        Dim lngCharLower As Long
        Dim objFont As Font
        Dim lngCharHeight As Long
        Dim lngCharWidth As Long
        Dim objColor As System.Drawing.Color
    End Structure

    Private Enum COPY_PROCKIND
        Backup = 0
        Recovery = 1
    End Enum

    Public Enum typCreateMode
        AllImageCreate = 0
        RealTimeTransfar = 1
        SubDataTransfar = 2
        PreviewCreate = 3
    End Enum

    Private Enum DispType
        SVGA = 0
        XGA = 1
        '更新 8インチ対応追加 ← 張本 7インチもこのまま使用
        VGA = 4
    End Enum

    ' 生成画像のイメージシリアル
    Private L_strTime As String = Format$(Now, "yyyyMMddHHmmss")

    ' 商品マスタ(FUMENU)
    Public Structure typItemData
        Dim str商品コード As String
        Dim str部門コード As String
        Dim str商品名１ As String
        Dim str商品名２ As String
        Dim int単価 As Integer
        Dim intメニュータイプ As ITEM_TYPE
        Dim str出力先ＫＰ As String
        Dim strオプション As String
        Dim strＨＴＬ名称 As String
        '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
        Dim strチケット印字名称 As String
        Dim strＨＴＬ名称5 As String
        '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<
        Dim strメニューコード As String
        Dim str自社コード As String
        Dim int軽減税率単価 As Integer
        Dim intサブ単価 As Integer
        Dim int軽減税率サブ単価 As Integer
        Dim str単価種別 As String
        Dim str税ステータス As String
        Dim str軽減税率税ステータス As String
        Dim str数量加算 As String
        Dim str小計割引割増 As String
        Dim str飲食持帰 As String
        Dim strOESメニュー As String
    End Structure

    ' 2016.2.2 OA) CrossiNavi→TECレジ 原価等保持(FUMENUの値を保持)対応のため追加
    Public Structure typDataFumenu
        Dim str商品コード As String
        Dim str部門コード As String
        Dim str商品名１ As String
        Dim str商品名２ As String
        Dim int単価 As Integer
        Dim intメニュータイプ As ITEM_TYPE
        Dim str出力先ＫＰ As String
        Dim strオプション As String
        Dim strＨＴＬ名称 As String
        '----------------------------------
        Dim str自社コード As String
        Dim intサブ単価 As Integer
        Dim str単価種別 As String
        Dim str税ステータス As String
        Dim str数量加算 As String
        Dim str小計割引割増 As String
        Dim str飲食持帰 As String
        Dim strOESメニュー As String
        '----------------------------------
        Dim byteＰＬＵコード() As Byte '3
        Dim byte商品名カナ() As Byte '4
        Dim byteサブ単価() As Byte  '9
        Dim byte原価() As Byte  '10
        Dim int機能ステータス１ As Integer '11
        Dim int機能ステータス２ As Integer  '12
        Dim int機能ステータス３ As Integer  '13
        Dim byteＫＰ印字優先順位() As Byte  '15
        Dim byte税ステータス() As Byte  '17
        Dim byteKD表示文字色() As Byte  '19
        Dim byteKD表示文字背景色() As Byte  '20
        Dim byteKDオーダー経過時間１() As Byte  '21
        Dim byteKDオーダー経過時間２() As Byte  '22
        Dim byte日計_点数() As Byte '23
        Dim byte日計_金額() As Byte '24
        Dim byte累計_点数() As Byte '25
        Dim byte累計_金額() As Byte '26
    End Structure

    ' ＳＣＰマスタ(FSCP)
    Public Structure typSCPData
        Dim strSCPNo As String
        Dim strガイダンス As String
        Dim str商品コード As String
    End Structure

    Private Const LC_FNAME_FUMENU As String = "FUMENU"
    Private Const LC_FNAME_FSCP As String = "FSCP"

    Public Enum ITEM_TYPE
        MAIN_MENU = 0 '16
        COMMENT_MENU = 1 '17
        SUB_MENU = 2 '18
        SET_MENU = 4 '20
    End Enum

    Public G_Thread As System.Threading.Thread

    Public Enum RECOVERY_PROCKIND
        Recovery = 0
        Import = 1
    End Enum

    '--- (2006.04.18) 飲み放題判定用追加
    Private L_FreeMode As Boolean

    ' --------------------------------------------------------------------------------
    ' 　機　　能：プロジェクト開始処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Public Sub main()
        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objForm As Form = Nothing

        '------------------------------
        ' 重複起動チェック
        '------------------------------
        If UBound(Diagnostics.Process.GetProcessesByName(Diagnostics.Process.GetCurrentProcess.ProcessName)) > 0 Then
            '--- (2006.05.23) AP名変更 -----------------------------------------------------------------------
            MsgBox("既に起動中です", MsgBoxStyle.OKOnly + MsgBoxStyle.Exclamation, "CrossNavi")
            'MsgBox("既に起動中です", MsgBoxStyle.OKOnly + MsgBoxStyle.Exclamation, "店舗内情報システム")
            '-------------------------------------------------------------------------------------------------
            Exit Sub
        End If

        '------------------------------
        ' ＤＢ接続処理
        '------------------------------
        With g_udtAppConfig
            .strDBServerName = System.Configuration.ConfigurationManager.AppSettings("DBServer Name")
            .strDBServerDBName = System.Configuration.ConfigurationManager.AppSettings("DBServer DBName")
            .strDBServerUserID = System.Configuration.ConfigurationManager.AppSettings("DBServer UserID")
            .strDBServerPassWD = System.Configuration.ConfigurationManager.AppSettings("DBServer PassWD")
        End With

        Do Until GF_ConnectDB(g_udtAppConfig.strDBServerName, _
                              g_udtAppConfig.strDBServerDBName, _
                              g_udtAppConfig.strDBServerUserID, _
                              g_udtAppConfig.strDBServerPassWD)

            'If MsgBox("データベースへの接続に失敗しました。設定を見直して下さい。", _
            '          MsgBoxStyle.OKOnly + MsgBoxStyle.Information) = MsgBoxResult.Yes Then
            '    objForm = New CNL1820()
            '    objForm.ShowDialog()
            '    Exit Sub
            'Else
            '    GoTo SYSTEM_ERROR
            'End If
            '--- (2006.05.23) AP名変更 ---------------------------------------------------------------
            Call MsgBox("データベースへの接続に失敗しました。設定を見直して下さい。", _
                        MsgBoxStyle.OKOnly + MsgBoxStyle.Information, "CrossNavi")
            'Call MsgBox("データベースへの接続に失敗しました。設定を見直して下さい。", _
            '            MsgBoxStyle.OKOnly + MsgBoxStyle.Information, "店舗内情報システム")
            '-----------------------------------------------------------------------------------------
            Exit Sub
        Loop

        '------------------------------
        ' ＡＰ設定情報取得
        '------------------------------
        ' 張本 ADD MENUIMG3(8インチ)のものを7インチでも使用
        With g_udtAppConfig
            .strAppName = GF_GetAppInfo("AP_NAME")
            .strAppVersion = GF_GetAppInfo("AP_VER")
            .strAppComment = GF_GetAppInfo("AP_COMMENT")
            .strAppPath = GF_GetAppInfo("AP_PATH")
            .strTempPath = GF_GetAppInfo("TEMP_PATH")
            .strImpPath = GF_GetAppInfo("PHOTO_PATH")
            .strAdvPath = GF_GetAppInfo("ADV_PATH")
            .strImgPath = GF_GetAppInfo("ITEM_PATH")
            .strBKPath = GF_GetAppInfo("BK_PATH")
            .strTIPath = GF_GetAppInfo("TBLINFO_PATH")
            .strWebPath = ""
            .strMenuImgPath = GF_GetAppInfo("MENUIMG_V")
            .strMenuImgPath2 = GF_GetAppInfo("MENUIMG_V2")                  ' 2004/05/25追加
            .strMenuImgPath3 = GF_GetAppInfo("MENUIMG_V3")                  ' 2006/03/10追加
            .strMenuImgTemp = GF_GetAppInfo("MENUIMG_TEMP")
            .strNMImgPath = GF_GetAppInfo("NMIMG")
            .strNMImgPath2 = GF_GetAppInfo("NMIMG2")                        ' 2004/05/25追加
            .strNMImgPath3 = GF_GetAppInfo("NMIMG3")                        ' 2004/05/25追加
            .strOMImgPath = GF_GetAppInfo("OMIMG")
            .strOMImgPath2 = GF_GetAppInfo("OMIMG2")                        ' 2004/05/25追加
            .strOMImgPath3 = GF_GetAppInfo("OMIMG3")                        ' 2006/03/10追加
            If Not LF_GetBKConfig(g_udtAppConfig) Then                      ' 取得元が TPM040 のため、別関数定義にて取得する
                GoTo SYSTEM_ERROR
            End If
        End With

        '------------------------------
        ' スタートアップフォーム表示
        '------------------------------
        objForm = New CNL2010()
        objForm.ShowDialog()

        '------------------------------
        ' ＤＢ切断処理
        '------------------------------
        Call GF_DisConnectDB(G_objConnect)

        Exit Sub

SYSTEM_ERROR:
        '--- (2006.05.23) AP名変更 --------------------------------------------
        MsgBox(GC_MSG01, MsgBoxStyle.Exclamation + MsgBoxStyle.OKOnly, "CrossNavi")
        'MsgBox(GC_MSG01, MsgBoxStyle.Exclamation + MsgBoxStyle.OKOnly)
    End Sub

    Private Function LF_GetBKConfig(ByRef pConfig As typAppConfig) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_GetBKConfig = False

        '------------------------------
        ' システム管理マスタ取得
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT BK_MAXDAY, BK_MAXTIME"
        strSQL = strSQL & "  FROM TPM040"
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If
        If objData.Tables("com").Rows.Count = 0 Then
            Exit Function
        End If
        If Not GF_GetRows(objData, 0, objRows) Then
            Exit Function
        End If

        '------------------------------
        ' 設定値設定
        '------------------------------
        pConfig.strBK_MaxDay = Trim$(objRows("BK_MAXDAY"))
        pConfig.strBK_MaxTime = Trim$(objRows("BK_MAXTIME"))

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_GetBKConfig = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：バックアップ処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Public Function GF_Backup(ByVal pComment As String, Optional ByVal pTargetFld As String = "", Optional ByVal pMsgID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTragetFld As String
        Dim strFld As String
        Dim strBKFld As String = Nothing
        Dim strPathAry() As String
        Dim strSubFld() As String
        Dim lngPathCnt As Long
        Dim objStatus As New CNL1810()
        Dim objLog As System.IO.StreamWriter

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_Backup = False

        '------------------------------
        ' バックアップ先フォルダ特定
        '------------------------------
        If Len(Trim$(pTargetFld)) = 0 Then
            '------------------------------
            ' 親フォルダ特定
            '------------------------------
            Try
                strPathAry = System.IO.Directory.GetDirectories(g_udtAppConfig.strBKPath)
                lngPathCnt = 0
                For Each strFld In strPathAry
                    If g_udtAppConfig.strBKPath & "\" & Format$(Now, "yyyyMMdd") = strFld Then
                        strBKFld = strFld
                    End If
                Next
                If Len(Trim$(strBKFld)) = 0 Then
                    strBKFld = g_udtAppConfig.strBKPath & "\" & Format$(Now, "yyyyMMdd")
                    System.IO.Directory.CreateDirectory(strBKFld)

                    ' 最大保持期限を超えたバックアップデータを削除する
                    strSubFld = System.IO.Directory.GetDirectories(g_udtAppConfig.strBKPath)
                    Array.Sort(strSubFld)
                    If UBound(strSubFld) >= CLng(g_udtAppConfig.strBK_MaxDay) Then
                        For lngPathCnt = 0 To (UBound(strSubFld) - CLng(g_udtAppConfig.strBK_MaxDay))
                            Call GS_DelFiles(strSubFld(lngPathCnt))
                        Next
                    End If
                End If

                '------------------------------
                ' 子フォルダ特定
                '------------------------------
                strTragetFld = strBKFld & "\" & Format$(Now, "yyyyMMddHHmmss")
                System.IO.Directory.CreateDirectory(strTragetFld)

                ' 最大保持回数を超えたバックアップデータを削除する
                strSubFld = System.IO.Directory.GetDirectories(strBKFld)
                Array.Sort(strSubFld)
                If UBound(strSubFld) >= CLng(g_udtAppConfig.strBK_MaxTime) Then
                    For lngPathCnt = 0 To (UBound(strSubFld) - CLng(g_udtAppConfig.strBK_MaxTime))
                        Call GS_DelFiles(strSubFld(lngPathCnt))
                    Next
                End If
            Catch
                Exit Function
            End Try
            If Len(Trim$(strTragetFld)) = 0 Then
                Exit Function
            End If
        Else
            strTragetFld = pTargetFld
        End If

        '------------------------------
        ' 進捗状況通知フォーム表示
        '------------------------------
        objStatus.Show()
        With objStatus
            If Len(Trim$(pMsgID)) = 0 Then
                .lbl_Msg.Text = "バックアップ処理中です。しばらくお待ちください..."
            Else
                .lbl_Msg.Text = GF_GetMsg(pMsgID)
            End If
            '.pgs_Status.Maximum = 100
            ' 更新 2006/03/10 進捗ステータスバー最大値変更
            .pgs_Status.Maximum = 120
            .pgs_Status.Minimum = 0
            .pgs_Status.Value = 0
            .TopMost = True
        End With
        System.Windows.Forms.Application.DoEvents()

        '------------------------------
        ' テーブル退避処理
        '------------------------------
        If Not LF_TableBackup(strTragetFld, objStatus) Then
            Exit Function
        End If

        '------------------------------
        ' 画像ファイル退避処理
        '------------------------------
        If Not LF_ImageBackup(strTragetFld, objStatus) Then
            Exit Function
        End If

        '------------------------------
        ' ログファイル出力
        '------------------------------
        objLog = New System.IO.StreamWriter(strTragetFld & "\" & GC_BKLOG_NM, False, System.Text.Encoding.Default)
        With objLog
            .Write(Now & vbTab & pComment & vbTab & g_udtAppConfig.strAppVersion)
            .Close()
        End With

        If Not IsNothing(strBKFld) Then
            If System.IO.File.Exists(strBKFld & "\" & GC_BKLOG_NM) = False Then
                objLog = New System.IO.StreamWriter(strBKFld & "\" & GC_BKLOG_NM, False, System.Text.Encoding.Default)
                With objLog
                    .Write(Now & vbTab)
                    .Close()
                End With
            End If
        End If

        '------------------------------
        ' 進捗状況フォーム非表示
        '------------------------------
        With objStatus
            .Close()
            .Dispose()
        End With

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_Backup = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：バックアップ先パス 取得処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_GetTargetFld() As String

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTragetFld As String
        Dim strFld As String
        Dim strBKFld As String = Nothing
        Dim strPathAry() As String
        Dim strSubFld() As String
        Dim lngPathCnt As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_GetTargetFld = ""

        '------------------------------
        ' 親フォルダ特定
        '------------------------------
        Try
            strPathAry = System.IO.Directory.GetDirectories(g_udtAppConfig.strBKPath)
            lngPathCnt = 0
            For Each strFld In strPathAry
                If g_udtAppConfig.strBKPath & "\" & Format$(Now, "yyyyMMdd") = strFld Then
                    strBKFld = strFld
                End If
            Next
            If Len(Trim$(strBKFld)) = 0 Then
                strBKFld = g_udtAppConfig.strBKPath & "\" & Format$(Now, "yyyyMMdd")
                System.IO.Directory.CreateDirectory(strBKFld)

                ' 最大保持期限を超えたバックアップデータを削除する
                strSubFld = System.IO.Directory.GetDirectories(g_udtAppConfig.strBKPath)
                Array.Sort(strSubFld)
                If UBound(strSubFld) >= CLng(g_udtAppConfig.strBK_MaxDay) Then
                    For lngPathCnt = 0 To (UBound(strSubFld) - CLng(g_udtAppConfig.strBK_MaxDay))
                        Call GS_DelFiles(strSubFld(lngPathCnt))
                    Next
                End If
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 子フォルダ特定
        '------------------------------
        Try
            strTragetFld = strBKFld & "\" & Format$(Now, "yyyyMMddHHmmss")
            System.IO.Directory.CreateDirectory(strTragetFld)

            ' 最大保持回数を超えたバックアップデータを削除する
            strSubFld = System.IO.Directory.GetDirectories(strBKFld)
            Array.Sort(strSubFld)
            If UBound(strSubFld) >= CLng(g_udtAppConfig.strBK_MaxTime) Then
                For lngPathCnt = 0 To (UBound(strSubFld) - CLng(g_udtAppConfig.strBK_MaxTime))
                    Call GS_DelFiles(strSubFld(lngPathCnt))
                Next
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_GetTargetFld = strTragetFld

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：テーブル退避処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_TableBackup(ByVal pTargetPath As String, ByVal pStsForm As CNL1810) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim intProcID As Integer
        Dim strCmdLine As String
        Dim lngIniVal As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_TableBackup = False
        lngIniVal = pStsForm.pgs_Status.Value

        '------------------------------
        ' 全テーブル一覧取得
        '------------------------------
        Try
            If System.IO.Directory.Exists(pTargetPath & "\" & LC_TBLBK_PATH) = False Then
                System.IO.Directory.CreateDirectory(pTargetPath & "\" & LC_TBLBK_PATH)
            End If

            ' --- (2003.12.02) TPM030/TPM070/TPM090 は処理対象外とする -----
            'strSQL = "SELECT NAME FROM SYSOBJECTS WHERE NAME LIKE 'TP%'"
            strSQL = ""
            strSQL = strSQL & "SELECT NAME"
            strSQL = strSQL & "  FROM SYSOBJECTS"
            strSQL = strSQL & " WHERE NAME LIKE 'TP%'"

            ' --- (2004.07.05) TPM030は処理対象とする ----------------------
            'strSQL = strSQL & "   AND NAME NOT IN ('TPM030', 'TPM070', 'TPM090')"
            strSQL = strSQL & "   AND NAME NOT IN ('TPM070', 'TPM090')"
            ' --------------------------------------------------------------

            ' --------------------------------------------------------------
            If Not GF_GetData(strSQL, objData) Then
                Exit Function
            End If
            lngCnt = 0
            While lngCnt < objData.Tables("com").Rows.Count
                If Not GF_GetRows(objData, lngCnt, objRows) Then
                    Exit Function
                End If

                strCmdLine = ""
                strCmdLine = strCmdLine & "BCP"
                strCmdLine = strCmdLine & " " & g_udtAppConfig.strDBServerDBName & ".." & Trim$(objRows("NAME"))   ' 退避テーブル名
                strCmdLine = strCmdLine & " out"                                ' エクスポート指定
                strCmdLine = strCmdLine & " " & pTargetPath & "\" & LC_TBLBK_PATH & "\" & _
                                                Trim$(objRows("NAME")) & ".txt" ' 退避ファイル名
                strCmdLine = strCmdLine & " -S " & g_udtAppConfig.strDBServerName
                strCmdLine = strCmdLine & " -U " & g_udtAppConfig.strDBServerUserID
                strCmdLine = strCmdLine & " -P " & g_udtAppConfig.strDBServerPassWD
                strCmdLine = strCmdLine & " -c -t ,"
                Debug.WriteLine(strCmdLine)
                intProcID = Shell("cmd.exe /C " & strCmdLine, AppWinStyle.Hide, True)
                If intProcID <> 0 Then
                    Exit Function
                End If

                lngCnt = lngCnt + 1
                pStsForm.pgs_Status.Value = lngIniVal + (30 / objData.Tables("com").Rows.Count) * lngCnt
            End While
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_TableBackup = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：画像退避処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_ImageBackup(ByVal pTargetPath As String, ByVal pStsForm As CNL1810) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngIniVal As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ImageBackup = False
        lngIniVal = pStsForm.pgs_Status.Value

        Try
            '------------------------------
            ' 商品画像ファイル退避
            '------------------------------
            If Not LF_ImageCopy(GF_GetAppInfo("ITEMIMG_V"), pTargetPath & "\" & LC_ITMBK_PATH, 14, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If
            If Not LF_ImageCopy(GF_GetAppInfo("ADV_PATH"), pTargetPath & "\" & LC_ADVBK_PATH, 14, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If

            ' --- (2004.05.10) バックアップ元フォルダ変更 ---
            'If Not LF_ImageCopy(GF_GetAppInfo("MENUIMG_V"), pTargetPath & "\" & LC_MNUBK_PATH, 14, pStsForm, COPY_PROCKIND.Backup) Then
            '    Exit Function
            'End If
            If Not LF_ImageCopy(GF_GetAppInfo("NMIMG"), pTargetPath & "\" & LC_MNUBK_PATH, 7, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If
            If Not LF_ImageCopy(GF_GetAppInfo("NMIMG2"), pTargetPath & "\" & LC_MNUBK2_PATH, 7, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If
            ' -----------------------------------------------

            '更新 2006/03/10 8インチ画像用フォルダパス追加
            If Not LF_ImageCopy(GF_GetAppInfo("NMIMG3"), pTargetPath & "\" & LC_MNUBK3_PATH, 7, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If
            If Not LF_ImageCopy(GF_GetAppInfo("GROUP_PATH"), pTargetPath & "\" & LC_GRPBK_PATH, 14, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If
            If Not LF_ImageCopy(GF_GetAppInfo("STOREMARK_V"), pTargetPath & "\" & LC_STMBK_PATH, 14, pStsForm, COPY_PROCKIND.Backup) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ImageBackup = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：ファイル転送処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_ImageCopy(ByVal pSourceFld As String, _
                                  ByVal pTargetFld As String, _
                                  ByVal pPercent As Long, _
                                  ByVal objStatus As CNL1810, _
                                  ByVal pProcKind As COPY_PROCKIND) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strFile As String
        Dim strWork() As String
        Dim strTFile As String
        Dim lngCnt As Long
        Dim lngMaxCnt As Long
        Dim lngIniVal As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ImageCopy = False
        lngCnt = 0
        lngMaxCnt = 0
        lngIniVal = objStatus.pgs_Status.Value

        Try
            '------------------------------
            ' 転送先フォルダ存在チェック
            '------------------------------
            If System.IO.Directory.Exists(pTargetFld) = False Then
                System.IO.Directory.CreateDirectory(pTargetFld)
            End If

            '------------------------------
            ' 転送元フォルダ存在チェック
            '------------------------------
            If System.IO.Directory.Exists(pSourceFld) = False Then
                Exit Function
            End If

            ' 進捗状況通知のため、全ファイル数をカウントする
            For Each strFile In System.IO.Directory.GetFiles(pSourceFld, "*.*")
                lngMaxCnt = lngMaxCnt + 1
            Next

            '------------------------------
            ' ファイル転送処理
            '------------------------------
            For Each strFile In System.IO.Directory.GetFiles(pSourceFld, "*.*")
                strWork = Split(strFile, "\")
                strTFile = pTargetFld & "\" & strWork(UBound(strWork))
                If System.IO.File.Exists(strTFile) = True Then                  ' 転送先に、同一ファイル名が存在した場合は削除する
                    System.IO.File.SetAttributes(strTFile, IO.FileAttributes.Normal)
                    System.IO.File.Delete(strTFile)
                End If
                System.IO.File.Copy(strFile, strTFile)
                lngCnt = lngCnt + 1
                objStatus.pgs_Status.Value = lngIniVal + (pPercent / lngMaxCnt) * lngCnt
            Next

            If lngMaxCnt = 0 Then
                objStatus.pgs_Status.Value = lngIniVal + pPercent
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ImageCopy = True
    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：リカバリ処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Public Function GF_Recovery(ByVal pSourceFld As String, Optional ByVal pMsgID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFile As System.IO.StreamReader
        Dim strFLine As String
        Dim strWork() As String
        Dim objStatus As New CNL1810()

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_Recovery = False

        '------------------------------
        ' ログファイル取得
        '------------------------------
        If Len(Trim$(pSourceFld)) = 0 Then
            Exit Function
        Else
            If System.IO.File.Exists(pSourceFld & "\" & GC_BKLOG_NM) = False Then
                Exit Function
            Else
                objFile = New System.IO.StreamReader(pSourceFld & "\" & GC_BKLOG_NM, System.Text.Encoding.Default)
                strFLine = objFile.ReadLine
                objFile.Close()
                If Len(Trim$(strFLine)) = 0 Then
                    Exit Function
                Else
                    strWork = Split(strFLine, vbTab)
                End If
            End If
        End If

        '------------------------------
        ' バージョン情報確認
        '------------------------------
        If strWork(2) <> g_udtAppConfig.strAppVersion Then
            Exit Function
        End If

        '------------------------------
        ' 進捗状況通知フォーム表示
        '------------------------------
        objStatus.Show()
        With objStatus
            If Len(Trim$(pMsgID)) = 0 Then
                .lbl_Msg.Text = "リカバリ処理中です。しばらくお待ちください..."
            Else
                .lbl_Msg.Text = GF_GetMsg(pMsgID)
            End If
            '.pgs_Status.Maximum = 100
            '更新　2006/03/10 進捗ステータスバー最大値変更
            .pgs_Status.Maximum = 120
            .pgs_Status.Minimum = 0
            .pgs_Status.Value = 0
            .TopMost = True
        End With
        System.Windows.Forms.Application.DoEvents()

        '------------------------------
        ' 画像ファイル復元処理
        '------------------------------
        If Not LF_ImageRecovery(pSourceFld, objStatus) Then
            Exit Function
        End If

        '------------------------------
        ' テーブル復元処理
        '------------------------------
        If Not LF_TableRecovery(pSourceFld, objStatus) Then
            Exit Function
        End If

        '------------------------------
        ' 進捗状況フォーム非表示
        '------------------------------
        With objStatus
            .Close()
            .Dispose()
        End With

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_Recovery = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：テーブル退避処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_TableRecovery(ByVal pSourcePath As String, ByVal pStsForm As CNL1810) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim intProcID As Integer
        Dim strCmdLine As String
        Dim strImpFile As String
        Dim lngIniVal As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_TableRecovery = False
        lngIniVal = pStsForm.pgs_Status.Value

        '------------------------------
        ' 全テーブル一覧取得
        '------------------------------
        Try
            If System.IO.Directory.Exists(pSourcePath & "\" & LC_TBLBK_PATH) = False Then
                Exit Function
            Else

                ' --- (2003.12.02) TPM030/TPM070/TPM090 は処理対象外とする -----
                'strSQL = "SELECT NAME FROM SYSOBJECTS WHERE NAME LIKE 'TP%'"
                strSQL = ""
                strSQL = strSQL & "SELECT NAME"
                strSQL = strSQL & "  FROM SYSOBJECTS"
                strSQL = strSQL & " WHERE NAME LIKE 'TP%'"
                'strSQL = strSQL & "   AND NAME NOT IN ('TPM030', 'TPM070', 'TPM090')"
                strSQL = strSQL & "   AND NAME NOT IN ('TPM070', 'TPM090')"
                ' --------------------------------------------------------------

                If Not GF_GetData(strSQL, objData) Then
                    Exit Function
                End If
                lngCnt = 0
                While lngCnt < objData.Tables("com").Rows.Count
                    If Not GF_GetRows(objData, lngCnt, objRows) Then
                        Exit Function
                    End If

                    strImpFile = pSourcePath & "\" & LC_TBLBK_PATH & "\" & Trim$(objRows("NAME")) & ".txt"
                    If System.IO.File.Exists(strImpFile) = False Then
                        Exit Function
                    Else

                        strSQL = ""
                        strSQL = "DELETE FROM " & Trim$(objRows("NAME"))
                        If Not GF_UpdData(strSQL) Then
                            Exit Function
                        End If

                        strCmdLine = ""
                        strCmdLine = strCmdLine & "BCP"
                        strCmdLine = strCmdLine & " " & g_udtAppConfig.strDBServerDBName & ".." & Trim$(objRows("NAME"))   ' 退避テーブル名
                        strCmdLine = strCmdLine & " in"                                 ' インポート指定
                        strCmdLine = strCmdLine & " " & strImpFile                      ' 退避ファイル名
                        strCmdLine = strCmdLine & " -S " & g_udtAppConfig.strDBServerName
                        strCmdLine = strCmdLine & " -U " & g_udtAppConfig.strDBServerUserID
                        strCmdLine = strCmdLine & " -P " & g_udtAppConfig.strDBServerPassWD
                        strCmdLine = strCmdLine & " -c -t ,"
                        intProcID = Shell("cmd.exe /C " & strCmdLine, AppWinStyle.Hide, True)
                        If intProcID <> 0 Then
                            Exit Function
                        End If
                    End If

                    lngCnt = lngCnt + 1
                    pStsForm.pgs_Status.Value = lngIniVal + (30 / objData.Tables("com").Rows.Count) * lngCnt
                End While
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_TableRecovery = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：画像退避処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_ImageRecovery(ByVal pSourcePath As String, ByVal pStsForm As CNL1810) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngIniVal As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ImageRecovery = False
        lngIniVal = pStsForm.pgs_Status.Value

        Try
            If Not LF_ImageCopy(pSourcePath & "\" & LC_ITMBK_PATH, GF_GetAppInfo("ITEMIMG_V"), 17, pStsForm, COPY_PROCKIND.Recovery) Then
                Exit Function
            End If
            If Not LF_ImageCopy(pSourcePath & "\" & LC_ADVBK_PATH, GF_GetAppInfo("ADV_PATH"), 17, pStsForm, COPY_PROCKIND.Recovery) Then
                Exit Function
            End If

            ' --- (2004.05.26) 処理廃止 ---
            'If Not LF_ImageCopy(pSourcePath & "\" & LC_MNUBK_PATH, GF_GetAppInfo("MENUIMG_V"), 14, pStsForm, COPY_PROCKIND.Recovery) Then
            '    Exit Function
            'End If
            ' -----------------------------

            If Not LF_ImageCopy(pSourcePath & "\" & LC_GRPBK_PATH, GF_GetAppInfo("GROUP_PATH"), 17, pStsForm, COPY_PROCKIND.Recovery) Then
                Exit Function
            End If
            If Not LF_ImageCopy(pSourcePath & "\" & LC_STMBK_PATH, GF_GetAppInfo("STOREMARK_V"), 19, pStsForm, COPY_PROCKIND.Recovery) Then
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ImageRecovery = True

    End Function

    Private Function LF_MenuImgTempDEL() As Boolean

        Dim strFileNm As String

        LF_MenuImgTempDEL = False

        Try
            For Each strFileNm In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgTemp, "*.jpg")
                System.IO.File.SetAttributes(strFileNm, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNm)
            Next

            For Each strFileNm In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgTemp, "*.gif")
                System.IO.File.SetAttributes(strFileNm, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNm)
            Next
        Catch
            Exit Function
        End Try

        LF_MenuImgTempDEL = True

    End Function

    Private Function LF_MenuImgTempRecv() As Boolean

        Dim strFileNm As String
        Dim strWork() As String

        LF_MenuImgTempRecv = False

        Try
            For Each strFileNm In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgPath, "*.jpg")
                System.IO.File.SetAttributes(strFileNm, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNm)
            Next

            For Each strFileNm In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgTemp, "*.jpg")
                strWork = Split(strFileNm, "\")
                System.IO.File.Move(strFileNm, g_udtAppConfig.strMenuImgPath & "\" & strWork(UBound(strWork)))
            Next

            For Each strFileNm In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgPath, "*.gif")
                System.IO.File.SetAttributes(strFileNm, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNm)
            Next

            For Each strFileNm In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgTemp, "*.gif")
                strWork = Split(strFileNm, "\")
                System.IO.File.Move(strFileNm, g_udtAppConfig.strMenuImgPath & "\" & strWork(UBound(strWork)))
            Next
        Catch
            Exit Function
        End Try

        LF_MenuImgTempRecv = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Public Function GF_CreateMenuImage(Optional ByVal pMsgID As String = "", _
                                       Optional ByVal pMenuID As String = "", _
                                       Optional ByVal pCreateMode As typCreateMode = typCreateMode.AllImageCreate, _
                                       Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String
        Dim objData As New DataSet()
        Dim objData2 As New DataSet()
        Dim objData3 As New DataSet()
        Dim objData4 As New DataSet()                                       ' --- (2004.02.04) ネタケース対応 ---
        Dim objStatus As New CNL1810()

        ' --- (2004.05.25) 10.4ｲﾝﾁ画面対応 ---
        Dim objData5 As New DataSet()
        Dim objData6 As New DataSet()
        Dim objData7 As New DataSet()
        Dim objData8 As New DataSet()
        ' ------------------------------------

        ' --- (2006.04.05) 飲み放題メニュー対応 --
        Dim objData9 As New DataSet()
        Dim objData10 As New DataSet()
        Dim objData11 As New DataSet()
        Dim objData12 As New DataSet()
        ' ----------------------------------------

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_CreateMenuImage = False
        L_strTime = Format$(Now, "yyyyMMddHHmmss")
        '-- (2006.04.18) 飲み放題対応
        L_FreeMode = False

        '------------------------------
        ' 初期処理
        '------------------------------
        If Not GF_BeginTrans() Then                                         ' トランザクション開始宣言
            Exit Function
        End If

        '------------------------------
        ' 生成画像管理テーブル削除処理
        '------------------------------
        If pCreateMode <> typCreateMode.RealTimeTransfar And _
           pCreateMode <> typCreateMode.SubDataTransfar Then
            If Not LF_DelOldImage() Then
                Exit Function
            End If
        End If

        objStatus.Show()                                                    ' 進捗ステータスフォーム表示
        With objStatus
            If Len(Trim$(pMsgID)) = 0 Then
                .lbl_Msg.Text = "メニュー生成処理中です。しばらくお待ちください..."
            Else
                .lbl_Msg.Text = GF_GetMsg(pMsgID)
            End If
            .pgs_Status.Minimum = 0
            .pgs_Status.Value = 0
            .TopMost = True
        End With
        System.Windows.Forms.Application.DoEvents()

        '------------------------------
        ' メニューデータ抽出処理
        '------------------------------
        If Len(Trim$(pMenuID)) = 0 Then
            If Not LF_GetMenuData(objData, GC_ORDER_GROUP) Then
                Exit Function
            End If
            If Not LF_GetMenuData(objData2, GC_ORDER_PRICE) Then
                Exit Function
            End If
            If Not LF_GetMenuData(objData3, GC_ORDER_NONE) Then
                Exit Function
            End If
            If Not LF_GetMenuData(objData4, GC_ORDER_CASE) Then
                Exit Function
            End If
        Else
            If Not LF_GetMenuData(objData, GC_ORDER_GROUP, pMenuID) Then
                Exit Function
            End If
            If Not LF_GetMenuData(objData2, GC_ORDER_PRICE, pMenuID) Then
                Exit Function
            End If
            If Not LF_GetMenuData(objData3, GC_ORDER_NONE, pMenuID) Then
                Exit Function
            End If
            If Not LF_GetMenuData(objData4, GC_ORDER_CASE, pMenuID) Then
                Exit Function
            End If
        End If
        'objStatus.pgs_Status.Maximum = (objData.Tables("com").Rows.Count * 2) + _
        '                               (objData2.Tables("com").Rows.Count * 2) + _
        '                               (objData3.Tables("com").Rows.Count * 2) + _
        '                               (objData4.Tables("com").Rows.Count * 2) + _
        '                               (25 * 2)
        '更新 2006/03/10 進捗ステータスバー変更に伴う更新
        objStatus.pgs_Status.Maximum = (objData.Tables("com").Rows.Count * 3) + _
                                       (objData2.Tables("com").Rows.Count * 3) + _
                                       (objData3.Tables("com").Rows.Count * 3) + _
                                       (objData4.Tables("com").Rows.Count * 3) + _
                                       (25 * 3)

        '------------------------------
        ' 商品グループ毎メニュー生成
        '------------------------------
        If objData.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_1(objData, objStatus, pCreateMode, pRMenuID) Then              ' 商品グループ画像生成処理
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------
        ' 単価毎メニュー生成
        '------------------------------
        If objData2.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_1(objData2, objStatus, pCreateMode, pRMenuID) Then             ' 商品グループ画像生成処理
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------
        ' 商品グループ未使用メニュー生成
        '------------------------------
        If objData3.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_2(objData3, objStatus, pCreateMode, pRMenuID) Then               ' 単品画像生成処理
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------
        ' ネタケースメニュー生成
        '------------------------------
        If objData4.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_3(objData4, objStatus, pCreateMode, pRMenuID) Then
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------
        ' 素材画像生成処理
        '------------------------------
        If Not LF_CreateMaterials(objStatus, pCreateMode, pMenuID, pRMenuID) Then
            GoTo SYSTEM_ERROR
        End If


        '★修正箇所 --- 2006.10.20 

        '------------------------------------
        ' 更新 2006/07/11 800×600版　保留 
        '------------------------------------
        '------------------------------------
        ' 商品グループ毎メニュー生成 (SVGA)
        '------------------------------------
        If objData.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_4(objData, objStatus, pCreateMode, pRMenuID) Then              ' 商品グループ画像生成処理
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------------
        ' 単価毎メニュー生成 (SVGA)
        '------------------------------------
        If objData2.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_4(objData2, objStatus, pCreateMode, pRMenuID) Then             ' 商品グループ画像生成処理
                GoTo SYSTEM_ERROR
            End If
        End If

        '----------------------------------------
        '商品グループ未使用メニュー生成 (SVGA)
        '----------------------------------------
        If objData3.Tables("com").Rows.Count > 0 Then
            If Not LF_CreateMenu_5(objData3, objStatus, pCreateMode, "0", pRMenuID) Then              ' 単品画像生成処理
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------------
        'ネタケースメニュー生成 (SVGA)
        '------------------------------------
        If objData4.Tables("com").Rows.Count > 0 Then
            'If Not LF_CreateMenu_6(objData4, objStatus, pCreateMode, pRMenuID) Then
            '修正 2006.10.18
            If Not LF_CreateMenu_5(objData4, objStatus, pCreateMode, "1", pRMenuID) Then
                GoTo SYSTEM_ERROR
            End If
        End If

        '------------------------------
        ' 素材画像生成処理 (SVGA)
        '------------------------------
        If Not LF_CreateMaterials_2(objStatus, pCreateMode, pMenuID, pRMenuID) Then
            GoTo SYSTEM_ERROR
        End If

        '★コメント解除 ---


        '------------------------------------
        ' 更新 2006/03/10 8インチ用に追加 
        '------------------------------------
        ' 商品グループ毎メニュー生成 (VGA)
        '------------------------------------
        ''If objData.Tables("com").Rows.Count > 0 Then
        ''    If Not LF_CreateMenu_7(objData, objStatus, pCreateMode, pRMenuID) Then              ' 商品グループ画像生成処理
        ''        GoTo SYSTEM_ERROR
        ''    End If
        ''End If

        ''------------------------------------
        '' 単価毎メニュー生成 (VGA)
        ''------------------------------------
        ''If objData2.Tables("com").Rows.Count > 0 Then
        ''    If Not LF_CreateMenu_7(objData2, objStatus, pCreateMode, pRMenuID) Then             ' 商品グループ画像生成処理
        ''        GoTo SYSTEM_ERROR
        ''    End If
        ''End If

        ''----------------------------------------
        ''商品グループ未使用メニュー生成 (VGA)
        ''----------------------------------------
        ''If objData3.Tables("com").Rows.Count > 0 Then
        ''    If Not LF_CreateMenu_8(objData3, objStatus, pCreateMode, "0", pRMenuID) Then              ' 単品画像生成処理
        ''        GoTo SYSTEM_ERROR
        ''    End If
        ''End If

        ''------------------------------------
        ''ネタケースメニュー生成 (VGA)
        ''------------------------------------
        ''If objData4.Tables("com").Rows.Count > 0 Then
        ''    If Not LF_CreateMenu_8(objData4, objStatus, pCreateMode, "1", pRMenuID) Then
        ''        GoTo SYSTEM_ERROR
        ''    End If
        ''End If

        ''------------------------------
        '' 素材画像生成処理 (VGA)
        ''------------------------------
        ''If Not LF_CreateMaterials_3(objStatus, pCreateMode, pMenuID, pRMenuID) Then
        ''    GoTo SYSTEM_ERROR
        ''End If

        '------------------------------------
        ' 更新 2006/03/10 7インチ用に追加 
        '------------------------------------
        '商品グループ毎メニュー生成(VGA)
        ''------------------------------------
        'If objData.Tables("com").Rows.Count > 0 Then
        '    If Not LF_CreateMenu_13(objData, objStatus, pCreateMode, pRMenuID) Then              ' 商品グループ画像生成処理 既存lf_createmenu_7
        '        GoTo SYSTEM_ERROR
        '    End If
        'End If

        ''------------------------------------
        '' 単価毎メニュー生成 (VGA)
        ''------------------------------------
        'If objData2.Tables("com").Rows.Count > 0 Then
        '    If Not LF_CreateMenu_13(objData2, objStatus, pCreateMode, pRMenuID) Then             ' 商品グループ画像生成処理 既存lf_createmenu_7
        '        GoTo SYSTEM_ERROR
        '    End If
        'End If

        ''----------------------------------------
        ''商品グループ未使用メニュー生成 (VGA)
        ''----------------------------------------
        'If objData3.Tables("com").Rows.Count > 0 Then
        '    If Not LF_CreateMenu_14(objData3, objStatus, pCreateMode, "0", pRMenuID) Then              ' 単品画像生成処理 既存lf_createmenu_8
        '        GoTo SYSTEM_ERROR
        '    End If
        'End If

        ''------------------------------------
        ''ネタケースメニュー生成 (VGA)
        ''------------------------------------
        'If objData4.Tables("com").Rows.Count > 0 Then
        '    If Not LF_CreateMenu_14(objData4, objStatus, pCreateMode, "1", pRMenuID) Then               '既存lf_createmenu_8
        '        GoTo SYSTEM_ERROR
        '    End If
        'End If

        ''''------------------------------
        '''' 素材画像生成処理 (VGA)
        ''''------------------------------
        'If Not LF_CreateMaterials_5(objStatus, pCreateMode, pMenuID, pRMenuID) Then
        '    GoTo SYSTEM_ERROR
        'End If

        ' --- (2006.06.28) 飲み放題対応　一括転送のみ処理対象----------------------------------
        If pCreateMode <> typCreateMode.RealTimeTransfar And _
           pCreateMode <> typCreateMode.SubDataTransfar Then
            ' --- (2006.04.05) 飲み放題メニュー追加 -------------------------------------------
            If LF_CntTPM170() > 0 Then
                If Not LF_GetMenuDataTPM170(objData9, GC_ORDER_GROUP) Then
                    Exit Function
                End If
                If Not LF_GetMenuDataTPM170(objData10, GC_ORDER_PRICE) Then
                    Exit Function
                End If
                If Not LF_GetMenuDataTPM170(objData11, GC_ORDER_NONE) Then
                    Exit Function
                End If
                If Not LF_GetMenuDataTPM170(objData12, GC_ORDER_CASE) Then
                    Exit Function
                End If

                '------------------------------
                ' 商品グループ毎メニュー生成
                '------------------------------
                If objData9.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_9(objData9, objStatus, pCreateMode) Then              ' 商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If
                If objData10.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_9(objData10, objStatus, pCreateMode) Then              ' 単価ごと商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                'L_FreeMode = True

                If objData11.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_10(objData11, objStatus, pCreateMode) Then              ' 単品画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                'L_FreeMode = False

                If objData12.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_11(objData12, objStatus, pCreateMode) Then              ' ネタケース画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                '---2006.06.09 飲み放題メニュー生成処理追加 7インチVer.START---

                If objData9.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_15(objData9, objStatus, pCreateMode) Then              ' 商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If
                If objData10.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_15(objData10, objStatus, pCreateMode) Then              ' 単価ごと商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                'L_FreeMode = True

                If objData11.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_16(objData11, objStatus, pCreateMode, "0") Then             ' 単品画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                'L_FreeMode = False

                If objData12.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_16(objData12, objStatus, pCreateMode, "1") Then             ' ネタケース画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                '---2006.06.09 飲み放題メニュー生成処理追加 7インチVer.END---

                ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
                If objData9.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_18(objData9, objStatus, pCreateMode) Then          ' 商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                If objData10.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_18(objData10, objStatus, pCreateMode) Then         ' 単価ごと商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                If objData11.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_19(objData11, objStatus, pCreateMode, "0") Then    ' 単品画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If

                If objData12.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_19(objData12, objStatus, pCreateMode, "1") Then    ' ネタケース画像生成処理
                        GoTo SYSTEM_ERROR
                    End If
                End If
                ' -----------------------------------------------------------

                '--- 飲み放題メニューに登録されているジャンルは、飲み放題画像をつくる
                objData9 = New DataSet()
                If Not LF_GetMenuDataTPM170_2(objData9, GC_ORDER_GROUP) Then
                    Exit Function
                End If

                '------------------------------
                ' 商品グループ毎メニュー生成
                '------------------------------
                If objData9.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_12(objData9, objStatus, pCreateMode) Then
                        GoTo SYSTEM_ERROR
                    End If

                    '---2006.06.09  7インチVer.START---
                    If Not LF_CreateMenu_17(objData9, objStatus, pCreateMode) Then
                        GoTo SYSTEM_ERROR
                    End If
                    '---2006.06.09  7インチVer.END---

                    ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
                    If Not LF_CreateMenu_20(objData9, objStatus, pCreateMode) Then
                        GoTo SYSTEM_ERROR
                    End If
                    ' -----------------------------------------------------------

                End If

                If Not LF_CreateMaterials_4() Then
                    GoTo SYSTEM_ERROR
                End If

            End If
            If LF_CntTPM160() > 0 Then
                objData9 = New DataSet()
                If Not LF_GetMenuDataTPM160(objData9, GC_ORDER_GROUP) Then
                    Exit Function
                End If

                '------------------------------
                ' 商品グループ毎メニュー生成
                '------------------------------
                If objData9.Tables("com").Rows.Count > 0 Then
                    If Not LF_CreateMenu_12(objData9, objStatus, pCreateMode) Then              ' 商品グループ画像生成処理
                        GoTo SYSTEM_ERROR
                    End If

                    '---2006.06.09  7インチVer.START---
                    If Not LF_CreateMenu_17(objData9, objStatus, pCreateMode) Then
                        GoTo SYSTEM_ERROR
                    End If
                    '---2006.06.09  7インチVer.END---

                    ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
                    If Not LF_CreateMenu_20(objData9, objStatus, pCreateMode) Then
                        GoTo SYSTEM_ERROR
                    End If
                    ' -----------------------------------------------------------
                End If


            End If
            ' ---------------------------------------------------------------------------------
        End If

        '------------------------------
        ' 画像生成商品／フラグ更新
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "UPDATE TPM010"
        If pCreateMode = typCreateMode.AllImageCreate Or _
           pCreateMode = typCreateMode.PreviewCreate Then
            strSQL = strSQL & "   SET TPM010.GENERATEFLG = '" & GC_FALSE & "',"
        Else
            strSQL = strSQL & "   SET TPM010.GENERATEFLG = '" & GC_TRUE & "',"
        End If
        strSQL = strSQL & "       TPM010.UPDID       = '" & GC_UPDID & "',"
        strSQL = strSQL & "       TPM010.UPDYMD      = '" & Now & "'"
        strSQL = strSQL & " WHERE TPM010.GENERATEFLG = '9'"
        If Not GF_UpdData(strSQL) Then
            GoTo SYSTEM_ERROR
        End If

        '------------------------------
        ' 終了処理
        '------------------------------
        If Not GF_CommitTrans() Then                                        ' トランザクション確定処理
            GoTo SYSTEM_ERROR
        End If

        objStatus.Close()                                                   ' 進捗ステータスフォームClose
        objStatus.Dispose()

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_CreateMenuImage = True
        Exit Function

SYSTEM_ERROR:
        Call GF_RollbackTrans()                                             ' ＤＢロールバック
        objStatus.Close()                                                   ' 進捗ステータスフォームClose
        objStatus.Dispose()
        GF_Msg("", "画像一括生成処理が、異常終了しました")  '(2006.05.23) 体裁統一
        'MsgBox("画像一括生成処理が、異常終了しました")

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：旧生成画像データ削除処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_DelOldImage() As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strFileNM As String
        Dim strSQL As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_DelOldImage = False

        Try
            '------------------------------
            ' 旧画像ファイル削除
            '------------------------------
            For Each strFileNM In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgPath, "*.*")
                System.IO.File.SetAttributes(strFileNM, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNM)
            Next

            ' --- 2004/05/25　追加　800x600用 ---
            For Each strFileNM In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgPath2, "*.*")
                System.IO.File.SetAttributes(strFileNM, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNM)
            Next
            ' -----------------------------------

            ' --- 2006/03/10　追加　640x480用 ---
            For Each strFileNM In System.IO.Directory.GetFiles(g_udtAppConfig.strMenuImgPath3, "*.*")
                System.IO.File.SetAttributes(strFileNM, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFileNM)
            Next
            ' -----------------------------------

            '------------------------------
            ' 生成画像管理テーブル削除
            '------------------------------
            strSQL = ""
            strSQL = strSQL & "TRUNCATE TABLE TPD020"
            If Not GF_UpdData(strSQL) Then
                Exit Function
            End If

            ' --- 2004/05/25　追加　800x600用 ---
            strSQL = ""
            strSQL = strSQL & "TRUNCATE TABLE TPD025"
            If Not GF_UpdData(strSQL) Then
                Exit Function
            End If
            ' -----------------------------------

            ' --- 2006/03/10　追加　640x480用 ---
            strSQL = ""
            strSQL = strSQL & "TRUNCATE TABLE TPD026"
            If Not GF_UpdData(strSQL) Then
                Exit Function
            End If
            ' -----------------------------------
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_DelOldImage = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー情報取得
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_GetMenuData(ByRef pData As DataSet, ByVal pGROUPKBN As String, Optional ByVal pMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_GetMenuData = False
        strSQL = ""

        '------------------------------
        ' メニュー情報取得
        '------------------------------
        Select Case pGROUPKBN
            Case GC_ORDER_GROUP, _
                 GC_ORDER_NONE, _
                 GC_ORDER_CASE                                              ' --- (2004.02.04) ネタケース対応 ---

                strSQL = strSQL & "SELECT TPM060.MENUID,"
                strSQL = strSQL & "       TPM060.MENUNM,"
                strSQL = strSQL & "       TPM060.MENUGRPID AS FIRSTKEY,"
                strSQL = strSQL & "       TPM060.MENUGRPNM,"
                strSQL = strSQL & "       TPM060.MENUSTYLE,"
                strSQL = strSQL & "       TPM060.GROUPCD   AS SECONDKEY,"
                strSQL = strSQL & "       TPM060.GROUPCD   AS GOODSGROUP,"
                strSQL = strSQL & "       TPM060.PRICEDISP,"
                strSQL = strSQL & "       TPM060.GROUPKBN,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPNM FROM TPM020 WHERE TPM020.GROUPCD = TPM060.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPNM,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPIMAGE FROM TPM020 WHERE TPM020.GROUPCD = TPM060.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPIMG,"
                strSQL = strSQL & "       TPM020.GOODSCD,"
                strSQL = strSQL & "       TPM010.GOODSNMJ,"
                strSQL = strSQL & "       TPM010.GOODSNMJ2,"
                strSQL = strSQL & "       TPM010.JEXPNOTEJ,"
                strSQL = strSQL & "       TPM010.IMAGEDATA,"
                strSQL = strSQL & "       TPM010.PRICE,"
                '--- (2006.02.20) おすすめ、新作アイコン追加 ------------------------------------------
                strSQL = strSQL & "       TPM010.SPFLG,"
                strSQL = strSQL & "       TPM010.NEWFLG,"
                '--------------------------------------------------------------------------------------
                ''--- (2006.04.07) 飲み放題メニュー対応 ------------------------------------------------
                ''strSQL = strSQL & "       TPM160.FREEGOODSCD,"
                ''--------------------------------------------------------------------------------------
                strSQL = strSQL & "       TPM010.GENERATEFLG"
                strSQL = strSQL & "  FROM TPM060,"
                strSQL = strSQL & "       TPM020,"
                strSQL = strSQL & "       TPM010"
                ''--- (2006.04.07) 飲み放題メニュー対応 ------------------------------------------------
                ''strSQL = strSQL & "  LEFT JOIN TPM160 ON TPM010.GOODSCD = TPM160.FREEGOODSCD"
                ''--------------------------------------------------------------------------------------
                strSQL = strSQL & " WHERE TPM060.GROUPCD = TPM020.GROUPCD"
                strSQL = strSQL & "   AND TPM060.GROUPKBN = '" & pGROUPKBN & "'"
                strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
                strSQL = strSQL & "   AND TPM020.GOODSCD = TPM010.GOODSCD"

                If Len(Trim$(pMenuID)) <> 0 Then
                    strSQL = strSQL & "   AND TPM060.MENUID  = '" & pMenuID & "'"
                End If

                strSQL = strSQL & "   AND TPM010.SELLFLG = '" & GC_TRUE & "'"
                strSQL = strSQL & " ORDER BY TPM060.MENUID,"
                strSQL = strSQL & "          TPM060.MENUGRPID,"
                '                strSQL = strSQL & "          TPM060.DISPORDER,"    '2005.10.08 障害修正
                strSQL = strSQL & "          CONVERT(int,TPM060.DISPORDER),"
                strSQL = strSQL & "          TPM020.DISPORDER"

            Case GC_ORDER_PRICE
                strSQL = strSQL & "SELECT TPM060.MENUID,"
                strSQL = strSQL & "       TPM060.MENUNM,"
                strSQL = strSQL & "       TPM060.MENUGRPID AS FIRSTKEY,"
                strSQL = strSQL & "       TPM060.MENUGRPNM,"
                strSQL = strSQL & "       TPM060.MENUSTYLE,"
                strSQL = strSQL & "       TPM060.GROUPCD,"
                strSQL = strSQL & "       TPM060.GROUPCD   AS GOODSGROUP,"
                strSQL = strSQL & "       TPM060.PRICEDISP,"
                strSQL = strSQL & "       TPM060.GROUPKBN,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPNM FROM TPM020 WHERE TPM020.GROUPCD = TPM060.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPNM,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPIMAGE FROM TPM020 WHERE TPM020.GROUPCD = TPM060.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPIMG,"
                strSQL = strSQL & "       TPM020.GOODSCD,"
                strSQL = strSQL & "       TPM010.GOODSNMJ,"
                strSQL = strSQL & "       TPM010.GOODSNMJ2,"
                strSQL = strSQL & "       TPM010.JEXPNOTEJ,"
                strSQL = strSQL & "       TPM010.IMAGEDATA,"
                strSQL = strSQL & "       TPM010.PRICE  AS SECONDKEY,"
                strSQL = strSQL & "       TPM010.PRICE,"
                '--- (2006.02.20) おすすめアイコン対応 ------------------------------------------------
                strSQL = strSQL & "       TPM010.SPFLG,"
                strSQL = strSQL & "       TPM010.NEWFLG,"
                '--------------------------------------------------------------------------------------
                ''''--- (2006.04.07) 飲み放題メニュー対応 ------------------------------------------------
                ''strSQL = strSQL & "       TPM160.FREEGOODSCD,"
                ''''--------------------------------------------------------------------------------------
                strSQL = strSQL & "       TPM010.GENERATEFLG"
                strSQL = strSQL & "  FROM TPM060,"
                strSQL = strSQL & "       TPM020,"
                strSQL = strSQL & "       TPM010"
                ''--- (2006.04.07) 飲み放題メニュー対応 ------------------------------------------------
                ''strSQL = strSQL & "  LEFT JOIN TPM160 ON TPM010.GOODSCD = TPM160.FREEGOODSCD"
                ''--------------------------------------------------------------------------------------
                strSQL = strSQL & " WHERE TPM060.GROUPCD = TPM020.GROUPCD"
                strSQL = strSQL & "   AND TPM060.GROUPKBN IN ('" & GC_ORDER_PRICE & "','" & GC_ORDER_PRICE2 & "')"
                strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
                strSQL = strSQL & "   AND TPM020.GOODSCD = TPM010.GOODSCD"

                If Len(Trim$(pMenuID)) <> 0 Then
                    strSQL = strSQL & "   AND TPM060.MENUID  = '" & pMenuID & "'"
                End If

                strSQL = strSQL & "   AND TPM010.SELLFLG = '" & GC_TRUE & "'"
                strSQL = strSQL & " ORDER BY TPM060.MENUID,"
                strSQL = strSQL & "          TPM060.MENUGRPID,"
                strSQL = strSQL & "          TPM010.PRICE,"
                strSQL = strSQL & "          TPM020.GROUPCD,"
                strSQL = strSQL & "          TPM020.DISPORDER"

            Case Else
                Exit Function
        End Select
        If Not GF_GetData(strSQL, pData) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_GetMenuData = True

    End Function

    Private Function LF_CntTPM160() As Integer
        '** 飲み放題用商品件数取得

        Dim strSQL As String
        Dim objData As New DataSet()

        LF_CntTPM160 = 0

        strSQL = ""
        strSQL = strSQL & "SELECT * FROM TPM160"

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        LF_CntTPM160 = objData.Tables("com").Rows.Count

    End Function

    Private Function LF_GetMenuDataTPM160(ByRef pobjData As DataSet, ByVal pGROUPKBN As String) As Boolean
        ' --------------------------------------------------------------------------------
        ' 　機　　能：飲み放題商品マスタTPM160取得()
        ' 　機能概要：
        ' 　引　　数：
        ' 　戻 り 値：
        ' 　履　　歴：2006.04.05 ソラン北陸 新規作成
        ' --------------------------------------------------------------------------------

        Dim strSQL As String

        LF_GetMenuDataTPM160 = False

        strSQL = ""
        strSQL = strSQL & "SELECT TPM060.MENUSTYLE,"
        strSQL = strSQL & "       TPM060.GROUPCD   AS GOODSGROUP,"
        strSQL = strSQL & "       TPM060.PRICEDISP,"
        strSQL = strSQL & "       TPM060.GROUPKBN,"
        strSQL = strSQL & "       TPM060.GROUPCD   AS SECONDKEY,"       '2006.06.27 dummyで追加
        strSQL = strSQL & "       TPM010.PRICE     AS PRICE,"           '2006.06.27 dummyで追加
        strSQL = strSQL & "       (SELECT TPM020.GROUPIMAGE FROM TPM020 WHERE TPM020.GROUPCD = TPM060.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPIMG,"
        strSQL = strSQL & "       TPM010.GOODSCD,"
        strSQL = strSQL & "       TPM010.GOODSNMJ,"
        strSQL = strSQL & "       TPM010.GOODSNMJ2,"
        strSQL = strSQL & "       TPM010.JEXPNOTEJ,"
        strSQL = strSQL & "       TPM010.IMAGEDATA,"
        strSQL = strSQL & "       TPM010.PRICE,"
        strSQL = strSQL & "       TPM010.SPFLG,"
        strSQL = strSQL & "       TPM010.NEWFLG,"
        strSQL = strSQL & "       TPM160.FREEGOODSCD,"
        strSQL = strSQL & "       TPM010.GENERATEFLG"
        strSQL = strSQL & "  FROM TPM060, TPM020, TPM010, TPM160"
        strSQL = strSQL & " WHERE TPM060.GROUPCD = TPM020.GROUPCD"
        strSQL = strSQL & "   AND TPM020.GOODSCD = TPM160.GOODSCD"
        strSQL = strSQL & "   AND TPM010.GOODSCD = TPM160.FREEGOODSCD"
        strSQL = strSQL & "   AND TPM010.SELLFLG = '" & GC_TRUE & "'"
        'strSQL = strSQL & "   AND TPM060.GROUPKBN = '" & pGROUPKBN & "'"

        If Not GF_GetData(strSQL, pobjData) Then
            Exit Function
        End If

        LF_GetMenuDataTPM160 = True

    End Function

    Private Function LF_GetMenuDataTPM170_2(ByRef pobjData As DataSet, ByVal pGROUPKBN As String) As Boolean
        ' --------------------------------------------------------------------------------
        ' 　機　　能：飲み放題商品マスタTPM160取得()
        ' 　機能概要：
        ' 　引　　数：
        ' 　戻 り 値：
        ' 　履　　歴：2006.04.05 ソラン北陸 新規作成
        ' --------------------------------------------------------------------------------

        Dim strSQL As String

        LF_GetMenuDataTPM170_2 = False

        strSQL = ""
        strSQL = strSQL & "SELECT DISTINCT(TPM060.MENUSTYLE),"
        strSQL = strSQL & "       TPM060.GROUPCD   AS GOODSGROUP,"
        strSQL = strSQL & "       TPM060.PRICEDISP,"
        strSQL = strSQL & "       TPM060.GROUPKBN,"
        strSQL = strSQL & "       TPM060.GROUPCD   AS SECONDKEY,"       '2006.06.27 dummyで追加
        strSQL = strSQL & "       TPM010.PRICE     AS PRICE,"           '2006.06.27 dummyで追加
        strSQL = strSQL & "       (SELECT TPM020.GROUPIMAGE FROM TPM020 WHERE TPM020.GROUPCD = TPM060.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPIMG,"
        strSQL = strSQL & "       TPM010.GOODSCD,"
        strSQL = strSQL & "       TPM010.GOODSNMJ,"
        strSQL = strSQL & "       TPM010.GOODSNMJ2,"
        strSQL = strSQL & "       TPM010.JEXPNOTEJ,"
        strSQL = strSQL & "       TPM010.IMAGEDATA,"
        strSQL = strSQL & "       TPM010.PRICE,"
        strSQL = strSQL & "       TPM010.SPFLG,"
        strSQL = strSQL & "       TPM010.NEWFLG,"
        strSQL = strSQL & "       TPM010.GENERATEFLG"
        strSQL = strSQL & "  FROM TPM060, TPM020, TPM010, TPM170"
        strSQL = strSQL & " WHERE TPM060.GROUPCD = TPM020.GROUPCD"
        strSQL = strSQL & "   AND TPM020.GROUPCD = TPM170.GROUPCD"
        strSQL = strSQL & "   AND TPM020.GOODSCD = TPM010.GOODSCD"
        strSQL = strSQL & "   AND TPM010.SELLFLG = '" & GC_TRUE & "'"
        'strSQL = strSQL & "   AND TPM060.GROUPKBN = '" & pGROUPKBN & "'"

        If Not GF_GetData(strSQL, pobjData) Then
            Exit Function
        End If

        LF_GetMenuDataTPM170_2 = True

    End Function

    Private Function LF_CntTPM170() As Integer
        '-- 飲み放題メニュー件数を取得

        Dim strSQL As String
        Dim objData As New DataSet()

        LF_CntTPM170 = 0

        strSQL = ""
        strSQL = strSQL & "SELECT * FROM TPM170"

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        LF_CntTPM170 = objData.Tables("com").Rows.Count

    End Function

    Private Function LF_GetMenuDataTPM170(ByRef pobjData As DataSet, ByVal pGROUPKBN As String) As Boolean
        ' --------------------------------------------------------------------------------
        ' 　機　　能：飲み放題メニューマスタTPM170取得
        ' 　機能概要：
        ' 　引　　数：
        ' 　戻 り 値：
        ' 　履　　歴：2006.04.05 ソラン北陸 新規作成
        ' --------------------------------------------------------------------------------

        Dim strSQL As String

        LF_GetMenuDataTPM170 = False

        strSQL = ""
        strSQL = strSQL

        '------------------------------
        ' メニュー情報取得
        '------------------------------
        Select Case pGROUPKBN
            Case GC_ORDER_GROUP, _
                 GC_ORDER_NONE, _
                 GC_ORDER_CASE

                strSQL = strSQL & "SELECT TPM170.MENUID,"
                strSQL = strSQL & "       TPM170.MENUNM,"
                'strSQL = strSQL & "       TPM170.MENUGRPID AS FIRSTKEY,"
                'strSQL = strSQL & "       TPM170.MENUGRPNM,"
                strSQL = strSQL & "       TPM170.MENUSTYLE,"
                strSQL = strSQL & "       TPM170.GROUPCD   AS SECONDKEY,"
                strSQL = strSQL & "       TPM170.GROUPCD   AS GOODSGROUP,"
                strSQL = strSQL & "       TPM170.PRICEDISP,"
                strSQL = strSQL & "       TPM170.GROUPKBN,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPNM FROM TPM020 WHERE TPM020.GROUPCD = TPM170.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPNM,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPIMAGE FROM TPM020 WHERE TPM020.GROUPCD = TPM170.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPIMG,"
                strSQL = strSQL & "       TPM020.GOODSCD,"
                strSQL = strSQL & "       TPM010.GOODSNMJ,"
                strSQL = strSQL & "       TPM010.GOODSNMJ2,"
                strSQL = strSQL & "       TPM010.JEXPNOTEJ,"
                strSQL = strSQL & "       TPM010.IMAGEDATA,"
                strSQL = strSQL & "       TPM010.PRICE,"
                strSQL = strSQL & "       TPM010.SPFLG,"
                strSQL = strSQL & "       TPM010.NEWFLG,"
                strSQL = strSQL & "       TPM010.GENERATEFLG,"
                strSQL = strSQL & "       TPM160.FREEGOODSCD"
                strSQL = strSQL & "  FROM TPM170,"
                strSQL = strSQL & "       TPM020,"
                strSQL = strSQL & "       TPM010"
                strSQL = strSQL & "  LEFT JOIN TPM160 ON TPM010.GOODSCD = TPM160.GOODSCD"
                strSQL = strSQL & " WHERE TPM170.GROUPCD = TPM020.GROUPCD"
                strSQL = strSQL & "   AND TPM170.GROUPKBN = '" & pGROUPKBN & "'"
                strSQL = strSQL & "   AND TPM170.ENABLED = '1'"
                strSQL = strSQL & "   AND TPM020.GOODSCD = TPM010.GOODSCD"
                strSQL = strSQL & "   AND TPM010.SELLFLG = '" & GC_TRUE & "'"
                strSQL = strSQL & " ORDER BY TPM170.MENUID,"
                'strSQL = strSQL & "          TPM170.MENUGRPID,"
                strSQL = strSQL & "          CONVERT(int,TPM170.DISPORDER),"
                strSQL = strSQL & "          TPM020.DISPORDER"

            Case GC_ORDER_PRICE
                strSQL = strSQL & "SELECT TPM170.MENUID,"
                strSQL = strSQL & "       TPM170.MENUNM,"
                'strSQL = strSQL & "       TPM170.MENUGRPID AS FIRSTKEY,"
                'strSQL = strSQL & "       TPM170.MENUGRPNM,"
                strSQL = strSQL & "       TPM170.MENUSTYLE,"
                strSQL = strSQL & "       TPM170.GROUPCD,"
                strSQL = strSQL & "       TPM170.GROUPCD   AS GOODSGROUP,"
                strSQL = strSQL & "       TPM170.PRICEDISP,"
                strSQL = strSQL & "       TPM170.GROUPKBN,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPNM FROM TPM020 WHERE TPM020.GROUPCD = TPM170.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPNM,"
                strSQL = strSQL & "       (SELECT TPM020.GROUPIMAGE FROM TPM020 WHERE TPM020.GROUPCD = TPM170.GROUPCD AND TPM020.GOODSCD = '0000') AS GROUPIMG,"
                strSQL = strSQL & "       TPM020.GOODSCD,"
                strSQL = strSQL & "       TPM010.GOODSNMJ,"
                strSQL = strSQL & "       TPM010.GOODSNMJ2,"
                strSQL = strSQL & "       TPM010.JEXPNOTEJ,"
                strSQL = strSQL & "       TPM010.IMAGEDATA,"
                strSQL = strSQL & "       TPM010.PRICE  AS SECONDKEY,"
                strSQL = strSQL & "       TPM010.PRICE,"
                strSQL = strSQL & "       TPM010.SPFLG,"
                strSQL = strSQL & "       TPM010.NEWFLG,"
                strSQL = strSQL & "       TPM010.GENERATEFLG,"
                strSQL = strSQL & "       TPM160.FREEGOODSCD"
                strSQL = strSQL & "  FROM TPM170,"
                strSQL = strSQL & "       TPM020,"
                strSQL = strSQL & "       TPM010"
                strSQL = strSQL & "  LEFT JOIN TPM160 ON TPM010.GOODSCD = TPM160.FREEGOODSCD"
                strSQL = strSQL & " WHERE TPM170.GROUPCD = TPM020.GROUPCD"
                strSQL = strSQL & "   AND TPM170.GROUPKBN IN ('" & GC_ORDER_PRICE & "','" & GC_ORDER_PRICE2 & "')"
                strSQL = strSQL & "   AND TPM170.ENABLED = '1'"
                strSQL = strSQL & "   AND TPM020.GOODSCD = TPM010.GOODSCD"
                strSQL = strSQL & "   AND TPM010.SELLFLG = '" & GC_TRUE & "'"
                strSQL = strSQL & " ORDER BY TPM170.MENUID,"
                'strSQL = strSQL & "          TPM170.MENUGRPID,"
                strSQL = strSQL & "          TPM010.PRICE,"
                strSQL = strSQL & "          TPM020.GROUPCD,"
                strSQL = strSQL & "          TPM020.DISPORDER"

            Case Else
                Exit Function
        End Select
        If Not GF_GetData(strSQL, pobjData) Then
            Exit Function
        End If

        LF_GetMenuDataTPM170 = True


    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：描画ビットマップエリア 初期化処理
    ' 　機能概要：[商品グループ画像(日本語)]専用処理である。
    ' 　引　　数：第５引数のイメージコード配列の先頭(０番目)は、必ずベース画像であること
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_InitialPicture(ByRef pBitmap() As Bitmap, _
                                       ByRef pGraph As Graphics, _
                                       ByRef pRect As RectangleF, _
                                       ByRef pPicture As PictureBox, _
                                       ByVal pIMAGECD() As String) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngCnt As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_InitialPicture = False

        '------------------------------
        ' 描画エリア初期化処理
        '------------------------------
        Try
            For lngCnt = 0 To UBound(pIMAGECD)
                If IsNothing(pBitmap(lngCnt)) = False Then
                    pBitmap(lngCnt).Dispose()
                End If
                pBitmap(lngCnt) = New Bitmap(GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial(pIMAGECD(lngCnt)))
            Next
            If IsNothing(pGraph) = False Then
                pGraph.Dispose()
            End If
            pGraph = Graphics.FromImage(pBitmap(0))

            If UBound(pIMAGECD) > 0 Then
                pRect = New RectangleF(0, 0, pBitmap(0).Width, pBitmap(0).Height)
                Call pGraph.DrawImage(pBitmap(1), _
                                      pBitmap(0).Width - pBitmap(1).Width, _
                                      0, _
                                      pBitmap(1).Width, _
                                      pBitmap(1).Height)
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_InitialPicture = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_1(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                   ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 14商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_1 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "S007JC"
        strImageCD(1) = "S008JC"
        strImageCD(2) = "S009JC"
        strImageCD(3) = "S010JC"
        strTJMaterialID(0) = "S011JA"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            'If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 26) Then            ' [グループ]グループ名文字
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 22) Then            ' [グループ]グループ名文字
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 18) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Or strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM_HEIGHT
                                .lngCharWidth = LC_ITEM_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt) Then
                            Exit Function
                        End If
                    End If

                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN_WIDTH - (LC_LEFT_MARGIN + LC_RIGHT_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            lngMaxItem = 13
                        Case GC_MSTYLE_LISTPIC
                            lngMaxItem = 12
                        Case GC_MSTYLE_LISTPIC4
                            lngMaxItem = 4

                            '--- (2006.02.02) メニュー画像転送処理 ------------------
                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 13
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 12
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 4
                            '--------------------------------------------------------
                        Case Else
                            Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                ' --- (2006.02.02) メニュー画像転送処理 --------------------------------------------------------------------------
                'If lngItemCnt = (lngMaxItem - 1) And _
                '   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                '   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                    lngItemCnt = lngItemCnt + 1
                End If
                ' ----------------------------------------------------------------------------------------------------------------
                ' --------------------


                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)

                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If


                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH * 2) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM2_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------

                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM_HEIGHT
                                .lngCharWidth = LC_ITEM_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.07.03) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH * 2) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else                                            ' --- Bパターン ---
                                lngSubNo2 = lngSubNo2 + 1
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN_WIDTH - (LC_LEFT_MARGIN + LC_RIGHT_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If
                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = 0
                            .objFont = objFont(0)
                            .lngCharHeight = LC_TITLE_HEIGHT
                            .lngCharWidth = LC_TITLE_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                    Else
                        If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM_HEIGHT
                                .lngCharWidth = LC_ITEM_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - (lngSubX - 10)
                                lngImgX = lngImgX - (lngSubX - 10)
                            Else
                                Exit Function
                            End If
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        .lngCharHeight = LC_TITLE_HEIGHT
                        .lngCharWidth = LC_TITLE_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM_HEIGHT
                    .lngCharWidth = LC_ITEM_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 13
                        .objFont = objFont(1)
                        .lngCharHeight = LC_ITEM_HEIGHT
                        .lngCharWidth = LC_ITEM_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                '--- (2006.02.02) メニュー画像転送処理 ----------------------------------------------------------------------
                'If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                    (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then
                        If Not LF_MakeTJGrpGrph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR                                  ' 短冊型画像生成
                        If Not LF_MakeTJGraphics(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_LISTPIC                                  ' 画像型画像生成(12分割版)
                        If Not LF_MakeGJGraphics(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_LISTPIC4                                 ' 画像型画像生成(４分割版)
                        If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                            Exit Function
                        End If

                    Case GC_MSTYLE_PICTJ       '--- (2006.02.02) メニュー画像
                        If Not LF_MakeTJGraphics(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_PIC12       '---(2006.02.02) メニュー画像
                        If Not LF_MakeGJGraphics(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode) Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_PIC4       '---(2006.02.02) メニュー画像
                        If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                            Exit Function
                        End If

                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_LISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                            '--- (2006.02.02) メニュー画像転送 ---------------------------------------------------
                        Case GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                            '-------------------------------------------------------------------------------------
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC
                        If lngItemCnt Mod 4 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_LISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12       '(2006.02.02) メニュー画像 
                        If lngItemCnt Mod 4 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC4       '(2006.02.02) メニュー画像
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If

                End Select

                lngCnt = lngCnt + 1
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM_HEIGHT
                    .lngCharWidth = LC_ITEM_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_1 = True

    End Function

    Private Function LF_CreateMenu_2(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String
        Dim strSKey As String
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_2 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strTJMaterialID(0) = "S011JA"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                        ' (画像)売り切れ画像コード

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NOLIST
                            lngMaxItem = 13
                        Case GC_MSTYLE_NOLISTSTR
                            lngMaxItem = 12
                        Case GC_MSTYLE_NOLISTPIC4
                            lngMaxItem = 4

                            '--- (2006.02.08) メニュー画像転送処理 ------------------
                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 13
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 12
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 4
                            '--------------------------------------------------------
                        Case Else
                            Exit Function
                    End Select
                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    'If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NOLIST Then     '--- (2006.02.08) メニュー画像追加
                    If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NOLIST) Or (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        If Not LF_MakeTJGrpGrph(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ      '---(2006.02.08) メニュー画像追加
                        'Case GC_MSTYLE_NOLIST
                        If Not LF_MakeTJGraphics(strTJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12   '---(2006.02.08) メニュー画像追加
                        'Case GC_MSTYLE_NOLISTSTR
                        If Not LF_MakeGJGraphics(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   '---(2006.02.08) メニュー画像追加
                        'Case GC_MSTYLE_NOLISTPIC4
                        If Not LF_MakeNetaGraph(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, True, pCreateMode) Then ' 通常商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                            Exit Function
                        End If

                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ      '--- (2006.02.08) メニュー画像作成
                            'Case GC_MSTYLE_NOLIST
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12   '--- (2006.02.08) メニュー画像作成
                            'Case GC_MSTYLE_NOLISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   '--- (2006.02.08) メニュー画像作成
                            'Case GC_MSTYLE_NOLISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ      '---(2006.02.08) メニュー画像作成
                        'Case GC_MSTYLE_NOLIST
                    Case GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12   '---(2006.02.08) メニュー画像作成
                        'Case GC_MSTYLE_NOLISTSTR
                        If lngItemCnt Mod 4 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   '---(2006.02.08) メニュー画像作成
                        'Case GC_MSTYLE_NOLISTPIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_2 = True
    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理(ネタケース対応)
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2004.02.04 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_3(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont As Font = Nothing
        Dim objRect As RectangleF
        Dim strKey(2) As String
        Dim lngCnt As Long
        Dim lngPCnt As Long
        Dim lngCCnt As Long
        Dim objRows As DataRow = Nothing
        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim strImageCD(0) As String
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim lngLine As Long
        Dim lngGrpSub As Long
        Dim lngMaxItem As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_3 = False
        strImageCD(0) = "S036UC"                                            ' ジャンル名画像コード
        strTJMaterialID(0) = "S011JA"                                       ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                       ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                       ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                       ' (画像)売り切れ画像コード
        lngPCnt = 0                                                         ' 親レコードの表示順カウンタ
        lngCCnt = 0                                                         ' 子レコードの表示順カウンタ
        strKey(0) = ""                                                      ' (キー項目)メニューＩＤ
        strKey(1) = ""                                                      ' (   〃   )メニューグループＩＤ
        strKey(2) = ""                                                      ' (   〃   )ジャンルＩＤ
        lngLine = 1
        lngGrpSub = 0

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then               ' ジャンル名文字
                Exit Function
            End If

            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count

                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                If strKey(0) <> Trim$(objRows("MENUID")) Or _
                   strKey(1) <> Trim$(objRows("FIRSTKEY")) Or _
                   strKey(2) <> Trim$(objRows("SECONDKEY")) Then

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NETASTR
                            lngMaxItem = 13
                        Case GC_MSTYLE_NETAPIC
                            lngMaxItem = 12
                        Case GC_MSTYLE_NETACASE
                            lngMaxItem = 4
                        Case Else
                            Exit Function
                    End Select

                    If strKey(0) <> Trim$(objRows("MENUID")) Or _
                       strKey(1) <> Trim$(objRows("FIRSTKEY")) Then
                        lngPCnt = 0
                        lngLine = 1
                    Else
                        lngPCnt = lngPCnt + 1                                   ' 親レコードの表示順カウンタ
                        If lngPCnt <> 0 And lngPCnt Mod 5 = 0 Then
                            lngLine = lngLine + 1
                        End If
                    End If
                    lngCCnt = 1
                    lngGrpSub = 1

                    '------------------------------
                    ' ジャンル名画像出力処理
                    '------------------------------
                    With udtParam
                        .strPutStrings = Trim$(objRows("GROUPNM"))
                        .objFont = objFont
                        .objColor = Color.Black
                        .lngCharLower = 0
                        .lngPositionY = 5
                    End With
                    Call LF_PutHString2(udtParam, objGraph)

                    '------------------------------
                    ' 生成画像情報テーブル更新処理
                    '------------------------------
                    With udtTPD020
                        .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                        .MENUBTNID = Trim$(objRows("FIRSTKEY"))
                        .MENUGRPID = Format$(lngPCnt, "000")
                        .MENUGRPID2 = Format$(lngGrpSub, "00")
                        .MENUGRPID3 = "00"
                        .MENULV = "0"
                        .LINE = "L" & Format$(lngLine, "0000")
                        .REFID = Space(1)
                        .REFGRP = Trim$(objRows("GOODSGROUP"))
                        .DISPORDER = Format$(lngPCnt, "000")
                        .UPDID = GC_UPDID
                        .UPDYMD = Now
                        .SELLKBN = GC_OOS_ONSELE
                    End With
                    If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, Nothing) Then
                        Exit Function
                    End If
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If

                    '------------------------------
                    ' ジャンル名短冊出力
                    '------------------------------
                    If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NETASTR Then
                        If Not LF_MakeTJGrpGrph(objRows, lngCCnt, lngPCnt, lngGrpSub, 1) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = Trim$(objRows("FIRSTKEY"))
                            .MENUGRPID = Format$(lngPCnt, "000")
                            .MENUGRPID2 = Format$(lngGrpSub, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngCCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0) Then
                            Exit Function
                        End If

                        lngCCnt = lngCCnt + 1
                    End If

                    '------------------------------
                    ' キー項目値保存/カウンタクリア
                    '------------------------------
                    strKey(0) = Trim$(objRows("MENUID"))
                    strKey(1) = Trim$(objRows("FIRSTKEY"))
                    strKey(2) = Trim$(objRows("SECONDKEY"))
                End If

                '------------------------------
                ' 商品一覧画像生成処理
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NETASTR  ' 短冊
                        If Not LF_MakeTJGraphics(strTJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case GC_MSTYLE_NETAPIC  ' 画像(12)
                        If Not LF_MakeGJGraphics(strGJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, lngLine, pCreateMode) Then  ' 日本語画像生成
                            Exit Function
                        End If

                    Case GC_MSTYLE_NETACASE ' 画像(4)
                        If Not LF_MakeNetaGraph(objRows, lngCCnt, lngPCnt, lngGrpSub, True, pCreateMode) Then ' 通常商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph(objRows, lngCCnt, lngPCnt, lngGrpSub, False, pCreateMode) Then    ' 品切れ商品画像力
                            Exit Function
                        End If
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = Trim$(objRows("FIRSTKEY"))
                    .MENUGRPID = Format$(lngPCnt, "000")
                    .MENUGRPID2 = Format$(lngGrpSub, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NETASTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_NETAPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_NETACASE
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngCCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0) Then
                    Exit Function
                End If

                If lngCCnt <> 0 And lngCCnt Mod lngMaxItem = 0 Then
                    lngGrpSub = lngGrpSub + 1
                End If
                lngCCnt = lngCCnt + 1
                lngCnt = lngCnt + 1
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_3 = True

    End Function

    ' -- 12インチ対応 2006.10.20 --
    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理-10.4ｲﾝﾁ用
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2004.05.25 ソラン北陸
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_4(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                   ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 6商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_4 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        '
        ' 更新 2006/02/01 取得Img 800x480用
        '　　　　　　　　↓未定　　
        'strImageCD(0) = "VGS010" '白背景
        'strImageCD(1) = "VGS007" '左メニュー
        'strImageCD(2) = "VGS008" '中央
        'strImageCD(3) = "VGS009" '右メニュー
        'strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        'strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        'strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        'strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        strImageCD(0) = "SVGA43"
        strImageCD(1) = "SVGA40"
        strImageCD(2) = "SVGA41"
        strImageCD(3) = "SVGA42"
        strTJMaterialID(0) = "SVGA68"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "SVGA68"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "SVGA58"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "SVGA58"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try

            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27          ' [グループ]グループ名文字 更新 2006/02/02
                Exit Function
            End If

            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 25) Then    '24        ' [グループ]品名文字 更新 2006/02/02
                Exit Function
            End If


        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                strcount = Len(Trim$(objRows("GROUPNM")))

                If strcount < 7 Then
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27 30         ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                Else
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27            ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                End If
                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Or strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.SVGA) Then
                            Exit Function
                        End If
                    End If
                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            ' lngMaxItem = 9 '更新 2006/02/20 11 ジャンルタイトルも含めた個数
                            lngMaxItem = 12  '--- 2006/11/10 12インチ対応
                        Case GC_MSTYLE_LISTPIC
                            lngMaxItem = 6
                        Case GC_MSTYLE_LISTPIC4
                            lngMaxItem = 6
                        Case GC_MSTYLE_PICTJ
                            ' lngMaxItem = 9
                            lngMaxItem = 12  '--- 2006/11/10 12インチ対応
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                'If lngItemCnt = (lngMaxItem - 1) And _
                '   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                '   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                '    lngItemCnt = lngItemCnt + 1
                'End If
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                    lngItemCnt = lngItemCnt + 1
                End If

                ' --------------------

                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)


                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If

                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.SVGA) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP3_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else
                                lngSubNo2 = lngSubNo2 + 1                     ' --- Bパターン ---
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If

                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = -2 '0
                            .objFont = objFont(0)
                            If strcount < 7 Then
                                '.lngCharHeight = LC_TITLE3_HEIGHT
                                .lngCharHeight = LC_TITLE3_HEIGHT - 8   '---  2006.10.27　12インチ対応
                            Else
                                '.lngCharHeight = LC_TITLE3_HEIGHT - 10
                                .lngCharHeight = LC_TITLE3_HEIGHT - 12  '---  2006.10.27　12インチ対応
                            End If
                            .lngCharWidth = LC_TITLE3_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                        'Else
                        '    If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                        '        With udtParam
                        '            .strPutStrings = ""
                        '            .lngPositionX = lngImgX
                        '            .lngCharLower = 13
                        '            .objFont = objFont(1)
                        '            .lngCharHeight = LC_ITEM3_HEIGHT
                        '            '.lngCharWidth = LC_ITEM3_WIDTH
                        '            '商品名は右詰表示する
                        '            .lngCharWidth = 12
                        '            .objColor = System.Drawing.Color.Black
                        '        End With
                        '        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                        '        If lngSubX <> 0 Then
                        '            lngScrX = lngScrX - (lngSubX - 10)
                        '            lngImgX = lngImgX - (lngSubX - 10)
                        '        Else
                        '            Exit Function
                        '        End If
                        'End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        If strcount < 7 Then
                            .lngCharHeight = LC_TITLE3_HEIGHT
                        Else
                            .lngCharHeight = LC_TITLE3_HEIGHT - 10
                        End If
                        .lngCharWidth = LC_TITLE3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力2
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    '.lngCharLower = 5
                    .lngCharLower = 20                     '---  2006.10.27　12インチ対応
                    .objFont = objFont(1)
                    '.lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharHeight = LC_ITEM3_HEIGHT - 3   '---  2006.10.27　12インチ対応
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        '.lngCharLower = 5
                        .lngCharLower = 20                   '---  2006.10.27　12インチ対応
                        .objFont = objFont(1)
                        '.lngCharHeight = LC_ITEM3_HEIGHT
                        .lngCharHeight = LC_ITEM3_HEIGHT - 3 '---  2006.10.27　12インチ対応
                        .lngCharWidth = LC_ITEM3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                'If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then

                        'If Not LF_MakeTJGrpGrph_4(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                        If Not LF_MakeTJGrpGrph_2(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then

                            Exit Function
                        End If
                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR                                  ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_2(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_LISTPIC                                  '画像型画像生成(6分割版)


                        If Not LF_MakeGJGraphics_2(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_LISTPIC4                                  '更新 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_2(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_PICTJ                                     ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_2(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_PIC12                                     '画像型画像生成(6分割版)


                        If Not LF_MakeGJGraphics_2(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_PIC4                                     '更新 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_2(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                        'Case GC_MSTYLE_LISTPIC4                                 ' 画像型画像生成(４分割版)
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                        '        Exit Function
                        '    End If
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                        '        Exit Function
                        '    End If
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02 Photo6追加
                        Case GC_MSTYLE_LISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02 Photo6追加
                        Case GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1


                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_LISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                End Select

                lngCnt = lngCnt + 1
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.SVGA) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_4 = True

    End Function

    '-- 12インチ対応 2006.10.20
    '----------------------------------------------------------------
    ' 更新履歴 2006/06/07 ネタケース時6分割画像作成対応(7インチ対応) 
    '----------------------------------------------------------------
    Private Function LF_CreateMenu_5(ByVal pData As DataSet, _
                                 ByVal pStatus As CNL1810, _
                                 ByVal pCreateMode As typCreateMode, _
                                 ByVal pFlag As String, _
                                 Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String
        Dim strSKey As String
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing
        '更新 ネタケース時遷移対応
        Dim strswitch1 As String
        Dim strswitch2 As String
        Dim strswitch3 As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_5 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        If pFlag = "0" Then
            'ネタケースではないと判定
            strswitch1 = GC_MSTYLE_NOLIST
            strswitch2 = GC_MSTYLE_NOLISTSTR
            strswitch3 = GC_MSTYLE_NOLISTPIC4
        Else
            'ネタケースと判定
            strswitch1 = GC_MSTYLE_NETASTR
            strswitch2 = GC_MSTYLE_NETAPIC
            strswitch3 = GC_MSTYLE_NETACASE
        End If

        '------------------------------
        ' 画像コード設定
        '------------------------------

        'strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        'strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        'strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        'strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        '2006.10.20 変更
        strTJMaterialID(0) = "SVGA68"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "SVGA68"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "SVGA58"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "SVGA58"                                        ' (画像)売り切れ画像コード


        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            'テスト変数 
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            lngMaxItem = 9
                        Case strswitch2, GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case strswitch3, GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select

                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    If (Trim$(objRows("MENUSTYLE")) = strswitch1 Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        If Not LF_MakeTJGrpGrph_2(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                        If Not LF_MakeTJGraphics_2(strTJMaterialID, _
                                                 objRows, _
                                                 lngDspOrder, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngGrpNo, _
                                                 1, _
                                                 pCreateMode) Then
                            Exit Function
                        End If

                    Case strswitch2, GC_MSTYLE_PIC12 '更新↓ 2006/02/02 9→12分割
                        If Not LF_MakeGJGraphics_2(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "6") Then ' 日本語画像生成
                            Exit Function
                        End If


                    Case strswitch3, GC_MSTYLE_PIC4
                        If Not LF_MakeGJGraphics_2(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "4") Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case Else
                        Exit Function

                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case strswitch2, GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02
                        Case strswitch3, GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                    Case strswitch2, GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case strswitch3, GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                Dim integ As Integer = pStatus.pgs_Status.Value
                Dim str As String = pStatus.pgs_Status.Value
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_5 = True
    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理(ネタケース対応)
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2004.02.04 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_6(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont As Font = Nothing
        Dim objRect As RectangleF
        Dim strKey(2) As String
        Dim lngCnt As Long
        Dim lngPCnt As Long
        Dim lngCCnt As Long
        Dim objRows As DataRow = Nothing
        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim strImageCD(0) As String
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim lngLine As Long
        Dim lngGrpSub As Long
        Dim lngMaxItem As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_6 = False
        strImageCD(0) = "SVGA16"                                            ' ジャンル名画像コード
        strTJMaterialID(0) = "SVGA06"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "SVGA06"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "SVGA10"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "SVGA10"                                        ' (画像)売り切れ画像コード
        lngPCnt = 0                                                         ' 親レコードの表示順カウンタ
        lngCCnt = 0                                                         ' 子レコードの表示順カウンタ
        strKey(0) = ""                                                      ' (キー項目)メニューＩＤ
        strKey(1) = ""                                                      ' (   〃   )メニューグループＩＤ
        strKey(2) = ""                                                      ' (   〃   )ジャンルＩＤ
        lngLine = 1
        lngGrpSub = 0

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont, GC_EJKBN_J, 16) Then               ' ジャンル名文字
                Exit Function
            End If

            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count

                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                If strKey(0) <> Trim$(objRows("MENUID")) Or _
                   strKey(1) <> Trim$(objRows("FIRSTKEY")) Or _
                   strKey(2) <> Trim$(objRows("SECONDKEY")) Then

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NETASTR
                            lngMaxItem = 11
                        Case GC_MSTYLE_NETAPIC
                            lngMaxItem = 9
                        Case GC_MSTYLE_NETACASE
                            lngMaxItem = 4
                        Case Else
                            Exit Function
                    End Select

                    If strKey(0) <> Trim$(objRows("MENUID")) Or _
                       strKey(1) <> Trim$(objRows("FIRSTKEY")) Then
                        lngPCnt = 0
                        lngLine = 1
                    Else
                        lngPCnt = lngPCnt + 1                                   ' 親レコードの表示順カウンタ
                        'If lngPCnt <> 0 And lngPCnt Mod 5 = 0 Then  2004/06/04 10.4ｲﾝﾁ対応
                        If lngPCnt <> 0 And lngPCnt Mod 4 = 0 Then
                            lngLine = lngLine + 1
                        End If
                    End If
                    lngCCnt = 1
                    lngGrpSub = 1

                    '------------------------------
                    ' ジャンル名画像出力処理
                    '------------------------------
                    With udtParam
                        .strPutStrings = Trim$(objRows("GROUPNM"))
                        .objFont = objFont
                        .objColor = Color.Black
                        .lngCharLower = 0
                        .lngPositionY = 5
                    End With
                    Call LF_PutHString2(udtParam, objGraph, , DispType.SVGA)

                    '------------------------------
                    ' 生成画像情報テーブル更新処理
                    '------------------------------
                    With udtTPD020
                        .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                        .MENUBTNID = Trim$(objRows("FIRSTKEY"))
                        .MENUGRPID = Format$(lngPCnt, "000")
                        .MENUGRPID2 = Format$(lngGrpSub, "00")
                        .MENUGRPID3 = "00"
                        .MENULV = "0"
                        .LINE = "L" & Format$(lngLine, "0000")
                        .REFID = Space(1)
                        .REFGRP = Trim$(objRows("GOODSGROUP"))
                        .DISPORDER = Format$(lngPCnt, "000")
                        .UPDID = GC_UPDID
                        .UPDYMD = Now
                        .SELLKBN = GC_OOS_ONSELE
                    End With
                    If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, Nothing, Nothing, DispType.SVGA) Then
                        Exit Function
                    End If
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If

                    '------------------------------
                    ' ジャンル名短冊出力
                    '------------------------------
                    If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NETASTR Then
                        If Not LF_MakeTJGrpGrph_2(objRows, lngCCnt, lngPCnt, lngGrpSub, 1) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = Trim$(objRows("FIRSTKEY"))
                            .MENUGRPID = Format$(lngPCnt, "000")
                            .MENUGRPID2 = Format$(lngGrpSub, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngCCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                            Exit Function
                        End If

                        lngCCnt = lngCCnt + 1
                    End If

                    '------------------------------
                    ' キー項目値保存/カウンタクリア
                    '------------------------------
                    strKey(0) = Trim$(objRows("MENUID"))
                    strKey(1) = Trim$(objRows("FIRSTKEY"))
                    strKey(2) = Trim$(objRows("SECONDKEY"))
                End If

                '------------------------------
                ' 商品一覧画像生成処理
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NETASTR  ' 短冊
                        If Not LF_MakeTJGraphics_2(strTJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case GC_MSTYLE_NETAPIC  ' 画像(9)
                        'TEST 2006.10.19
                        If Not LF_MakeGJGraphics_2(strGJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, lngLine, pCreateMode, "") Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case GC_MSTYLE_NETACASE ' 画像(4)
                        If Not LF_MakeNetaGraph_2(objRows, lngCCnt, lngPCnt, lngGrpSub, True, pCreateMode) Then ' 通常商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph_2(objRows, lngCCnt, lngPCnt, lngGrpSub, False, pCreateMode) Then   ' 品切れ商品画像力
                            Exit Function
                        End If
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = Trim$(objRows("FIRSTKEY"))
                    .MENUGRPID = Format$(lngPCnt, "000")
                    .MENUGRPID2 = Format$(lngGrpSub, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NETASTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_NETAPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo9)
                        Case GC_MSTYLE_NETACASE
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngCCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                    Exit Function
                End If

                If lngCCnt <> 0 And lngCCnt Mod lngMaxItem = 0 Then
                    lngGrpSub = lngGrpSub + 1
                End If
                lngCCnt = lngCCnt + 1
                lngCnt = lngCnt + 1
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_6 = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括作成処理（640x480） 
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2006.02.01 ソラン北陸 更新
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_7(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                   ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 6商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_7 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        '
        ' 更新 2006/02/01 取得Img 640x480用
        '　　　　　　　　↓未定　　
        strImageCD(0) = "VGS010" '白背景
        strImageCD(1) = "VGS007" '左メニュー
        strImageCD(2) = "VGS008" '中央
        strImageCD(3) = "VGS009" '右メニュー
        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try

            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 27) Then   '27          ' [グループ]グループ名文字 更新 2006/02/02
                Exit Function
            End If

            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 24) Then    '24        ' [グループ]品名文字 更新 2006/02/02
                Exit Function
            End If


        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                strcount = Len(Trim$(objRows("GROUPNM")))

                If strcount < 7 Then
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 27) Then   '27          ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                Else
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 24) Then   '27          ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                End If
                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Or strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                            Exit Function
                        End If
                    End If
                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            lngMaxItem = 8 '更新 2006/02/20 11
                        Case GC_MSTYLE_LISTPIC
                            lngMaxItem = 6
                        Case GC_MSTYLE_LISTPIC4
                            lngMaxItem = 6
                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 8
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                    lngItemCnt = lngItemCnt + 1
                End If
                ' --------------------

                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)


                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If

                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP3_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else
                                lngSubNo2 = lngSubNo2 + 1                     ' --- Bパターン ---
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If
                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = 0
                            .objFont = objFont(0)
                            If strcount < 7 Then
                                .lngCharHeight = LC_TITLE3_HEIGHT
                            Else
                                .lngCharHeight = LC_TITLE3_HEIGHT - 10
                            End If
                            .lngCharWidth = LC_TITLE3_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                    Else
                        If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - (lngSubX - 10)
                                lngImgX = lngImgX - (lngSubX - 10)
                            Else
                                Exit Function
                            End If
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        If strcount < 7 Then
                            .lngCharHeight = LC_TITLE3_HEIGHT
                        Else
                            .lngCharHeight = LC_TITLE3_HEIGHT - 10
                        End If
                        .lngCharWidth = LC_TITLE3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力2
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    .lngCharLower = 5
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 5
                        .objFont = objFont(1)
                        .lngCharHeight = LC_ITEM3_HEIGHT
                        .lngCharWidth = LC_ITEM3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then
                        If Not LF_MakeTJGrpGrph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                            Exit Function
                        End If
                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR                                  ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_3(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_LISTPIC                                  '画像型画像生成(6分割版)


                        If Not LF_MakeGJGraphics_3(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_LISTPIC4                                  '更新 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_3(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_PICTJ                                     ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_3(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_PIC12                                     '画像型画像生成(6分割版)


                        If Not LF_MakeGJGraphics_3(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_PIC4                                     '更新 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_3(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                        'Case GC_MSTYLE_LISTPIC4                                 ' 画像型画像生成(４分割版)
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                        '        Exit Function
                        '    End If
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                        '        Exit Function
                        '    End If
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02 Photo6追加
                        Case GC_MSTYLE_LISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02 Photo6追加
                        Case GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1


                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_LISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                End Select

                lngCnt = lngCnt + 1
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_7 = True

    End Function

    '---------------------------------------------------
    ' 更新履歴 2006/03/15 ネタケース時6分割画像作成対応 
    '---------------------------------------------------
    Private Function LF_CreateMenu_8(ByVal pData As DataSet, _
                                 ByVal pStatus As CNL1810, _
                                 ByVal pCreateMode As typCreateMode, _
                                 ByVal pFlag As String, _
                                 Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String
        Dim strSKey As String
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing
        '更新 ネタケース時遷移対応
        Dim strswitch1 As String
        Dim strswitch2 As String
        Dim strswitch3 As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_8 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        If pFlag = "0" Then
            'ネタケースではないと判定
            strswitch1 = GC_MSTYLE_NOLIST
            strswitch2 = GC_MSTYLE_NOLISTSTR
            strswitch3 = GC_MSTYLE_NOLISTPIC4
        Else
            'ネタケースと判定
            strswitch1 = GC_MSTYLE_NETASTR
            strswitch2 = GC_MSTYLE_NETAPIC
            strswitch3 = GC_MSTYLE_NETACASE
        End If

        '------------------------------
        ' 画像コード設定
        '------------------------------

        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード


        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            'テスト変数 
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            lngMaxItem = 8
                        Case strswitch2, GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case strswitch3, GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select
                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    If (Trim$(objRows("MENUSTYLE")) = strswitch1 Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        If Not LF_MakeTJGrpGrph_3(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                        If Not LF_MakeTJGraphics_3(strTJMaterialID, _
                                                 objRows, _
                                                 lngDspOrder, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngGrpNo, _
                                                 1, _
                                                 pCreateMode) Then
                            Exit Function
                        End If

                    Case strswitch2, GC_MSTYLE_PIC12 '更新↓ 2006/02/02 9→12分割
                        If Not LF_MakeGJGraphics_3(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "6") Then ' 日本語画像生成
                            Exit Function
                        End If


                    Case strswitch3, GC_MSTYLE_PIC4
                        If Not LF_MakeGJGraphics_3(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "4") Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case Else
                        Exit Function

                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case strswitch2, GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02
                        Case strswitch3, GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                    Case strswitch2, GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case strswitch3, GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                Dim integ As Integer = pStatus.pgs_Status.Value
                Dim str As String = pStatus.pgs_Status.Value
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_8 = True
    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：飲み放題メニュー画像一括生成処理
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2006.04.05 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_9(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                   ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 14商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_9 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "S007JC"
        strImageCD(1) = "S008JC"
        strImageCD(2) = "S009JC"
        strImageCD(3) = "S010JC"
        strTJMaterialID(0) = "S011JA"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 26) Then            ' [グループ]グループ名文字
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 18) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM_HEIGHT
                                .lngCharWidth = LC_ITEM_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt) Then
                            Exit Function
                        End If
                    End If

                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN_WIDTH - (LC_LEFT_MARGIN + LC_RIGHT_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    strFKey = "000"
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NOLIST
                            lngMaxItem = 13
                        Case GC_MSTYLE_NOLISTSTR
                            lngMaxItem = 12
                        Case GC_MSTYLE_NOLISTPIC4
                            lngMaxItem = 4

                        Case GC_MSTYLE_LISTSTR
                            lngMaxItem = 13
                        Case GC_MSTYLE_LISTPIC
                            lngMaxItem = 12
                        Case GC_MSTYLE_LISTPIC4
                            lngMaxItem = 4

                            '--- (2006.02.02) メニュー画像転送処理 ------------------
                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 13
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 12
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 4
                            '--------------------------------------------------------
                        Case Else
                            'Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                ' --- (2006.02.02) メニュー画像転送処理 --------------------------------------------------------------------------
                'If lngItemCnt = (lngMaxItem - 1) And _
                '   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                '   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                    lngItemCnt = lngItemCnt + 1
                End If
                ' ----------------------------------------------------------------------------------------------------------------
                ' --------------------


                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)

                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If


                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH * 2) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM2_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------

                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM_HEIGHT
                                .lngCharWidth = LC_ITEM_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.07.03) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH * 2) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE_WIDTH) + (LC_ITEM_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else                                            ' --- Bパターン ---
                                lngSubNo2 = lngSubNo2 + 1
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN_WIDTH - (LC_LEFT_MARGIN + LC_RIGHT_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If
                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = 0
                            .objFont = objFont(0)
                            .lngCharHeight = LC_TITLE_HEIGHT
                            .lngCharWidth = LC_TITLE_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                    Else
                        If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM_HEIGHT
                                .lngCharWidth = LC_ITEM_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - (lngSubX - 10)
                                lngImgX = lngImgX - (lngSubX - 10)
                            Else
                                Exit Function
                            End If
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        .lngCharHeight = LC_TITLE_HEIGHT
                        .lngCharWidth = LC_TITLE_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM_HEIGHT
                    .lngCharWidth = LC_ITEM_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 13
                        .objFont = objFont(1)
                        .lngCharHeight = LC_ITEM_HEIGHT
                        .lngCharWidth = LC_ITEM_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                '--- (2006.02.02) メニュー画像転送処理 ----------------------------------------------------------------------
                'If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                    (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then
                        'L_FreeMode = False     '2006.06.28 飲み放題対応修正
                        'ジャンル名短冊作成（通常メニューで既に作成済みでも上書きする↓）
                        If Not LF_MakeTJGrpGrph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                            'L_FreeMode = True  '2006.06.28 飲み放題対応修正
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ                                ' 短冊型画像生成
                        '---2006.06.28 飲み放題対応修正---------------
                        'If Not LF_MakeTJGraphics(strTJMaterialID, _
                        '                         objRows, _
                        '                         lngItemOrderCnt, _
                        '                         GC_EJKBN_J, _
                        '                         lngGrpNo, _
                        '                         lngSubNo, _
                        '                         lngSubNo2, _
                        '                         pCreateMode) Then
                        '    Exit Function
                        'End If
                        If Not LF_MakeTJGraphics_FREE(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                        '---------------------------------------------
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12                                ' 画像型画像生成(12分割版)
                        '---2006.06.28 飲み放題対応修正----------------
                        'If Not LF_MakeGJGraphics(strGJMaterialID, _
                        '                         objRows, _
                        '                         lngItemOrderCnt, _
                        '                         GC_EJKBN_J, _
                        '                         lngGrpNo, _
                        '                         lngSubNo, _
                        '                         lngSubNo2, _
                        '                         lngItemLineCnt, _
                        '                         pCreateMode) Then
                        '    Exit Function
                        'End If
                        If Not LF_MakeGJGraphics_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                        '----------------------------------------------
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4                               ' 画像型画像生成(４分割版)
                        '2006.06.28 飲み放題対応修正-----------------------------------
                        'If Not LF_MakeNetaGraph(objRows, lngDspOrder, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                        '    Exit Function
                        'End If
                        'If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                        '    Exit Function
                        'End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 飲み放題品切れ商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 飲み放題品切れ商品画像出力
                            Exit Function
                        End If
                        '---------------------------------------------------------------
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                            '--- (2006.02.02) メニュー画像転送 ---------------------------------------------------
                        Case GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                            '-------------------------------------------------------------------------------------
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR
                        If lngItemCnt Mod 4 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12       '(2006.02.02) メニュー画像 
                        If lngItemCnt Mod 4 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC4       '(2006.02.02) メニュー画像
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If

                End Select

                lngCnt = lngCnt + 1
                'pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM_HEIGHT
                    .lngCharWidth = LC_ITEM_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_9 = True

    End Function

    Private Function LF_CreateMenu_10(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String
        Dim strSKey As String
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_10 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strTJMaterialID(0) = "S011JA"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                        ' (画像)売り切れ画像コード

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("MENUID")) Then
                    'If lngCnt = 0 Then
                    'If strFKey <> Trim$(objRows("FIRSTKEY")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    ''lngGrpSubNo = 0
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("MENUID"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NOLIST
                            lngMaxItem = 13
                        Case GC_MSTYLE_NOLISTSTR
                            lngMaxItem = 12
                        Case GC_MSTYLE_NOLISTPIC4
                            lngMaxItem = 4

                            '--- (2006.02.08) メニュー画像転送処理 ------------------
                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 13
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 12
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 4
                            '--------------------------------------------------------
                        Case Else
                            Exit Function
                    End Select
                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    'If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NOLIST Then     '--- (2006.02.08) メニュー画像追加
                    If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NOLIST) Or (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        L_FreeMode = False
                        If Not LF_MakeTJGrpGrph(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            L_FreeMode = True
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = "000"
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ      '---(2006.02.08) メニュー画像追加
                        'Case GC_MSTYLE_NOLIST
                        '-----2006.06.28 飲み放題対応修正-----------------------------
                        'If Not LF_MakeTJGraphics(strTJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, pCreateMode) Then ' 日本語画像生成
                        '    Exit Function
                        'End If
                        '--- 飲み放題用画像
                        If Not LF_MakeTJGraphics_FREE(strTJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If
                        '--------------------------------------------------------------
                    Case GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12   '---(2006.02.08) メニュー画像追加
                        'Case GC_MSTYLE_NOLISTSTR
                        '-----2006.06.28 飲み放題対応修正------------------------------
                        'If Not LF_MakeGJGraphics(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode) Then ' 日本語画像生成
                        '    Exit Function
                        'End If
                        '-- 飲み放題用画像
                        If Not LF_MakeGJGraphics_FREE(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If
                        '--------------------------------------------------------------
                    Case GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   '---(2006.02.08) メニュー画像追加
                        'Case GC_MSTYLE_NOLISTPIC4
                        '-----2006.06.28 飲み放題対応修正------------------------------
                        'If Not LF_MakeNetaGraph(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, True, pCreateMode) Then ' 通常商品画像出力
                        '    Exit Function
                        'End If
                        'If Not LF_MakeNetaGraph(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                        '    Exit Function
                        'End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, True, pCreateMode) Then ' 飲み放題画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, False, pCreateMode) Then ' 飲み放題品切れ画像出力
                            Exit Function
                        End If
                        '---------------------------------------------------------------
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = "000"
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ      '--- (2006.02.08) メニュー画像作成
                            'Case GC_MSTYLE_NOLIST
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12   '--- (2006.02.08) メニュー画像作成
                            'Case GC_MSTYLE_NOLISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   '--- (2006.02.08) メニュー画像作成
                            'Case GC_MSTYLE_NOLISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ      '---(2006.02.08) メニュー画像作成
                        'Case GC_MSTYLE_NOLIST
                    Case GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12   '---(2006.02.08) メニュー画像作成
                        'Case GC_MSTYLE_NOLISTSTR
                        If lngItemCnt Mod 4 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   '---(2006.02.08) メニュー画像作成
                        'Case GC_MSTYLE_NOLISTPIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                'pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_10 = True
    End Function

    Private Function LF_CreateMenu_11(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont As Font = Nothing
        Dim objRect As RectangleF
        Dim strKey(2) As String
        Dim lngCnt As Long
        Dim lngPCnt As Long
        Dim lngCCnt As Long
        Dim objRows As DataRow = Nothing
        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim strImageCD(0) As String
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim lngLine As Long
        Dim lngGrpSub As Long
        Dim lngMaxItem As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_11 = False
        strImageCD(0) = "S036UC"                                            ' ジャンル名画像コード
        strTJMaterialID(0) = "S011JA"                                       ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                       ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                       ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                       ' (画像)売り切れ画像コード
        lngPCnt = 0                                                         ' 親レコードの表示順カウンタ
        lngCCnt = 0                                                         ' 子レコードの表示順カウンタ
        strKey(0) = ""                                                      ' (キー項目)メニューＩＤ
        strKey(1) = ""                                                      ' (   〃   )ジャンルＩＤ
        lngLine = 1
        lngGrpSub = 0

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then               ' ジャンル名文字
                Exit Function
            End If

            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count

                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                If strKey(0) <> Trim$(objRows("MENUID")) Or _
                   strKey(1) <> Trim$(objRows("SECONDKEY")) Then

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NETASTR
                            lngMaxItem = 13
                        Case GC_MSTYLE_NETAPIC
                            lngMaxItem = 12
                        Case GC_MSTYLE_NETACASE
                            lngMaxItem = 4
                        Case Else
                            Exit Function
                    End Select

                    If strKey(0) <> Trim$(objRows("MENUID")) Then
                        lngPCnt = 0
                        lngLine = 1
                    Else
                        lngPCnt = lngPCnt + 1                                   ' 親レコードの表示順カウンタ
                        If lngPCnt <> 0 And lngPCnt Mod 5 = 0 Then
                            lngLine = lngLine + 1
                        End If
                    End If
                    lngCCnt = 1
                    lngGrpSub = 1

                    '------------------------------
                    ' ジャンル名画像出力処理
                    '------------------------------
                    With udtParam
                        .strPutStrings = Trim$(objRows("GROUPNM"))
                        .objFont = objFont
                        .objColor = Color.Black
                        .lngCharLower = 0
                        .lngPositionY = 5
                    End With
                    Call LF_PutHString2(udtParam, objGraph)

                    '------------------------------
                    ' 生成画像情報テーブル更新処理
                    '------------------------------
                    With udtTPD020
                        .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                        .MENUBTNID = "000"
                        .MENUGRPID = Format$(lngPCnt, "000")
                        .MENUGRPID2 = Format$(lngGrpSub, "00")
                        .MENUGRPID3 = "00"
                        .MENULV = "0"
                        .LINE = "L" & Format$(lngLine, "0000")
                        .REFID = Space(1)
                        .REFGRP = Trim$(objRows("GOODSGROUP"))
                        .DISPORDER = Format$(lngPCnt, "000")
                        .UPDID = GC_UPDID
                        .UPDYMD = Now
                        .SELLKBN = GC_OOS_ONSELE
                    End With
                    If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, Nothing) Then
                        Exit Function
                    End If
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If

                    '------------------------------
                    ' ジャンル名短冊出力
                    '------------------------------
                    If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_NETASTR Then
                        L_FreeMode = False
                        If Not LF_MakeTJGrpGrph(objRows, lngCCnt, lngPCnt, lngGrpSub, 1) Then
                            L_FreeMode = True
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = "000"
                            .MENUGRPID = Format$(lngPCnt, "000")
                            .MENUGRPID2 = Format$(lngGrpSub, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngCCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0) Then
                            Exit Function
                        End If

                        lngCCnt = lngCCnt + 1
                    End If

                    '------------------------------
                    ' キー項目値保存/カウンタクリア
                    '------------------------------
                    strKey(0) = Trim$(objRows("MENUID"))
                    strKey(1) = Trim$(objRows("SECONDKEY"))
                End If

                '------------------------------
                ' 商品一覧画像生成処理
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_NETASTR  ' 短冊
                        '2006.06.28 飲み放題対応修正-------------------------------------
                        'If Not LF_MakeTJGraphics(strTJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, pCreateMode) Then ' 日本語画像生成
                        '    Exit Function
                        'End If
                        '--- 飲み放題画像
                        If Not LF_MakeTJGraphics_FREE(strTJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If
                        '----------------------------------------------------------------
                    Case GC_MSTYLE_NETAPIC  ' 画像(12)
                        '2006.06.28 飲み放題対応修正-------------------------------------
                        'If Not LF_MakeGJGraphics(strGJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, lngLine, pCreateMode) Then  ' 日本語画像生成
                        '    Exit Function
                        'End If
                        '-- 飲み放題画像
                        If Not LF_MakeGJGraphics_FREE(strGJMaterialID, objRows, lngCCnt, GC_EJKBN_J, lngPCnt, lngGrpSub, 1, lngLine, pCreateMode) Then  ' 日本語画像生成
                            Exit Function
                        End If
                        '----------------------------------------------------------------
                    Case GC_MSTYLE_NETACASE ' 画像(4)
                        '2006.06.28 飲み放題対応修正-------------------------------------
                        'If Not LF_MakeNetaGraph(objRows, lngCCnt, lngPCnt, lngGrpSub, True, pCreateMode) Then ' 通常商品画像出力
                        '    Exit Function
                        'End If
                        'If Not LF_MakeNetaGraph(objRows, lngCCnt, lngPCnt, lngGrpSub, False, pCreateMode) Then    ' 品切れ商品画像力
                        '    Exit Function
                        'End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngCCnt, lngPCnt, lngGrpSub, True, pCreateMode) Then    ' 飲み放題画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngCCnt, lngPCnt, lngGrpSub, False, pCreateMode) Then    ' 飲み放題品切れ画像出力
                            Exit Function
                        End If
                        '----------------------------------------------------------------
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = "000"
                    .MENUGRPID = Format$(lngPCnt, "000")
                    .MENUGRPID2 = Format$(lngGrpSub, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NETASTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_NETAPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                        Case GC_MSTYLE_NETACASE
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngCCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0) Then
                    Exit Function
                End If

                If lngCCnt <> 0 And lngCCnt Mod lngMaxItem = 0 Then
                    lngGrpSub = lngGrpSub + 1
                End If
                lngCCnt = lngCCnt + 1
                lngCnt = lngCnt + 1
                'pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_11 = True

    End Function


    Private Function LF_CreateMenu_12(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 14商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim blnKB(2) As Boolean

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_12 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "S007JC"
        strImageCD(1) = "S008JC"
        strImageCD(2) = "S009JC"
        strImageCD(3) = "S010JC"
        strTJMaterialID(0) = "S011JA"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "S011JB"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "S012JA"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "S012JB"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 26) Then            ' [グループ]グループ名文字
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 18) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ, GC_MSTYLE_NETASTR      '短冊型画像生成     2006.06.28 飲み放題対応修正
                        '2006.06.28 飲み放題対応修正--------------------------
                        '---飲み放題画像
                        If Not LF_MakeTJGraphics_FREE(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                        'Case GC_MSTYLE_LISTPIC                    '画像型画像生成(12分割版)
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12, GC_MSTYLE_NETAPIC     ' 画像型画像生成(12分割版) 2006.06.28 飲み放題対応修正
                        '2006.06.28 飲み放題対応修正--------------------------
                        '---飲み放題画像
                        If Not LF_MakeGJGraphics_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4, GC_MSTYLE_NETACASE  ' 画像型画像生成(４分割版)   2006.06.28 飲み放題対応修正
                        '2006.06.28 飲み放題対応修正--------------------------
                        If Not LF_MakeNetaGraph_FREE(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 飲み放題商品画像出力
                            Exit Function
                        End If
                        If Not LF_MakeNetaGraph_FREE(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 飲み放題品切れ商品画像出力
                            Exit Function
                        End If
                        '-----------------------------------------------------

                        '---2006.06.28 飲み放題対応 削除-----------------↓
                        'Case GC_MSTYLE_PICTJ       '--- (2006.02.02) メニュー画像
                        '    If Not LF_MakeTJGraphics(strTJMaterialID, _
                        '                             objRows, _
                        '                             lngItemOrderCnt, _
                        '                             GC_EJKBN_J, _
                        '                             lngGrpNo, _
                        '                             lngSubNo, _
                        '                             lngSubNo2, _
                        '                             pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_PIC12       '---(2006.02.02) メニュー画像
                        '    If Not LF_MakeGJGraphics(strGJMaterialID, _
                        '                             objRows, _
                        '                             lngItemOrderCnt, _
                        '                             GC_EJKBN_J, _
                        '                             lngGrpNo, _
                        '                             lngSubNo, _
                        '                             lngSubNo2, _
                        '                             lngItemLineCnt, _
                        '                             pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_PIC4       '---(2006.02.02) メニュー画像
                        '    If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode, True) Then
                        '        Exit Function
                        '    End If


                        'Case GC_MSTYLE_NOLIST      '---(2006.06.02) 追加
                        '    If Not LF_MakeTJGraphics(strTJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NOLISTSTR   '---(2006.06.02) 追加
                        '    If Not LF_MakeGJGraphics(strGJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, lngItemLineCnt, pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NOLISTPIC4  '---(2006.06.02) 追加
                        '    If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NETASTR  '---(2006.06.02) 追加
                        '    If Not LF_MakeTJGraphics(strTJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NETAPIC  '---(2006.06.02) 追加
                        '    If Not LF_MakeGJGraphics(strGJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, lngItemLineCnt, pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NETACASE '---(2006.06.02) 追加
                        '    If Not LF_MakeNetaGraph(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode, True) Then
                        '        Exit Function
                        '    End If
                        '---2006.06.28 飲み放題対応 削除-----------------↑

                    Case Else
                        Exit Function
                End Select

                lngCnt = lngCnt + 1

            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_12 = True

    End Function
    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括作成処理（800x480） 
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2006.06.07 ソラン北陸 更新
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_13(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                   ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 6商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_13 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        '
        ' 更新 2006/02/01 取得Img 800x480用
        '　　　　　　　　↓未定　　
        strImageCD(0) = "VGS010" '白背景
        strImageCD(1) = "VGS007" '左メニュー
        strImageCD(2) = "VGS008" '中央
        strImageCD(3) = "VGS009" '右メニュー
        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try

            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27          ' [グループ]グループ名文字 更新 2006/02/02
                Exit Function
            End If

            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 25) Then    '24        ' [グループ]品名文字 更新 2006/02/02
                Exit Function
            End If


        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                strcount = Len(Trim$(objRows("GROUPNM")))

                If strcount < 7 Then
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27 30         ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                Else
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27            ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                End If
                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Or strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                            Exit Function
                        End If
                    End If
                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            lngMaxItem = 9 '更新 2006/02/20 11 ジャンルタイトルも含めた個数
                        Case GC_MSTYLE_LISTPIC
                            lngMaxItem = 6
                        Case GC_MSTYLE_LISTPIC4
                            lngMaxItem = 6
                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 9
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                'If lngItemCnt = (lngMaxItem - 1) And _
                '   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                '   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                '    lngItemCnt = lngItemCnt + 1
                'End If
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                    lngItemCnt = lngItemCnt + 1
                End If

                ' --------------------

                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)


                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If

                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP3_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else
                                lngSubNo2 = lngSubNo2 + 1                     ' --- Bパターン ---
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If
                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = -2 '0
                            .objFont = objFont(0)
                            If strcount < 7 Then
                                .lngCharHeight = LC_TITLE3_HEIGHT
                            Else
                                .lngCharHeight = LC_TITLE3_HEIGHT - 10
                            End If
                            .lngCharWidth = LC_TITLE3_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                        'Else
                        '    If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                        '        With udtParam
                        '            .strPutStrings = ""
                        '            .lngPositionX = lngImgX
                        '            .lngCharLower = 13
                        '            .objFont = objFont(1)
                        '            .lngCharHeight = LC_ITEM3_HEIGHT
                        '            '.lngCharWidth = LC_ITEM3_WIDTH
                        '            '商品名は右詰表示する
                        '            .lngCharWidth = 12
                        '            .objColor = System.Drawing.Color.Black
                        '        End With
                        '        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                        '        If lngSubX <> 0 Then
                        '            lngScrX = lngScrX - (lngSubX - 10)
                        '            lngImgX = lngImgX - (lngSubX - 10)
                        '        Else
                        '            Exit Function
                        '        End If
                        'End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        If strcount < 7 Then
                            .lngCharHeight = LC_TITLE3_HEIGHT
                        Else
                            .lngCharHeight = LC_TITLE3_HEIGHT - 10
                        End If
                        .lngCharWidth = LC_TITLE3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力2
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    .lngCharLower = 5
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 5
                        .objFont = objFont(1)
                        .lngCharHeight = LC_ITEM3_HEIGHT
                        .lngCharWidth = LC_ITEM3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                'If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then
                        If Not LF_MakeTJGrpGrph_4(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                            Exit Function
                        End If
                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR                                  ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_4(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_LISTPIC                                  '画像型画像生成(6分割版)


                        If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_LISTPIC4                                  '更新 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_PICTJ                                     ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_4(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_PIC12                                     '画像型画像生成(6分割版)


                        If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_PIC4                                     '更新 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                        'Case GC_MSTYLE_LISTPIC4                                 ' 画像型画像生成(４分割版)
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                        '        Exit Function
                        '    End If
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                        '        Exit Function
                        '    End If
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02 Photo6追加
                        Case GC_MSTYLE_LISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02 Photo6追加
                        Case GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1


                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_LISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                End Select

                lngCnt = lngCnt + 1
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_13 = True

    End Function

    '----------------------------------------------------------------
    ' 更新履歴 2006/06/07 ネタケース時6分割画像作成対応(7インチ対応) 
    '----------------------------------------------------------------
    Private Function LF_CreateMenu_14(ByVal pData As DataSet, _
                                 ByVal pStatus As CNL1810, _
                                 ByVal pCreateMode As typCreateMode, _
                                 ByVal pFlag As String, _
                                 Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String
        Dim strSKey As String
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing
        '更新 ネタケース時遷移対応
        Dim strswitch1 As String
        Dim strswitch2 As String
        Dim strswitch3 As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_14 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        If pFlag = "0" Then
            'ネタケースではないと判定
            strswitch1 = GC_MSTYLE_NOLIST
            strswitch2 = GC_MSTYLE_NOLISTSTR
            strswitch3 = GC_MSTYLE_NOLISTPIC4
        Else
            'ネタケースと判定
            strswitch1 = GC_MSTYLE_NETASTR
            strswitch2 = GC_MSTYLE_NETAPIC
            strswitch3 = GC_MSTYLE_NETACASE
        End If

        '------------------------------
        ' 画像コード設定
        '------------------------------

        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード


        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            'テスト変数 
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("FIRSTKEY")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            lngMaxItem = 9
                        Case strswitch2, GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case strswitch3, GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select
                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    If (Trim$(objRows("MENUSTYLE")) = strswitch1 Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        If Not LF_MakeTJGrpGrph_4(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                        If Not LF_MakeTJGraphics_4(strTJMaterialID, _
                                                 objRows, _
                                                 lngDspOrder, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngGrpNo, _
                                                 1, _
                                                 pCreateMode) Then
                            Exit Function
                        End If

                    Case strswitch2, GC_MSTYLE_PIC12 '更新↓ 2006/02/02 9→12分割
                        If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "6") Then ' 日本語画像生成
                            Exit Function
                        End If


                    Case strswitch3, GC_MSTYLE_PIC4
                        If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "4") Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case Else
                        Exit Function

                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case strswitch2, GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02
                        Case strswitch3, GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                    Case strswitch2, GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case strswitch3, GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                Dim integ As Integer = pStatus.pgs_Status.Value
                Dim str As String = pStatus.pgs_Status.Value
                pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_14 = True
    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：飲み放題メニュー画像一括生成処理(７インチ版)
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2006.04.05 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_15(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                   ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 6商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_15 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "VGS010"
        strImageCD(1) = "VGS007"
        strImageCD(2) = "VGS008"
        strImageCD(3) = "VGS009"
        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then            ' [グループ]グループ名文字
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 25) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                strcount = Len(Trim$(objRows("GROUPNM")))

                If strcount < 7 Then
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27 30         ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                Else
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then   '27            ' [グループ]グループ名文字 更新 2006/02/02
                        Exit Function
                    End If
                End If

                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                            Exit Function
                        End If
                    End If

                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    'strFKey = Trim$(objRows("FIRSTKEY"))
                    strFKey = "000"
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_NOLIST
                            lngMaxItem = 9
                        Case GC_MSTYLE_NOLISTSTR
                            lngMaxItem = 6
                        Case GC_MSTYLE_NOLISTPIC4
                            lngMaxItem = 6

                        Case GC_MSTYLE_LISTSTR
                            lngMaxItem = 9
                        Case GC_MSTYLE_LISTPIC
                            lngMaxItem = 6
                        Case GC_MSTYLE_LISTPIC4
                            lngMaxItem = 6

                        Case GC_MSTYLE_PICTJ
                            lngMaxItem = 9
                        Case GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            'Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                ' --- (2006.02.02) メニュー画像転送処理 --------------------------------------------------------------------------
                'If lngItemCnt = (lngMaxItem - 1) And _
                '   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                '   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                    lngItemCnt = lngItemCnt + 1
                End If
                ' ----------------------------------------------------------------------------------------------------------------
                ' --------------------

                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)

                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If


                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------

                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        'If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), DispType.VGA) Then
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP3_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.07.03) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else                                            ' --- Bパターン ---
                                lngSubNo2 = lngSubNo2 + 1
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If
                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = -2 '0
                            .objFont = objFont(0)
                            If strcount < 7 Then
                                .lngCharHeight = LC_TITLE3_HEIGHT
                            Else
                                .lngCharHeight = LC_TITLE3_HEIGHT - 10
                            End If
                            .lngCharWidth = LC_TITLE3_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                    Else
                        'If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                        '    With udtParam
                        '        .strPutStrings = ""
                        '        .lngPositionX = lngImgX
                        '        .lngCharLower = 13
                        '        .objFont = objFont(1)
                        '        .lngCharHeight = LC_ITEM3_HEIGHT
                        '            '.lngCharWidth = LC_ITEM3_WIDTH
                        '            '商品名は右詰表示する
                        '            .lngCharWidth = 12
                        '            .objColor = System.Drawing.Color.Black
                        '    End With
                        '    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                        '    If lngSubX <> 0 Then
                        '        lngScrX = lngScrX - (lngSubX - 10)
                        '        lngImgX = lngImgX - (lngSubX - 10)
                        '    Else
                        '        Exit Function
                        '    End If
                        'End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        If strcount < 7 Then
                            .lngCharHeight = LC_TITLE3_HEIGHT
                        Else
                            .lngCharHeight = LC_TITLE3_HEIGHT - 10
                        End If
                        .lngCharWidth = LC_TITLE3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    .lngCharLower = 5
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 5
                        .objFont = objFont(1)
                        .lngCharHeight = LC_ITEM3_HEIGHT
                        .lngCharWidth = LC_ITEM3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                '--- (2006.02.02) メニュー画像転送処理 ----------------------------------------------------------------------
                'If Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                    (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then
                        'L_FreeMode = False     '2006.06.28 飲み放題対応修正
                        'ジャンル名短冊作成（通常メニューで既に作成済みでも上書きする↓）
                        If Not LF_MakeTJGrpGrph_4(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                            'L_FreeMode = True  '2006.06.28 飲み放題対応修正
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ               ' 短冊型画像生成
                        '---2006.06.28 飲み放題対応修正---------------
                        'If Not LF_MakeTJGraphics_4(strTJMaterialID, _
                        '                         objRows, _
                        '                         lngItemOrderCnt, _
                        '                         GC_EJKBN_J, _
                        '                         lngGrpNo, _
                        '                         lngSubNo, _
                        '                         lngSubNo2, _
                        '                         pCreateMode) Then
                        '    Exit Function
                        'End If
                        If Not LF_MakeTJGraphics_4_FREE(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                        '---------------------------------------------
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12               ' 画像6分割生成
                        '---2006.06.28 飲み放題対応修正----------------------
                        'If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                        '                           objRows, _
                        '                           lngItemOrderCnt, _
                        '                           GC_EJKBN_J, _
                        '                           lngGrpNo, _
                        '                           lngSubNo, _
                        '                           lngSubNo2, _
                        '                           lngItemLineCnt, _
                        '                           pCreateMode, _
                        '                           "6") Then
                        '    Exit Function
                        'End If

                        If Not LF_MakeGJGraphics_4_Free(strGJMaterialID, _
                                                   objRows, _
                                                   lngItemOrderCnt, _
                                                   GC_EJKBN_J, _
                                                   lngGrpNo, _
                                                   lngSubNo, _
                                                   lngSubNo2, _
                                                   lngItemLineCnt, _
                                                   pCreateMode, _
                                                   "6") Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4               ' 画像6分割（４分割対応の為）
                        '---2006.06.28 飲み放題対応修正----------------------
                        'If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                        '                         objRows, _
                        '                         lngItemOrderCnt, _
                        '                         GC_EJKBN_J, _
                        '                         lngGrpNo, _
                        '                         lngSubNo, _
                        '                         lngSubNo2, _
                        '                         lngItemLineCnt, _
                        '                         pCreateMode, _
                        '                         "4") Then
                        '    Exit Function
                        'End If
                        If Not LF_MakeGJGraphics_4_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                  "4") Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6)
                        Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6)
                        Case GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If

                End Select

                lngCnt = lngCnt + 1
                'pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.VGA) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_15 = True

    End Function


    Private Function LF_CreateMenu_16(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     ByVal pFlag As String, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String
        Dim strSKey As String
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim strswitch1 As String = Nothing
        Dim strswitch2 As String = Nothing
        Dim strswitch3 As String = Nothing
        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_16 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        If pFlag = "0" Then
            'ネタケースではないと判定
            strswitch1 = GC_MSTYLE_NOLIST
            strswitch2 = GC_MSTYLE_NOLISTSTR
            strswitch3 = GC_MSTYLE_NOLISTPIC4
        Else
            'ネタケースと判定
            strswitch1 = GC_MSTYLE_NETASTR
            strswitch2 = GC_MSTYLE_NETAPIC
            strswitch3 = GC_MSTYLE_NETACASE
        End If
        '------------------------------
        ' 画像コード設定
        '------------------------------
        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("MENUID")) Then
                    'If lngCnt = 0 Then
                    'If strFKey <> Trim$(objRows("FIRSTKEY")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    ''lngGrpSubNo = 0
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("MENUID"))
                    'strFKey = Trim$(objRows("FIRSTKEY"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            lngMaxItem = 9
                        Case strswitch2, GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case strswitch3, GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select
                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    If (Trim$(objRows("MENUSTYLE")) = strswitch1 Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        L_FreeMode = False
                        If Not LF_MakeTJGrpGrph_4(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            L_FreeMode = True
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = "000"
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                        '-----2006.06.28 飲み放題対応修正-----------------------------
                        'If Not LF_MakeTJGraphics_4(strTJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, pCreateMode) Then ' 日本語画像生成
                        '    Exit Function
                        'End If
                        '--- 飲み放題用画像
                        If Not LF_MakeTJGraphics_4_FREE(strTJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, pCreateMode) Then ' 日本語画像生成
                            Exit Function
                        End If
                        '--------------------------------------------------------------
                    Case strswitch2, GC_MSTYLE_PIC12
                        '-----2006.06.28 飲み放題対応修正------------------------------
                        'If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "6") Then ' 日本語画像生成
                        '    Exit Function
                        'End If
                        '-- 飲み放題用画像
                        If Not LF_MakeGJGraphics_4_FREE(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "6") Then ' 日本語画像生成
                            Exit Function
                        End If
                        '--------------------------------------------------------------
                    Case strswitch3, GC_MSTYLE_PIC4
                        '-----2006.06.28 飲み放題対応修正------------------------------
                        'If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "4") Then ' 通常商品画像出力
                        '    Exit Function
                        'End If
                        '-- 飲み放題用画像
                        If Not LF_MakeGJGraphics_4_FREE(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "4") Then ' 通常商品画像出力
                            Exit Function
                        End If
                        '--------------------------------------------------------------
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = "000"
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case strswitch2, GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6)
                        Case strswitch3, GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.VGA) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                    Case strswitch2, GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case strswitch3, GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                'pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_16 = True

    End Function

    '---2006.06.09 張本 ADD 通常メニュー画像も飲み放題画像に置き換えの為
    Private Function LF_CreateMenu_17(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 9商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim blnKB(2) As Boolean
        Dim strstring As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_17 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "VGS010"
        strImageCD(1) = "VGS007"
        strImageCD(2) = "VGS008"
        strImageCD(3) = "VGS009"
        strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then            ' [グループ]グループ名文字
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 25) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                strstring = Trim$(objRows("MENUSTYLE"))

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ, GC_MSTYLE_NETASTR      '短冊型画像生成     2006.06.28 飲み放題対応修正
                        '2006.06.28 飲み放題対応修正--------------------------
                        If Not LF_MakeTJGraphics_4_FREE(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12, GC_MSTYLE_NETAPIC     ' 画像型画像生成(12分割版) 2006.06.28 飲み放題対応修正
                        '2006.06.28 飲み放題対応修正--------------------------
                        If Not LF_MakeGJGraphics_4_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, "6") Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4, GC_MSTYLE_NETACASE  ' 画像型画像生成(４分割版)   2006.06.28 飲み放題対応修正
                        '2006.06.28 飲み放題対応修正--------------------------
                        If Not LF_MakeGJGraphics_4_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, "4") Then
                            Exit Function
                        End If
                        '-----------------------------------------------------
                        'Case GC_MSTYLE_PICTJ       '--- (2006.02.02) メニュー画像
                        '    If Not LF_MakeTJGraphics_4(strTJMaterialID, _
                        '                             objRows, _
                        '                             lngItemOrderCnt, _
                        '                             GC_EJKBN_J, _
                        '                             lngGrpNo, _
                        '                             lngSubNo, _
                        '                             lngSubNo2, _
                        '                             pCreateMode, True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_PIC12       '---(2006.02.02) メニュー画像
                        '    If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                        '                             objRows, _
                        '                             lngItemOrderCnt, _
                        '                             GC_EJKBN_J, _
                        '                             lngGrpNo, _
                        '                             lngSubNo, _
                        '                             lngSubNo2, _
                        '                             lngItemLineCnt, _
                        '                             pCreateMode, "6", True) Then
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_PIC4       '---(2006.02.02) メニュー画像
                        '    If Not LF_MakeGJGraphics_4(strGJMaterialID, _
                        '                             objRows, _
                        '                             lngItemOrderCnt, _
                        '                             GC_EJKBN_J, _
                        '                             lngGrpNo, _
                        '                             lngSubNo, _
                        '                             lngSubNo2, _
                        '                             lngItemLineCnt, _
                        '                             pCreateMode, "4", True) Then
                        '        Exit Function
                        '    End If


                        'Case GC_MSTYLE_NOLIST      '---(2006.06.02) 追加
                        '    If Not LF_MakeTJGraphics_4(strTJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, pCreateMode, True) Then ' 日本語画像生成
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NOLISTSTR   '---(2006.06.02) 追加
                        '    If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, lngItemLineCnt, pCreateMode, "6", True) Then ' 日本語画像生成
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NOLISTPIC4  '---(2006.06.02) 追加
                        '    If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, lngItemLineCnt, pCreateMode, "4", True) Then ' 日本語画像生成
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NETASTR  '---(2006.06.02) 追加
                        '    If Not LF_MakeTJGraphics_4(strTJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, pCreateMode, True) Then ' 日本語画像生成
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NETAPIC  '---(2006.06.02) 追加
                        '    If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, lngItemLineCnt, pCreateMode, "6", True) Then ' 日本語画像生成
                        '        Exit Function
                        '    End If

                        'Case GC_MSTYLE_NETACASE '---(2006.06.02) 追加
                        '    If Not LF_MakeGJGraphics_4(strGJMaterialID, objRows, lngItemOrderCnt, GC_EJKBN_J, lngGrpNo, lngSubNo, lngSubNo2, lngItemLineCnt, pCreateMode, "4", True) Then ' 日本語画像生成
                        '        Exit Function
                        '    End If

                    Case Else
                        Exit Function
                End Select

                lngCnt = lngCnt + 1

            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_17 = True

    End Function

    ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理-１２インチ用(800×600、SVGA)
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2008.01.11 ソラン北陸
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_18(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngScrX As Long                                                 ' 画面(スクリーン)Ｘ座標値
        Dim lngImgX As Long                                                 ' 画像Ｘ座標値
        Dim udtParam As typPutVString
        Dim lngSubX As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngLine As Long                                                 ' 表示段
        Dim strMenuID As String = Nothing                                             ' 現在処理中のメニューＩＤ
        Dim strGRPID As String = Nothing
        Dim strGRPID2 As String = Nothing
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 6商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemCnt As Long                                              ' 出力処理直後にカウントアップする
        Dim blnTitleFlg As Boolean
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long
        Dim lngMaxItem As Long
        Dim blnKB(2) As Boolean
        Dim lngPutItem As Long
        Dim lngblnKB1Cnt As Long
        Dim lngGOODSline As Long
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_18 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "SVGA43"                                             ' 白背景
        strImageCD(1) = "SVGA40"                                             ' 左メニュー
        strImageCD(2) = "SVGA41"                                             ' 中央
        strImageCD(3) = "SVGA42"                                             ' 右メニュー
        strTJMaterialID(0) = "SVGA68"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "SVGA68"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "SVGA58"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "SVGA58"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If
        lngImgX = objBitmap(0).Width - objBitmap(1).Width
        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then            ' [グループ]グループ名文字
                Exit Function
            End If

            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 25) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                strcount = Len(Trim$(objRows("GROUPNM")))

                If strcount < 7 Then
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then    ' [グループ]グループ名文字
                        Exit Function
                    End If
                Else
                    If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then    ' [グループ]グループ名文字
                        Exit Function
                    End If
                End If

                '------------------------------
                ' 第一キー評価(メニューグループ)
                '------------------------------
                If strMenuID <> Trim$(objRows("MENUID")) Then
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strFKey)) <> 0 Then                        ' ループ初回は行わない
                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.SVGA) Then
                            Exit Function
                        End If
                    End If
                    '------------------------------
                    ' 初期化
                    '------------------------------
                    lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                    strMenuID = Trim$(objRows("MENUID"))
                    strFKey = "000"
                    strSKey = ""
                    lngDspOrder = 1
                    lngLine = 1
                    lngGrpNo = 0
                    lngSubNo = 1
                    lngSubNo2 = 1
                    lngItemCnt = 0
                    lngPutItem = 0
                    lngblnKB1Cnt = 0

                    ' １グループ内の最大商品数
                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ
                            lngMaxItem = 12
                        Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            'Exit Function
                    End Select
                End If

                ' --- (2003.11.17) ---
                ' 価格別表示&ジャンル名表示の場合、及びグループ別表示の場合は、最終アイテムがジャンル名短冊であってはならないため、
                ' 出力数カウンタをダミーでインクリメントし、強制的にメニューグループを終了させる
                'If lngItemCnt = (lngMaxItem - 1) And _
                '   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                '   Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Then
                '    lngItemCnt = lngItemCnt + 1
                'End If
                If lngItemCnt = (lngMaxItem - 1) And _
                   strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) And _
                   (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                    lngItemCnt = lngItemCnt + 1
                End If

                ' --------------------

                '------------------------------
                ' 商品グループ初期処理
                '------------------------------
                blnKB(0) = IIf(strSKey <> Trim$(objRows("SECONDKEY")), True, False)
                blnKB(2) = IIf(lngItemCnt >= lngMaxItem, True, False)


                If Len(Trim$(objRows("GOODSNMJ2"))) = 0 Then
                    lngGOODSline = 2
                Else
                    lngGOODSline = 3
                End If

                If blnKB(0) = True Or blnKB(2) = True Then

                    ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                    If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    Else
                        blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                    End If
                    ' ----------------------------------------------------------

                Else

                    blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)

                End If

                If blnKB(0) = True Or blnKB(1) = True Or blnKB(2) = True Then

                    blnTitleFlg = True
                    '------------------------------
                    ' バッファリング画像出力処理
                    '------------------------------
                    If Len(Trim$(strSKey)) <> 0 Then                            ' ループ初回は行わない

                        If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                            With udtParam
                                .strPutStrings = ""
                                .lngPositionX = lngImgX
                                .lngCharLower = 13
                                .objFont = objFont(1)
                                .lngCharHeight = LC_ITEM3_HEIGHT
                                .lngCharWidth = LC_ITEM3_WIDTH
                                .objColor = System.Drawing.Color.Black
                            End With
                            lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                            If lngSubX <> 0 Then
                                lngScrX = lngScrX - lngSubX
                                lngImgX = lngImgX - lngSubX
                            Else
                                Exit Function
                            End If
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "0"
                            .LINE = "L" & Format$(lngLine, "0000")
                            .REFID = ""
                            .REFGRP = ""
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                            .SELLKBN = GC_OOS_NONE
                        End With
                        If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.SVGA) Then
                            Exit Function
                        End If
                        lngScrX = lngScrX - (objBitmap(3).Width + LC_GROUP3_MARGIN)
                        lngDspOrder = lngDspOrder + 1

                        ' --- (2004.02.22) 判定式を条件によって切り替える ----------
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH * 2) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        Else
                            blnKB(1) = IIf(lngScrX < (objBitmap(1).Width + (LC_TITLE3_WIDTH) + (LC_ITEM3_WIDTH * lngGOODSline) + objBitmap(3).Width), True, False)
                        End If
                        ' ----------------------------------------------------------

                        '------------------------------
                        ' グループ区切り判定
                        '------------------------------
                        If blnKB(0) Then                                    ' --- Aパターン ---
                            lngSubNo = 1
                            lngSubNo2 = 1
                            lngGrpNo = lngGrpNo + 1
                        Else
                            If blnKB(2) Then                                ' --- @パターン ---
                                lngSubNo = lngSubNo + 1
                                lngSubNo2 = 1
                                If Not blnKB(1) Then                        ' タイトルフラグ抑止
                                    blnTitleFlg = False
                                End If
                            Else
                                lngSubNo2 = lngSubNo2 + 1                     ' --- Bパターン ---
                            End If
                        End If

                        '------------------------------
                        ' グループキーのクリア
                        '------------------------------
                        If blnKB(0) Or blnKB(1) Then
                            strGRPID = ""
                        End If
                        If blnKB(0) Or blnKB(2) Then
                            strGRPID2 = ""
                        End If

                        '------------------------------
                        ' 初期化
                        '------------------------------
                        If blnKB(1) Then
                            lngScrX = LC_SCREEN3_WIDTH - (LC_LEFT3_MARGIN + LC_RIGHT3_MARGIN)
                            lngLine = lngLine + 1
                            'lngSubNo = 1
                            If objRows("GROUPKBN") = GC_ORDER_PRICE Or objRows("GROUPKBN") = GC_ORDER_PRICE2 Then
                                blnTitleFlg = True
                            End If
                        End If

                        If blnKB(1) = False Or blnKB(2) = True Or blnKB(0) = True Then
                            lngItemCnt = 0
                            lngPutItem = 0
                        Else
                            lngblnKB1Cnt = 0
                        End If

                        strMenuID = Trim$(objRows("MENUID"))
                    End If

                    '------------------------------
                    ' バッファ領域初期化
                    '------------------------------
                    If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                        Exit Function
                    End If

                    lngImgX = objBitmap(0).Width - objBitmap(1).Width
                    lngScrX = lngScrX - objBitmap(1).Width

                    If blnKB(0) = True Or blnKB(2) = True Then
                        lngItemOrderCnt = 0
                        lngItemLineCnt = 1
                    End If

                    '------------------------------
                    ' グループタイトル出力
                    '------------------------------
                    If blnTitleFlg Then
                        With udtParam
                            If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                                .strPutStrings = RTrim$(objRows("GROUPNM"))
                            Else
                                .strPutStrings = GF_ChgNumeric(Trim$(objRows("SECONDKEY"))) & "円"
                            End If
                            .lngPositionX = lngImgX
                            .lngCharLower = -2 '0
                            .objFont = objFont(0)
                            If strcount < 7 Then
                                '.lngCharHeight = LC_TITLE3_HEIGHT
                                .lngCharHeight = LC_TITLE3_HEIGHT - 8   '---  2006.10.27　12インチ対応
                            Else
                                '.lngCharHeight = LC_TITLE3_HEIGHT - 10
                                .lngCharHeight = LC_TITLE3_HEIGHT - 12  '---  2006.10.27　12インチ対応
                            End If
                            .lngCharWidth = LC_TITLE3_WIDTH
                            .objColor = System.Drawing.Color.Black
                        End With
                        ' 縦書き文字列分解出力
                        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                        If lngSubX <> 0 Then
                            lngScrX = lngScrX - lngSubX
                            lngImgX = lngImgX - lngSubX
                        Else
                            Exit Function
                        End If
                        If Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP Then
                            strGRPID = Trim$(objRows("GOODSGROUP"))
                        End If

                    Else
                        '    If Trim$(objRows("GROUPKBN")) <> GC_ORDER_PRICE2 Then
                        '        With udtParam
                        '            .strPutStrings = ""
                        '            .lngPositionX = lngImgX
                        '            .lngCharLower = 13
                        '            .objFont = objFont(1)
                        '            .lngCharHeight = LC_ITEM3_HEIGHT
                        '            '.lngCharWidth = LC_ITEM3_WIDTH
                        '            '商品名は右詰表示する
                        '            .lngCharWidth = 12
                        '            .objColor = System.Drawing.Color.Black
                        '        End With
                        '        lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                        '        If lngSubX <> 0 Then
                        '            lngScrX = lngScrX - (lngSubX - 10)
                        '            lngImgX = lngImgX - (lngSubX - 10)
                        '        Else
                        '            Exit Function
                        '        End If
                        'End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                If strGRPID <> Trim$(objRows("GOODSGROUP")) And _
                   Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Then
                    '------------------------------
                    ' 商品グループのキー割れ判定
                    '------------------------------
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GROUPNM"))
                        .lngPositionX = lngImgX
                        .lngCharLower = 0
                        .objFont = objFont(0)
                        If strcount < 7 Then
                            .lngCharHeight = LC_TITLE3_HEIGHT
                        Else
                            .lngCharHeight = LC_TITLE3_HEIGHT - 10
                        End If
                        .lngCharWidth = LC_TITLE3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    ' 縦書き文字列分解出力
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                    strGRPID = Trim$(objRows("GOODSGROUP"))
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                With udtParam
                    .strPutStrings = RTrim$(objRows("GOODSNMJ"))
                    .lngPositionX = lngImgX
                    '.lngCharLower = 5
                    .lngCharLower = 20                     '---  2006.10.27　12インチ対応
                    .objFont = objFont(1)
                    '.lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharHeight = LC_ITEM3_HEIGHT - 3   '---  2006.10.27　12インチ対応
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If

                '------------------------------
                ' 商品名出力処理
                '------------------------------
                If Len(Trim$(objRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = RTrim$(objRows("GOODSNMJ2"))
                        .lngPositionX = lngImgX
                        '.lngCharLower = 5
                        .lngCharLower = 20                   '---  2006.10.27　12インチ対応
                        .objFont = objFont(1)
                        '.lngCharHeight = LC_ITEM3_HEIGHT
                        .lngCharHeight = LC_ITEM3_HEIGHT - 3 '---  2006.10.27　12インチ対応
                        .lngCharWidth = LC_ITEM3_WIDTH
                        .objColor = System.Drawing.Color.Black
                    End With
                    lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                    If lngSubX <> 0 Then
                        lngScrX = lngScrX - lngSubX
                        lngImgX = lngImgX - lngSubX
                    Else
                        Exit Function
                    End If
                End If

                '------------------------------
                ' ジャンル名短冊生成
                '------------------------------
                'If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                '   (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                If (Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_LISTSTR Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) And _
                     (Trim$(objRows("GROUPKBN")) = GC_ORDER_PRICE2 Or Trim$(objRows("GROUPKBN")) = GC_ORDER_GROUP) Then
                    If strGRPID2 <> Trim$(objRows("GOODSGROUP")) Then

                        'If Not LF_MakeTJGrpGrph_4(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then
                        If Not LF_MakeTJGrpGrph_2(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, lngSubNo2) Then

                            Exit Function
                        End If
                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                            .MENUBTNID = strFKey
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngSubNo, "00")
                            .MENUGRPID3 = Format$(lngSubNo2, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngItemOrderCnt, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                            Exit Function
                        End If

                        lngItemOrderCnt = lngItemOrderCnt + 1
                        lngItemCnt = lngItemCnt + 1
                        strGRPID2 = Trim$(objRows("GOODSGROUP"))
                    End If
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ       ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_2_FREE(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12    ' 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_2_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4   ' 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_2_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If
                        'Case GC_MSTYLE_LISTPIC4                             ' 画像型画像生成(４分割版)
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, True, pCreateMode) Then ' 通常商品画像出力
                        '        Exit Function
                        '    End If
                        '    If Not LF_MakeNetaGraph_3(objRows, lngItemOrderCnt, lngGrpNo, lngSubNo, False, pCreateMode) Then ' 品切れ商品画像力
                        '        Exit Function
                        '    End If
                    Case Else
                        Exit Function
                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                    .MENUBTNID = strFKey
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngSubNo, "00")
                    .MENUGRPID3 = Format$(lngSubNo2, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6)
                        Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4)
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngItemOrderCnt, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                    Exit Function
                End If

                lngItemOrderCnt = lngItemOrderCnt + 1                       ' 表示順カウンタ
                lngItemCnt = lngItemCnt + 1                                 ' 出力数カウンタ
                lngPutItem = lngPutItem + 1                                 ' 出力数カウンタ（メニューグループ画像内出力数）
                lngblnKB1Cnt = lngblnKB1Cnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                    Case GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                        '更新 2006/02/20 8ｲﾝﾁ対応　4分割→6分割
                    Case GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 Then
                            lngItemLineCnt = lngItemLineCnt + 1
                        End If
                End Select

                lngCnt = lngCnt + 1
                ' pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

            End While

            If lngPutItem = 1 Or lngblnKB1Cnt = 1 Then
                With udtParam
                    .strPutStrings = ""
                    .lngPositionX = lngImgX
                    .lngCharLower = 13
                    .objFont = objFont(1)
                    .lngCharHeight = LC_ITEM3_HEIGHT
                    .lngCharWidth = LC_ITEM3_WIDTH
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objGraph, objBitmap(2))   ' 縦書き文字列分解出力
                If lngSubX <> 0 Then
                    lngScrX = lngScrX - lngSubX
                    lngImgX = lngImgX - lngSubX
                Else
                    Exit Function
                End If
            End If

            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, strMenuID)
                .MENUBTNID = strFKey
                .MENUGRPID = Format$(lngGrpNo, "000")
                .MENUGRPID2 = Format$(lngSubNo, "00")
                .MENUGRPID3 = Format$(lngSubNo2, "00")
                .MENULV = "0"
                .LINE = "L" & Format$(lngLine, "0000")
                .REFID = ""
                .REFGRP = ""
                .DISPORDER = Format$(lngDspOrder, "000")
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, lngImgX, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GroupImage, objBitmap(3), lngItemCnt, DispType.SVGA) Then
                Exit Function
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_18 = True

    End Function


    ' --------------------------------------------------------------------------------
    ' 　機　　能：メニュー画像一括生成処理(ネタケース時6分割画像作成対応)-１２インチ用(800×600、SVGA)
    ' 　機能概要：省略
    ' 　引　　数：なし
    ' 　戻 り 値：なし
    ' 　履　　歴：2008.01.11 ソラン北陸
    ' --------------------------------------------------------------------------------
    Private Function LF_CreateMenu_19(ByVal pData As DataSet, _
                                 ByVal pStatus As CNL1810, _
                                 ByVal pCreateMode As typCreateMode, _
                                 ByVal pFlag As String, _
                                 Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim objRows As DataRow = Nothing
        Dim strFKey As String = Nothing
        Dim strSKey As String = Nothing
        Dim lngCnt As Long
        Dim lngDspOrder As Long                                             ' 表示順
        Dim lngGrpNo As Long
        Dim lngGrpSubNo As Long
        Dim lngLine As Long
        Dim lngItemCnt As Long
        Dim lngMaxItem As Long
        Dim udtTPD020 As typTPD020 = Nothing
        '更新 ネタケース時遷移対応
        Dim strswitch1 As String = Nothing
        Dim strswitch2 As String = Nothing
        Dim strswitch3 As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_19 = False
        strFKey = ""
        strSKey = ""
        lngGrpNo = 1
        lngGrpSubNo = 1
        lngDspOrder = 1
        lngLine = 1
        lngItemCnt = 0

        If pFlag = "0" Then
            'ネタケースではないと判定
            strswitch1 = GC_MSTYLE_NOLIST
            strswitch2 = GC_MSTYLE_NOLISTSTR
            strswitch3 = GC_MSTYLE_NOLISTPIC4
        Else
            'ネタケースと判定
            strswitch1 = GC_MSTYLE_NETASTR
            strswitch2 = GC_MSTYLE_NETAPIC
            strswitch3 = GC_MSTYLE_NETACASE
        End If

        '------------------------------
        ' 画像コード設定
        '------------------------------

        'strTJMaterialID(0) = "VGS055"                                        ' (短冊)通常表示画像コード
        'strTJMaterialID(1) = "VGS055"                                        ' (短冊)売り切れ画像コード
        'strGJMaterialID(0) = "VGS037"                                        ' (画像)通常表示画像コード
        'strGJMaterialID(1) = "VGS037"                                        ' (画像)売り切れ画像コード

        '2006.10.20 変更
        strTJMaterialID(0) = "SVGA68"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "SVGA68"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "SVGA58"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "SVGA58"                                        ' (画像)売り切れ画像コード


        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            'テスト変数 
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 第一キー項目値評価
                '------------------------------
                If strFKey <> Trim$(objRows("MENUID")) Then
                    lngDspOrder = 1
                    lngGrpNo = 1
                    lngGrpSubNo = 1
                    strFKey = Trim$(objRows("MENUID"))
                    strSKey = ""
                    lngItemCnt = 0

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            lngMaxItem = 9
                        Case strswitch2, GC_MSTYLE_PIC12
                            lngMaxItem = 6
                        Case strswitch3, GC_MSTYLE_PIC4
                            lngMaxItem = 6
                        Case Else
                            Exit Function
                    End Select

                End If

                If strSKey <> Trim$(objRows("SECONDKEY")) Then
                    If (Trim$(objRows("MENUSTYLE")) = strswitch1 Or Trim$(objRows("MENUSTYLE")) = GC_MSTYLE_PICTJ) Then
                        If lngItemCnt = lngMaxItem - 1 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If

                        L_FreeMode = False
                        If Not LF_MakeTJGrpGrph_2(objRows, lngDspOrder, lngGrpNo, lngGrpSubNo, 1) Then
                            L_FreeMode = True
                            Exit Function
                        End If

                        With udtTPD020
                            .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                            .MENUBTNID = "000"
                            .MENUGRPID = Format$(lngGrpNo, "000")
                            .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                            .MENUGRPID3 = Format$(1, "00")
                            .MENULV = "1"
                            .LINE = Space(5)
                            .REFID = Space(5)
                            .REFGRP = Trim$(objRows("GOODSGROUP"))
                            .DISPORDER = Format$(lngDspOrder, "000")
                            .UPDID = GC_UPDID
                            .UPDYMD = Now
                        End With
                        If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                            Exit Function
                        End If

                        lngDspOrder = lngDspOrder + 1
                        lngItemCnt = lngItemCnt + 1
                        If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                            lngGrpSubNo = lngGrpSubNo + 1
                            lngItemCnt = 0
                        End If
                    End If
                    strSKey = Trim$(objRows("SECONDKEY"))
                End If

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                        If Not LF_MakeTJGraphics_2_FREE(strTJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpNo, 1, pCreateMode) Then
                            Exit Function
                        End If

                    Case strswitch2, GC_MSTYLE_PIC12 '更新↓ 2006/02/02 9→12分割
                        If Not LF_MakeGJGraphics_2_FREE(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "6") Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case strswitch3, GC_MSTYLE_PIC4
                        If Not LF_MakeGJGraphics_2_FREE(strGJMaterialID, objRows, lngDspOrder, GC_EJKBN_J, lngGrpNo, lngGrpSubNo, 1, lngLine, pCreateMode, "4") Then ' 日本語画像生成
                            Exit Function
                        End If

                    Case Else
                        Exit Function

                End Select

                With udtTPD020
                    .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                    .MENUBTNID = "000"
                    .MENUGRPID = Format$(lngGrpNo, "000")
                    .MENUGRPID2 = Format$(lngGrpSubNo, "00")
                    .MENUGRPID3 = Format$(1, "00")
                    .MENULV = "1"
                    .LINE = Space(5)

                    Select Case Trim$(objRows("MENUSTYLE"))
                        Case strswitch1, GC_MSTYLE_PICTJ
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                        Case strswitch2, GC_MSTYLE_PIC12
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo6) '更新 2006/02/02
                        Case strswitch3, GC_MSTYLE_PIC4
                            .REFID = Trim$(objRows("GOODSCD")) & CStr(typImgPattern.Photo4) '更新 2006/03/08 Photo4に変更
                        Case Else
                            Exit Function
                    End Select

                    .REFGRP = Trim$(objRows("GOODSGROUP"))
                    .DISPORDER = Format$(lngDspOrder, "000")
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, 0, DispType.SVGA) Then
                    Exit Function
                End If

                lngDspOrder = lngDspOrder + 1
                lngCnt = lngCnt + 1
                lngItemCnt = lngItemCnt + 1

                Select Case Trim$(objRows("MENUSTYLE"))
                    Case strswitch1, GC_MSTYLE_PICTJ
                    Case strswitch2, GC_MSTYLE_PIC12
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case strswitch3, GC_MSTYLE_PIC4
                        If lngItemCnt Mod 2 = 0 And lngItemCnt <> 0 Then
                            lngLine = lngLine + 1
                        End If
                    Case Else
                        Exit Function
                End Select

                If lngItemCnt Mod lngMaxItem = 0 And lngItemCnt <> 0 Then
                    lngGrpSubNo = lngGrpSubNo + 1
                    lngItemCnt = 0
                End If

                ' Dim integ As Integer = pStatus.pgs_Status.Value
                ' Dim str As String = pStatus.pgs_Status.Value
                ' pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_19 = True

    End Function
    ' -----------------------------------------------------------


    ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
    Private Function LF_CreateMenu_20(ByVal pData As DataSet, _
                                     ByVal pStatus As CNL1810, _
                                     ByVal pCreateMode As typCreateMode, _
                                     Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap(3) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objFont(1) As Font
        Dim objRect As RectangleF
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim strTJMaterialID(1) As String
        Dim strGJMaterialID(1) As String
        Dim strImageCD(3) As String
        Dim lngGrpNo As Long
        Dim lngSubNo As Long                                                ' 9商品を超えた場合の枝番(現在処理中の枝番)
        Dim lngSubNo2 As Long
        Dim lngItemOrderCnt As Long
        Dim lngItemLineCnt As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMenu_20 = False

        '------------------------------
        ' 画像コード設定
        '------------------------------
        strImageCD(0) = "SVGA43"
        strImageCD(1) = "SVGA40"
        strImageCD(2) = "SVGA41"
        strImageCD(3) = "SVGA42"
        strTJMaterialID(0) = "SVGA68"                                        ' (短冊)通常表示画像コード
        strTJMaterialID(1) = "SVGA68"                                        ' (短冊)売り切れ画像コード
        strGJMaterialID(0) = "SVGA58"                                        ' (画像)通常表示画像コード
        strGJMaterialID(1) = "SVGA58"                                        ' (画像)売り切れ画像コード

        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If

        lngItemOrderCnt = 0                                                 ' 単品画像の表示順カウンタ
        lngItemLineCnt = 1                                                  ' 単品画像の表示行カウンタ

        Try
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 30) Then            ' [グループ]グループ名文字
                Exit Function
            End If

            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 25) Then            ' [グループ]品名文字
                Exit Function
            End If
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 画像生成処理
        '------------------------------
        Try
            lngCnt = 0
            While lngCnt < pData.Tables("com").Rows.Count
                If Not GF_GetRows(pData, lngCnt, objRows) Then              ' 行情報取得処理
                    Exit Function
                End If

                '------------------------------
                ' 単品画像生成
                '------------------------------
                Select Case Trim$(objRows("MENUSTYLE"))
                    Case GC_MSTYLE_LISTSTR, GC_MSTYLE_NOLIST, GC_MSTYLE_PICTJ            ' 短冊型画像生成
                        If Not LF_MakeTJGraphics_2_FREE(strTJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 pCreateMode) Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_LISTPIC, GC_MSTYLE_NOLISTSTR, GC_MSTYLE_PIC12         ' 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_2_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "6") Then
                            Exit Function
                        End If

                    Case GC_MSTYLE_LISTPIC4, GC_MSTYLE_NOLISTPIC4, GC_MSTYLE_PIC4        ' 画像型画像生成(6分割版)
                        If Not LF_MakeGJGraphics_2_FREE(strGJMaterialID, _
                                                 objRows, _
                                                 lngItemOrderCnt, _
                                                 GC_EJKBN_J, _
                                                 lngGrpNo, _
                                                 lngSubNo, _
                                                 lngSubNo2, _
                                                 lngItemLineCnt, _
                                                 pCreateMode, _
                                                 "4") Then
                            Exit Function
                        End If

                    Case Else
                        Exit Function
                End Select

                lngCnt = lngCnt + 1

            End While

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMenu_20 = True

    End Function
    ' -----------------------------------------------------------

    '--- (2006.04.06) 飲み放題メニューのため、引数追加 ---------------------------------------------------
    'Private Function LF_MakeNetaGraph(ByVal pRow As DataRow, _
    '                                  ByVal pDispOrder As Long, _
    '                                  ByVal pGrpNo As Long, _
    '                                  ByVal pGrpSubNo As Long, _
    '                                  ByVal pSellKind As Boolean, _
    '                                  ByVal pCreateMode As typCreateMode) As Boolean
    Private Function LF_MakeNetaGraph(ByVal pRow As DataRow, _
                                      ByVal pDispOrder As Long, _
                                      ByVal pGrpNo As Long, _
                                      ByVal pGrpSubNo As Long, _
                                      ByVal pSellKind As Boolean, _
                                      ByVal pCreateMode As typCreateMode, _
                                      Optional ByVal pFreeKind As Boolean = False) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont(2) As Font          '-- (2006.01.23) 単価と商品名のフォントをわける
        'Dim objFont(1) As Font
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutHString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long
        Dim strItemImage As String = Nothing
        Dim objItemImg As Bitmap
        Dim lngCnt As Long
        Dim strInfo(8) As String
        Dim strWork As String = Nothing
        Dim lngRow As Long
        Dim lngChar As Long
        Dim lngWork As Long
        Dim strInfoW As String = Nothing

        '--- (2006.04.06) 飲み放題メニュー追加
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeNetaGraph = False

        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRow("GOODSCD")) & "_" & CStr(typImgPattern.Photo4) & "*.jpg"           '2006.06.28 飲み放題対応
        strPattern = Trim$(pRow("GOODSCD")) & "_" & CStr(typImgPattern.Photo4) & "A" & "*.jpg"
        '-- 飲み放題対応に伴い、条件変更
        'If Trim$(pRow("GENERATEFLG")) = GC_FALSE And _
        '   System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 Then
        If Trim$(pRow("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 And _
           pFreeKind = False Then

            If pSellKind Then
                '------------------------------
                ' 旧生成画像コピー処理
                '------------------------------
                If Not LF_ExtFileCopy(Trim$(pRow("GOODSCD")), typImgPattern.Photo4, strTimeStamp) Then
                    Exit Function
                End If

                If pCreateMode <> typCreateMode.RealTimeTransfar And _
                   pCreateMode <> typCreateMode.SubDataTransfar Then
                    ' TPD020 追加処理
                    With udtTPD020
                        .MENUID = Space(3)
                        .MENUBTNID = Space(3)
                        .MENUGRPID = Space(3)
                        .MENUGRPID2 = Space(2)
                        .MENUGRPID3 = Space(2)
                        .MENULV = "1"
                        .LINE = Space(5)
                        .REFID = Trim$(pRow("GOODSCD")) & CStr(typImgPattern.Photo4)
                        .REFGRP = Space(4)
                        .DISPORDER = Space(3)
                        .UPDID = GC_UPDID
                        .UPDYMD = Now
                    End With
                    If Not LF_InsertImgDB(udtTPD020, strTimeStamp) Then
                        Exit Function
                    End If
                End If
            End If

        Else

            '------------------------------
            ' 描画フォントセットアップ
            '------------------------------
            '--- (2006.01.23) 文字数により表示文字サイズ変更 ------------------------------
            Dim intFont As Integer

            If Len(Trim$(pRow("GOODSNMJ2"))) > 0 Then
                intFont = 28
            Else
                Select Case Len(CStr(pRow("GOODSNMJ")))
                    Case 1 To 6
                        intFont = 48
                    Case 7 To 10
                        intFont = 36
                    Case Else
                        intFont = 28
                End Select
            End If
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, intFont) Then
                Exit Function
            End If

            'If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 28) Then
            '    Exit Function
            'End If
            '------------------------------------------------------------------------------
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 19) Then
                Exit Function
            End If
            '--- (2006.01.23) 単価用フォント ----------------------------------------------
            If Not LF_FontSetup(objFont(2), GC_EJKBN_J, 28) Then
                Exit Function
            End If
            '------------------------------------------------------------------------------

            '------------------------------
            ' 描画バッファ領域生成
            '------------------------------
            strImageCD(0) = IIf(pSellKind, "S037UC", "S038UC")
            If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                Exit Function
            End If

            '------------------------------
            ' 商品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRow("GOODSNMJ"))
                .objFont = objFont(0)
                .objColor = Color.White
                .lngCharLower = 10
                .lngPositionY = 5
            End With
            lngDummy = LF_PutHString(udtParam, objGraph, Nothing)

            If Len(Trim$(pRow("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = Trim$(pRow("GOODSNMJ2"))
                    .objFont = objFont(0)
                    .objColor = Color.White
                    .lngCharLower = 10
                    .lngPositionY = 29
                End With
                lngDummy = LF_PutHString(udtParam, objGraph, Nothing)
            End If

            '------------------------------
            ' 単価出力
            '------------------------------
            With udtParam
                If pFreeKind = False Then
                    If pSellKind Then
                        '.strPutStrings = GF_ChgNumeric(Trim$(pRow("PRICE"))) & "円" 
                        .strPutStrings = Format(CLng(Trim$(pRow("PRICE"))), "###0") & "円"
                        .objColor = Color.White
                        .lngCharWidth = 17
                    Else
                        ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 -----------------------------------------
                        .strPutStrings = "品切れ・入荷無し"     'MenuImage写真12解説
                        ''.strPutStrings = "品切れ"
                        .objColor = Color.Red
                        .lngCharWidth = 32
                        ''.lngCharWidth = 28
                        ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 -----------------------------------------
                    End If
                    '--- (2006.04.06) 飲み放題メニュー対応追加 ------------------------------------------------
                Else
                    .strPutStrings = "飲み放題"
                    .objColor = Color.Red
                    .lngCharWidth = 32
                End If
                '------------------------------------------------------------------------------------------
                .objFont = objFont(2)           '--- (2006.01.23) 単価用フォント
                '.objFont = objFont(0)
                .lngCharLower = 345
                .lngPositionY = 53
            End With
            lngDummy = LF_PutHString3(udtParam, objGraph)

            '------------------------------
            ' 商品説明文出力
            '------------------------------
            lngRow = 0
            strInfoW = Replace(Trim$(pRow("JEXPNOTEJ")), "<BR>", vbTab)
            For lngCnt = 1 To Len(strInfoW)
                strWork = Mid$(strInfoW, lngCnt, 1)
                lngWork = GF_LenB(strWork)
                If (lngChar + lngWork) > 20 Or strWork = vbTab Then
                    If strWork = vbTab Then
                        strWork = ""
                    End If
                    lngRow = lngRow + 1
                    lngChar = 0
                    If lngRow >= 9 Then
                        Exit For
                    End If
                End If
                strInfo(lngRow) = strInfo(lngRow) & strWork
                lngChar = GF_LenB(strInfo(lngRow))
            Next

            For lngCnt = 0 To UBound(strInfo)
                With udtParam
                    .strPutStrings = strInfo(lngCnt)
                    .objColor = Color.White
                    .objFont = objFont(1)
                    .lngCharLower = 182
                    .lngPositionY = 87 + (lngCnt * 18)
                End With
                lngDummy = LF_PutHString(udtParam, objGraph, Nothing)
            Next

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRow("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRow("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRow("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRow("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objGraph.DrawImage(objItemImg, 6, 86, 174, 130)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            '--- (2006.02.20) おすすめ、ＮＥＷアイコン対応 -------------------------------
            With udtParam
                'If pSellKind Then
                Try
                    If Trim$(pRow("SPFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objGraph.DrawImage(objItemImg, 6, 180, 135, 70)   '左下
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try

                Try
                    If Trim$(pRow("NEWFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objGraph.DrawImage(objItemImg, 150, 70, 60, 30)     '右上
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try

                'End If
            End With
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRow("GOODSCD")) & CStr(typImgPattern.Photo4)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                '--- (2006.04.07) 飲み放題メニュー対応
                '.SELLKBN = IIf(pSellKind, GC_OOS_ONSELE, GC_OOS_SOLDOUT)
                If pSellKind Then
                    .SELLKBN = GC_OOS_ONSELE
                Else
                    If pFreeKind = False Then
                        .SELLKBN = GC_OOS_SOLDOUT
                    Else
                        .SELLKBN = GC_OOS_NONE
                    End If
                End If
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.ItemImage, Nothing) Then
                Exit Function
            End If

            objBitmap(0).Dispose()
            objGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If pSellKind Then
                If Not LF_UpdTPM010(Trim$(pRow("GOODSCD"))) Then
                    Exit Function
                End If
            End If

        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeNetaGraph = True

    End Function

    Private Function LF_MakeNetaGraph_FREE(ByVal pRow As DataRow, _
                                      ByVal pDispOrder As Long, _
                                      ByVal pGrpNo As Long, _
                                      ByVal pGrpSubNo As Long, _
                                      ByVal pSellKind As Boolean, _
                                      ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont(2) As Font          '-- (2006.01.23) 単価と商品名のフォントをわける
        'Dim objFont(1) As Font
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutHString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long
        Dim strItemImage As String = Nothing
        Dim objItemImg As Bitmap
        Dim lngCnt As Long
        Dim strInfo(8) As String
        Dim strWork As String = Nothing
        Dim lngRow As Long
        Dim lngChar As Long
        Dim lngWork As Long
        Dim strInfoW As String = Nothing

        '--- (2006.04.06) 飲み放題メニュー追加
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeNetaGraph_FREE = False

        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRow("GOODSCD")) & "_" & CStr(typImgPattern.Photo4) & "C" & "*.jpg"
        '-- 飲み放題対応に伴い、条件変更        (2006.06.28)　飲み放題対応　削除
        'If Trim$(pRow("GENERATEFLG")) = GC_FALSE And _
        '   System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 And _
        '   pFreeKind = False Then
        If Trim$(pRow("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 Then

            If pSellKind Then
                '------------------------------
                ' 旧生成画像コピー処理
                '------------------------------
                If Not LF_ExtFileCopy_FREE(Trim$(pRow("GOODSCD")), typImgPattern.Photo4, strTimeStamp) Then
                    Exit Function
                End If

                If pCreateMode <> typCreateMode.RealTimeTransfar And _
                   pCreateMode <> typCreateMode.SubDataTransfar Then
                    ' TPD020 追加処理
                    With udtTPD020
                        .MENUID = Space(3)
                        .MENUBTNID = Space(3)
                        .MENUGRPID = Space(3)
                        .MENUGRPID2 = Space(2)
                        .MENUGRPID3 = Space(2)
                        .MENULV = "1"
                        '(2006.06.28) 飲み放題対応-------
                        '.LINE = Space(5)
                        .LINE = "F"
                        '--------------------------------
                        .REFID = Trim$(pRow("GOODSCD")) & CStr(typImgPattern.Photo4)
                        .REFGRP = Space(4)
                        .DISPORDER = Space(3)
                        .UPDID = GC_UPDID
                        .UPDYMD = Now
                    End With
                    If Not LF_InsertImgDB(udtTPD020, strTimeStamp) Then
                        Exit Function
                    End If
                End If
            End If

        Else

            '------------------------------
            ' 描画フォントセットアップ
            '------------------------------
            '--- (2006.01.23) 文字数により表示文字サイズ変更 ------------------------------
            Dim intFont As Integer

            If Len(Trim$(pRow("GOODSNMJ2"))) > 0 Then
                intFont = 28
            Else
                Select Case Len(CStr(pRow("GOODSNMJ")))
                    Case 1 To 6
                        intFont = 48
                    Case 7 To 10
                        intFont = 36
                    Case Else
                        intFont = 28
                End Select
            End If
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, intFont) Then
                Exit Function
            End If

            'If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 28) Then
            '    Exit Function
            'End If
            '------------------------------------------------------------------------------
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 19) Then
                Exit Function
            End If
            '--- (2006.01.23) 単価用フォント ----------------------------------------------
            If Not LF_FontSetup(objFont(2), GC_EJKBN_J, 28) Then
                Exit Function
            End If
            '------------------------------------------------------------------------------

            '------------------------------
            ' 描画バッファ領域生成
            '------------------------------
            strImageCD(0) = IIf(pSellKind, "S037UC", "S038UC")
            If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                Exit Function
            End If

            '------------------------------
            ' 商品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRow("GOODSNMJ"))
                .objFont = objFont(0)
                .objColor = Color.White
                .lngCharLower = 10
                .lngPositionY = 5
            End With
            lngDummy = LF_PutHString(udtParam, objGraph, Nothing)

            If Len(Trim$(pRow("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = Trim$(pRow("GOODSNMJ2"))
                    .objFont = objFont(0)
                    .objColor = Color.White
                    .lngCharLower = 10
                    .lngPositionY = 29
                End With
                lngDummy = LF_PutHString(udtParam, objGraph, Nothing)
            End If

            '------------------------------
            ' 単価出力
            '------------------------------
            With udtParam
                If pSellKind Then
                    .strPutStrings = "飲み放題"
                    .objColor = Color.Red
                    .lngCharWidth = 32
                Else
                    .strPutStrings = "入荷待ち"
                    .objColor = Color.Red
                    .lngCharWidth = 32
                End If
                .objFont = objFont(2)
                .lngCharLower = 345
                .lngPositionY = 53
            End With
            lngDummy = LF_PutHString3(udtParam, objGraph)

            '------------------------------
            ' 商品説明文出力
            '------------------------------
            lngRow = 0
            strInfoW = Replace(Trim$(pRow("JEXPNOTEJ")), "<BR>", vbTab)
            For lngCnt = 1 To Len(strInfoW)
                strWork = Mid$(strInfoW, lngCnt, 1)
                lngWork = GF_LenB(strWork)
                If (lngChar + lngWork) > 20 Or strWork = vbTab Then
                    If strWork = vbTab Then
                        strWork = ""
                    End If
                    lngRow = lngRow + 1
                    lngChar = 0
                    If lngRow >= 9 Then
                        Exit For
                    End If
                End If
                strInfo(lngRow) = strInfo(lngRow) & strWork
                lngChar = GF_LenB(strInfo(lngRow))
            Next

            For lngCnt = 0 To UBound(strInfo)
                With udtParam
                    .strPutStrings = strInfo(lngCnt)
                    .objColor = Color.White
                    .objFont = objFont(1)
                    .lngCharLower = 182
                    .lngPositionY = 87 + (lngCnt * 18)
                End With
                lngDummy = LF_PutHString(udtParam, objGraph, Nothing)
            Next

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRow("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRow("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRow("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRow("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objGraph.DrawImage(objItemImg, 6, 86, 174, 130)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            '--- (2006.02.20) おすすめ、ＮＥＷアイコン対応 -------------------------------
            With udtParam
                'If pSellKind Then
                Try
                    If Trim$(pRow("SPFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objGraph.DrawImage(objItemImg, 6, 180, 135, 70)   '左下
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try

                Try
                    If Trim$(pRow("NEWFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objGraph.DrawImage(objItemImg, 150, 70, 60, 30)     '右上
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try

                'End If
            End With
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                '(2006.06.28) 飲み放題対応-------
                '.LINE = Space(5)
                .LINE = "F"
                '--------------------------------
                .REFID = Trim$(pRow("GOODSCD")) & CStr(typImgPattern.Photo4)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                '--- (2006.04.07) 飲み放題メニュー対応
                '.SELLKBN = IIf(pSellKind, GC_OOS_ONSELE, GC_OOS_SOLDOUT)
                If pSellKind Then
                    .SELLKBN = GC_OOS_NONE
                Else
                    .SELLKBN = GC_OOS_SOLDOUT_FREE
                End If
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.ItemImage, Nothing) Then
                Exit Function
            End If

            objBitmap(0).Dispose()
            objGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If pSellKind Then
                If Not LF_UpdTPM010(Trim$(pRow("GOODSCD"))) Then
                    Exit Function
                End If
            End If

        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeNetaGraph_FREE = True

    End Function
    '800x600用　4分割画像作成
    Private Function LF_MakeNetaGraph_2(ByVal pRow As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pSellKind As Boolean, _
                                       ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont(2) As Font              '-- (2006.01.23) 単価と品名のフォントを別ける
        'Dim objFont(1) As Font
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutHString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long
        Dim strItemImage As String = Nothing
        Dim objItemImg As Bitmap
        Dim lngCnt As Long
        Dim strInfo(8) As String
        Dim strWork As String = Nothing
        Dim lngRow As Long
        Dim lngChar As Long
        Dim lngWork As Long
        Dim strInfoW As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeNetaGraph_2 = False

        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRow("GOODSCD")) & "_" & CStr(typImgPattern.Photo4) & "*.jpg"
        '--- (2006.04.10) 条件変更
        'If Trim$(pRow("GENERATEFLG")) = GC_FALSE And _
        'System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath2, strPattern).GetLength(0) <> 0 Then
        If System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath2, strPattern).GetLength(0) <> 0 Then

            If pSellKind Then
                '------------------------------
                ' 旧生成画像コピー処理
                '------------------------------
                If Not LF_ExtFileCopy(Trim$(pRow("GOODSCD")), typImgPattern.Photo4, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If

                If pCreateMode <> typCreateMode.RealTimeTransfar And _
                   pCreateMode <> typCreateMode.SubDataTransfar Then
                    ' TPD020 追加処理
                    With udtTPD020
                        .MENUID = Space(3)
                        .MENUBTNID = Space(3)
                        .MENUGRPID = Space(3)
                        .MENUGRPID2 = Space(2)
                        .MENUGRPID3 = Space(2)
                        .MENULV = "1"
                        .LINE = Space(5)
                        .REFID = Trim$(pRow("GOODSCD")) & CStr(typImgPattern.Photo4)
                        .REFGRP = Space(4)
                        .DISPORDER = Space(3)
                        .UPDID = GC_UPDID
                        .UPDYMD = Now
                    End With
                    If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.SVGA) Then
                        Exit Function
                    End If
                End If
            End If

        Else

            '------------------------------
            ' 描画フォントセットアップ
            '------------------------------
            '--- (2006.01.23) 文字数により表示文字サイズ変更 ------------------------------
            Dim intFont As Integer

            If Len(Trim$(pRow("GOODSNMJ2"))) > 0 Then
                intFont = 23
            Else
                Select Case Len(CStr(pRow("GOODSNMJ")))
                    Case 1 To 6
                        intFont = 42
                    Case 7 To 8
                        intFont = 34
                    Case 9 To 10
                        intFont = 28
                    Case Else
                        intFont = 23
                End Select
            End If
            If Not LF_FontSetup(objFont(0), GC_EJKBN_J, intFont) Then
                Exit Function
            End If

            'If Not LF_FontSetup(objFont(0), GC_EJKBN_J, 23) Then
            '    Exit Function
            'End If
            '------------------------------------------------------------------------------
            If Not LF_FontSetup(objFont(1), GC_EJKBN_J, 15) Then
                Exit Function
            End If

            '--- (2006.01.23) 単価用フォント ----------------------------------------------
            If Not LF_FontSetup(objFont(2), GC_EJKBN_J, 23) Then
                Exit Function
            End If
            '------------------------------------------------------------------------------

            '------------------------------
            ' 描画バッファ領域生成
            '------------------------------
            strImageCD(0) = IIf(pSellKind, "SVGA09", "SVGA50")
            If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
                Exit Function
            End If

            '------------------------------
            ' 商品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRow("GOODSNMJ"))
                .objFont = objFont(0)
                .objColor = Color.White
                .lngCharLower = 10
                .lngPositionY = 5
            End With
            lngDummy = LF_PutHString(udtParam, objGraph, Nothing)

            If Len(Trim$(pRow("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = Trim$(pRow("GOODSNMJ2"))
                    .objFont = objFont(0)
                    .objColor = Color.White
                    .lngCharLower = 10
                    .lngPositionY = 29
                End With
                lngDummy = LF_PutHString(udtParam, objGraph, Nothing)
            End If

            '------------------------------
            ' 単価出力
            '------------------------------
            With udtParam
                If pSellKind Then
                    '--- (2006.02.14) 定額メニュー ---------------------------------------------
                    'If Trim$(pRow("PRICETYPE")) = "0" Then
                    '.strPutStrings = GF_ChgNumeric(Trim$(pRow("PRICE"))) & "円" 
                    .strPutStrings = Format(CLng(Trim$(pRow("PRICE"))), "###0") & "円"
                    .objColor = Color.White
                    .lngCharWidth = 15
                    'Else
                    '    .strPutStrings = ""
                    'End If
                    '---------------------------------------------------------------------------
                Else
                    ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 -----------------------------------
                    .strPutStrings = "入荷待ち"
                    ''.strPutStrings = "品切れ"
                    .objColor = Color.Red
                    .lngCharWidth = 30
                    ''.lngCharWidth = 25
                    ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 -----------------------------------
                End If
                .objFont = objFont(2)
                '.objFont = objFont(0)      '-- (2006.01.23) 単価用フォント
                .lngCharLower = 255 '300
                .lngPositionY = 54

            End With
            lngDummy = LF_PutHString3(udtParam, objGraph)

            '------------------------------
            ' 商品説明文出力
            '------------------------------
            lngRow = 0
            strInfoW = Replace(Trim$(pRow("JEXPNOTEJ")), "<BR>", vbTab)
            For lngCnt = 1 To Len(strInfoW)
                strWork = Mid$(strInfoW, lngCnt, 1)
                lngWork = GF_LenB(strWork)
                If (lngChar + lngWork) > 20 Or strWork = vbTab Then
                    If strWork = vbTab Then
                        strWork = ""
                    End If
                    lngRow = lngRow + 1
                    lngChar = 0
                    If lngRow >= 9 Then
                        Exit For
                    End If
                End If
                strInfo(lngRow) = strInfo(lngRow) & strWork
                lngChar = GF_LenB(strInfo(lngRow))
            Next

            For lngCnt = 0 To UBound(strInfo)
                With udtParam
                    .strPutStrings = strInfo(lngCnt)
                    .objColor = Color.White
                    .objFont = objFont(1)
                    .lngCharLower = 140
                    .lngPositionY = 82 + (lngCnt * 18)
                End With
                lngDummy = LF_PutHString(udtParam, objGraph, Nothing)
            Next

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRow("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRow("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA18")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRow("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRow("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objGraph.DrawImage(objItemImg, 7, 85, 126, 94)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            '--- (2006.02.22) おすすめ、新作アイコン対応 -------------------------------
            With udtParam
                'If pSellKind Then
                Try
                    If Trim$(pRow("SPFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA59")
                        objItemImg = New Bitmap(strItemImage)
                        Call objGraph.DrawImage(objItemImg, 6, 170, 90, 50)   '左下
                        objItemImg.Dispose()
                    End If

                    If Trim$(pRow("NEWFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA60")
                        objItemImg = New Bitmap(strItemImage)
                        Call objGraph.DrawImage(objItemImg, 90, 70, 50, 25)     '右上
                        objItemImg.Dispose()
                    End If

                Catch
                    Exit Function
                End Try
                'End If
            End With
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRow("GOODSCD")) & CStr(typImgPattern.Photo4)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = IIf(pSellKind, GC_OOS_ONSELE, GC_OOS_SOLDOUT)
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            objBitmap(0).Dispose()
            objGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If pSellKind Then
                If Not LF_UpdTPM010(Trim$(pRow("GOODSCD"))) Then
                    Exit Function
                End If
            End If

        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeNetaGraph_2 = True

    End Function

    Private Function LF_MakeTJGrpGrph(ByVal pRows As DataRow, _
                                      ByVal pDispOrder As Long, _
                                      ByVal pGrpNo As Long, _
                                      ByVal pGrpSubNo As Long, _
                                      ByVal pGrpSubNo2 As Long) As Boolean
        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutVString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGrpGrph = False

        '------------------------------
        ' 描画フォントセットアップ
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 28) Then
            Exit Function
        End If

        '------------------------------
        ' 描画バッファ領域生成
        '------------------------------
        strImageCD(0) = "S021JC"
        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If

        '------------------------------
        ' 商品グループ名出力
        '------------------------------
        With udtParam
            .strPutStrings = Trim$(pRows("GROUPNM"))
            .lngPositionX = objBitmap(0).Width
            .lngCharLower = 10
            .objColor = System.Drawing.Color.Black
            .objFont = objFont
            .lngCharHeight = LC_TITLE_HEIGHT - 3
            .lngCharWidth = 43
        End With
        lngDummy = LF_PutVString(udtParam, objGraph, Nothing)

        '------------------------------
        ' 生成画像情報テーブル更新処理
        '------------------------------
        With udtTPD020
            .MENUID = Space(3)
            .MENUBTNID = Space(3)
            .MENUGRPID = Space(3)
            .MENUGRPID2 = Space(2)
            .MENUGRPID3 = Space(2)
            .MENULV = "1"
            .LINE = Space(5)
            .REFID = Space(5)
            .REFGRP = Trim$(pRows("GOODSGROUP"))
            .DISPORDER = Space(3)
            .UPDID = GC_UPDID
            .UPDYMD = Now
            .SELLKBN = GC_OOS_ONSELE
        End With
        If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GenrImage, Nothing) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeTJGrpGrph = True

    End Function

    '800x600版
    Private Function LF_MakeTJGrpGrph_2(ByVal pRows As DataRow, _
                                      ByVal pDispOrder As Long, _
                                      ByVal pGrpNo As Long, _
                                      ByVal pGrpSubNo As Long, _
                                      ByVal pGrpSubNo2 As Long) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutVString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGrpGrph_2 = False

        '------------------------------
        ' 描画フォントセットアップ
        '------------------------------           
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 35) Then
            Exit Function
        End If
        '------------------------------
        ' 描画バッファ領域生成
        ' （短冊メニュージャンル）
        '------------------------------
        strImageCD(0) = "SVGA67"
        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If

        '------------------------------
        ' 商品グループ名出力 '短冊
        '------------------------------
        With udtParam
            .strPutStrings = Trim$(pRows("GROUPNM"))
            .lngPositionX = objBitmap(0).Width - 15 ' -15
            .lngCharLower = 10 '5
            .objColor = System.Drawing.Color.Black
            .objFont = objFont
            .lngCharHeight = LC_TITLE3_HEIGHT + 7 '-1
            .lngCharWidth = 34
        End With
        lngDummy = LF_PutVString(udtParam, objGraph, Nothing)

        '------------------------------
        ' 生成画像情報テーブル更新処理
        '------------------------------
        With udtTPD020
            .MENUID = Space(3)
            .MENUBTNID = Space(3)
            .MENUGRPID = Space(3)
            .MENUGRPID2 = Space(2)
            .MENUGRPID3 = Space(2)
            .MENULV = "1"
            .LINE = Space(5)
            .REFID = Space(5)
            .REFGRP = Trim$(pRows("GOODSGROUP"))
            .DISPORDER = Space(3)
            .UPDID = GC_UPDID
            .UPDYMD = Now
            .SELLKBN = GC_OOS_ONSELE
        End With
        If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GenrImage, Nothing, Nothing, DispType.SVGA) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeTJGrpGrph_2 = True

    End Function

    '更新 2006/02/17 短冊ジャンルタイトル作成
    Private Function LF_MakeTJGrpGrph_3(ByVal pRows As DataRow, _
                                      ByVal pDispOrder As Long, _
                                      ByVal pGrpNo As Long, _
                                      ByVal pGrpSubNo As Long, _
                                      ByVal pGrpSubNo2 As Long) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutVString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGrpGrph_3 = False

        '------------------------------
        ' 描画フォントセットアップ
        '------------------------------           
        strcount = Len(Trim$(pRows("GROUPNM")))

        Select Case strcount

            Case 0 To 8
                '↓更新 2006/02/20 22 
                If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
                    Exit Function
                End If

            Case 9 To 13

                If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
                    Exit Function
                End If

            Case 14 To 18

                If Not LF_FontSetup(objFont, GC_EJKBN_J, 13) Then
                    Exit Function
                End If

            Case Else
                Exit Function

        End Select


        '------------------------------
        ' 描画バッファ領域生成
        ' （短冊メニュージャンル）
        '------------------------------
        strImageCD(0) = "VGS054"
        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If

        '------------------------------
        ' 商品グループ名出力 '短冊
        '------------------------------
        With udtParam
            .strPutStrings = Trim$(pRows("GROUPNM"))
            .lngPositionX = objBitmap(0).Width - 15 ' +1
            .lngCharLower = 10 '5
            .objColor = System.Drawing.Color.Black
            .objFont = objFont
            .lngCharHeight = LC_TITLE3_HEIGHT - 1 '2
            .lngCharWidth = 34
        End With
        lngDummy = LF_PutVString(udtParam, objGraph, Nothing)

        '------------------------------
        ' 生成画像情報テーブル更新処理
        '------------------------------
        With udtTPD020
            .MENUID = Space(3)
            .MENUBTNID = Space(3)
            .MENUGRPID = Space(3)
            .MENUGRPID2 = Space(2)
            .MENUGRPID3 = Space(2)
            .MENULV = "1"
            .LINE = Space(5)
            .REFID = Space(5)
            .REFGRP = Trim$(pRows("GOODSGROUP"))
            .DISPORDER = Space(3)
            .UPDID = GC_UPDID
            .UPDYMD = Now
            .SELLKBN = GC_OOS_ONSELE
        End With
        If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GenrImage, Nothing, Nothing, DispType.VGA) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeTJGrpGrph_3 = True

    End Function
    '----------------------------------------------------
    '更新 2006/06/07 短冊ジャンルタイトル作成(7インチ版)
    '----------------------------------------------------

    Private Function LF_MakeTJGrpGrph_4(ByVal pRows As DataRow, _
                                      ByVal pDispOrder As Long, _
                                      ByVal pGrpNo As Long, _
                                      ByVal pGrpSubNo As Long, _
                                      ByVal pGrpSubNo2 As Long) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim strImageCD(0) As String
        Dim objBitmap(0) As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim objPicture As PictureBox = Nothing
        Dim objRect As RectangleF
        Dim udtParam As typPutVString
        Dim udtTPD020 As typTPD020 = Nothing
        Dim lngDummy As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGrpGrph_4 = False

        '------------------------------
        ' 描画フォントセットアップ
        '------------------------------           
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 35) Then '2006 張本 変更 27→35
            Exit Function
        End If
        '------------------------------
        ' 描画バッファ領域生成
        ' （短冊メニュージャンル）
        '------------------------------
        strImageCD(0) = "VGS054"
        If Not LF_InitialPicture(objBitmap, objGraph, objRect, objPicture, strImageCD) Then
            Exit Function
        End If

        '------------------------------
        ' 商品グループ名出力 '短冊
        '------------------------------
        With udtParam
            .strPutStrings = Trim$(pRows("GROUPNM"))
            .lngPositionX = objBitmap(0).Width - 15 ' -15
            .lngCharLower = 10 '5
            .objColor = System.Drawing.Color.Black
            .objFont = objFont
            .lngCharHeight = LC_TITLE3_HEIGHT + 7 '-1
            .lngCharWidth = 34
        End With
        lngDummy = LF_PutVString(udtParam, objGraph, Nothing)

        '------------------------------
        ' 生成画像情報テーブル更新処理
        '------------------------------
        With udtTPD020
            .MENUID = Space(3)
            .MENUBTNID = Space(3)
            .MENUGRPID = Space(3)
            .MENUGRPID2 = Space(2)
            .MENUGRPID3 = Space(2)
            .MENULV = "1"
            .LINE = Space(5)
            .REFID = Space(5)
            .REFGRP = Trim$(pRows("GOODSGROUP"))
            .DISPORDER = Space(3)
            .UPDID = GC_UPDID
            .UPDYMD = Now
            .SELLKBN = GC_OOS_ONSELE
        End With
        If Not LF_SaveGroup(udtTPD020, 0, objBitmap(0), objGraph, GC_EJKBN_J, typImageKind.GenrImage, Nothing, Nothing, DispType.VGA) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_MakeTJGrpGrph_4 = True

    End Function

    Private Enum typImgPattern
        Tanzaku = 0
        Photo12 = 1
        Photo4 = 2
        Photo9 = 3
        '-------------------------------
        ' 更新 2006/03/10 8インチ用追加
        '-------------------------------
        Photo6 = 4
    End Enum

    Private Function LF_ExtFileCopy(ByVal pGoodsCD As String, _
                                    ByVal pImgPattern As typImgPattern, _
                                    ByRef pTimeStamp As String, _
                                    Optional ByVal pDisptype As DispType = DispType.XGA) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strCopyFNM As String = Nothing
        Dim strFileWK As String = Nothing
        Dim strPattern As String = Nothing
        Dim strWork() As String = Nothing
        Dim strWork2() As String = Nothing
        Dim strFileWK2 As String = Nothing
        Dim OMIMG_PATH As String = Nothing
        Dim NMIMG_PATH As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ExtFileCopy = False

        '------------------------------
        ' 画面サイズによりPATH切り替え
        '------------------------------
        Select Case pDisptype
            Case DispType.XGA '1024x768
                OMIMG_PATH = g_udtAppConfig.strOMImgPath
                NMIMG_PATH = g_udtAppConfig.strNMImgPath

            Case DispType.SVGA '800x600
                OMIMG_PATH = g_udtAppConfig.strOMImgPath2
                NMIMG_PATH = g_udtAppConfig.strNMImgPath2

            Case DispType.VGA
                OMIMG_PATH = g_udtAppConfig.strOMImgPath3
                NMIMG_PATH = g_udtAppConfig.strNMImgPath3

        End Select

        Try
            '------------------------------
            ' 最新画像特定処理
            '------------------------------
            strPattern = pGoodsCD & "_" & CStr(pImgPattern) & "A*.jpg"
            strCopyFNM = "****_**00000000000000.***"                        ' ダミー文字列
            For Each strFileWK In System.IO.Directory.GetFiles(OMIMG_PATH, strPattern)
                strWork = Split(strFileWK, "\")
                If InStr(strCopyFNM, "\") <> 0 Then
                    strWork2 = Split(strCopyFNM, "\")
                    strFileWK2 = strWork2(UBound(strWork2))
                Else
                    strFileWK2 = strCopyFNM
                End If
                If CLng(Mid$(strFileWK2, 8, 14)) < CLng(Mid$(strWork(UBound(strWork)), 8, 14)) Then
                    strCopyFNM = strFileWK
                End If
            Next

            ' 通常(販売中)画像コピー
            strWork = Split(strCopyFNM, "\")
            If Not System.IO.File.Exists(NMIMG_PATH & "\" & strWork(UBound(strWork))) Then
                System.IO.File.Copy(strCopyFNM, NMIMG_PATH & "\" & strWork(UBound(strWork)), True)
            End If

            ' 売り切れ画像コピー
            strWork(UBound(strWork)) = Replace(strWork(UBound(strWork)), "A", "B")
            If Not System.IO.File.Exists(NMIMG_PATH & "\" & strWork(UBound(strWork))) Then
                System.IO.File.Copy(OMIMG_PATH & "\" & strWork(UBound(strWork)), _
                                    NMIMG_PATH & "\" & strWork(UBound(strWork)), True)
            End If

            ' コピー画像のタイムスタンプ返却
            pTimeStamp = Mid$(strWork(UBound(strWork)), 8, 14)

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ExtFileCopy = True

    End Function
    '2006.06.28 飲み放題対応 追加---------------------------------------------------------------↓
    Private Function LF_ExtFileCopy_FREE(ByVal pGoodsCD As String, _
                                    ByVal pImgPattern As typImgPattern, _
                                    ByRef pTimeStamp As String, _
                                    Optional ByVal pDisptype As DispType = DispType.XGA) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strCopyFNM As String = Nothing
        Dim strFileWK As String = Nothing
        Dim strPattern As String = Nothing
        Dim strWork() As String = Nothing
        Dim strWork2() As String = Nothing
        Dim strFileWK2 As String = Nothing
        Dim OMIMG_PATH As String = Nothing
        Dim NMIMG_PATH As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ExtFileCopy_FREE = False

        '------------------------------
        ' 画面サイズによりPATH切り替え
        '------------------------------
        Select Case pDisptype
            Case DispType.XGA '1024x768
                OMIMG_PATH = g_udtAppConfig.strOMImgPath
                NMIMG_PATH = g_udtAppConfig.strNMImgPath

            Case DispType.SVGA '800x600
                OMIMG_PATH = g_udtAppConfig.strOMImgPath2
                NMIMG_PATH = g_udtAppConfig.strNMImgPath2

            Case DispType.VGA
                OMIMG_PATH = g_udtAppConfig.strOMImgPath3
                NMIMG_PATH = g_udtAppConfig.strNMImgPath3

        End Select

        Try
            '------------------------------
            ' 最新画像特定処理
            '------------------------------
            strPattern = pGoodsCD & "_" & CStr(pImgPattern) & "C*.jpg"
            strCopyFNM = "****_**00000000000000.***"                        ' ダミー文字列
            For Each strFileWK In System.IO.Directory.GetFiles(OMIMG_PATH, strPattern)
                strWork = Split(strFileWK, "\")
                If InStr(strCopyFNM, "\") <> 0 Then
                    strWork2 = Split(strCopyFNM, "\")
                    strFileWK2 = strWork2(UBound(strWork2))
                Else
                    strFileWK2 = strCopyFNM
                End If
                If CLng(Mid$(strFileWK2, 8, 14)) < CLng(Mid$(strWork(UBound(strWork)), 8, 14)) Then
                    strCopyFNM = strFileWK
                End If
            Next

            ' 通常(販売中)画像コピー
            strWork = Split(strCopyFNM, "\")
            If Not System.IO.File.Exists(NMIMG_PATH & "\" & strWork(UBound(strWork))) Then
                System.IO.File.Copy(strCopyFNM, NMIMG_PATH & "\" & strWork(UBound(strWork)), True)
            End If

            ' 売り切れ画像コピー
            strWork(UBound(strWork)) = Replace(strWork(UBound(strWork)), "C", "D")
            If Not System.IO.File.Exists(NMIMG_PATH & "\" & strWork(UBound(strWork))) Then
                System.IO.File.Copy(OMIMG_PATH & "\" & strWork(UBound(strWork)), _
                                    NMIMG_PATH & "\" & strWork(UBound(strWork)), True)
            End If

            ' コピー画像のタイムスタンプ返却
            pTimeStamp = Mid$(strWork(UBound(strWork)), 8, 14)

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ExtFileCopy_FREE = True

    End Function
    '2006.06.28 飲み放題対応 追加---------------------------------------------------------------↑
    Private Function LF_UpdTPM010(ByVal pGoodsCD As String) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_UpdTPM010 = False

        '------------------------------
        ' フラグ更新
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "UPDATE TPM010"
        strSQL = strSQL & "   SET TPM010.GENERATEFLG = '9',"
        strSQL = strSQL & "       TPM010.UPDID       = '" & GC_UPDID & "',"
        strSQL = strSQL & "       TPM010.UPDYMD      = '" & Now & "'"
        strSQL = strSQL & " WHERE TPM010.GOODSCD     = '" & pGoodsCD & "'"
        If Not GF_UpdData(strSQL) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_UpdTPM010 = True

    End Function

    '--- (2006.04.07) 飲み放題メニュー対応に伴い、引数追加 ----------------------------------
    'Private Function LF_MakeTJGraphics(ByVal pMaterialID() As String, _
    '                                   ByVal pRows As DataRow, _
    '                                   ByVal pDispOrder As Long, _
    '                                   ByVal pEJCD As String, _
    '                                   ByVal pGrpNo As Long, _
    '                                   ByVal pGrpSubNo As Long, _
    '                                   ByVal pGrpSubNo2 As Long, _
    '                                   ByVal pCreateMode As typCreateMode) As Boolean
    Private Function LF_MakeTJGraphics(ByVal pMaterialID() As String, _
                                       ByVal pRows As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pEJCD As String, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pGrpSubNo2 As Long, _
                                       ByVal pCreateMode As typCreateMode, _
                                       Optional ByVal pFreeMode As Boolean = False) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing
        Dim strTBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                           ' Dummy

        '--- (2006.04.06) 飲み放題メニュー
        Dim strTCImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics = False

        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "*.jpg"      '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "A" & "*.jpg"      '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD020 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp) Then
                    Exit Function
                End If
            End If
        Else
            '-- (2006.04.11) 飲み放題メニュー対応　判定式追加
            If pFreeMode = False Then
                '------------------------------
                ' 描画フォント設定
                '------------------------------
                '--- (2006.01.23) 短冊画像サイズ変更 ------------
                If Not LF_FontSetup(objFont(0), pEJCD, 32) Then                     ' 品名表示フォント(通常表示)
                    Exit Function
                End If
                ''If Not LF_FontSetup(objFont(0), pEJCD, 28) Then                     ' 品名表示フォント(通常表示)
                ''    Exit Function
                ''End If
                '------------------------------------------------
                If Not LF_FontSetup(objFont(1), pEJCD, 20) Then                     ' 価格表示フォント
                    Exit Function
                End If
                '--- (2006.01.23) 短冊画像サイズ変更 ------------
                If Not LF_FontSetup(objFont(2), pEJCD, 22) Then                     ' 品名表示フォント(日本語縮小表示)
                    Exit Function
                End If
                'If Not LF_FontSetup(objFont(2), pEJCD, 23) Then                     ' 品名表示フォント(日本語縮小表示)
                '    Exit Function
                'End If
                '------------------------------------------------
                If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                    Exit Function
                End If


                '------------------------------------------------------------------------------------------
                ' 通常表示画像生成
                '------------------------------------------------------------------------------------------
                '------------------------------
                ' バッファ領域初期化
                '------------------------------

                strAImageCD(0) = pMaterialID(0)
                If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                    Exit Function
                End If

                '------------------------------
                '　品名出力
                '------------------------------
                If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ"))
                        .lngPositionX = objABitmap(0).Width
                        .lngCharLower = 10
                        .objColor = System.Drawing.Color.Black
                        .objFont = objFont(0)
                        .lngCharHeight = LC_TITLE_HEIGHT + 5
                        '.lngCharHeight = LC_TITLE_HEIGHT           '--- (2006.01.23) 短冊画像サイズ変更
                        .lngCharWidth = 43
                    End With
                    lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                Else
                    '--- (2006.01.23) 短冊画像サイズ変更 -----------------------------------------------------------------------
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ")) & CStr(pRows("GOODSNMJ2"))
                        .lngPositionX = objABitmap(0).Width
                        .lngCharLower = 10
                        .objColor = System.Drawing.Color.Black
                        .objFont = objFont(2)
                        .lngCharHeight = LC_TITLE_HEIGHT - 6
                        .lngCharWidth = 38
                    End With
                    lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                    ''With udtParam
                    ''    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    ''    .lngPositionX = objABitmap(0).Width
                    ''    .lngCharLower = 10
                    ''    .objColor = System.Drawing.Color.Black
                    ''    .objFont = objFont(2)
                    ''    .lngCharHeight = LC_TITLE_HEIGHT - 5
                    ''    .lngCharWidth = 28
                    ''End With
                    ''lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                    ''With udtParam
                    ''    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    ''    .lngPositionX = objABitmap(0).Width / 2
                    ''    .lngCharLower = 10
                    ''    .objColor = System.Drawing.Color.Black
                    ''    .objFont = objFont(2)
                    ''    .lngCharHeight = LC_TITLE_HEIGHT - 5
                    ''    .lngCharWidth = 26
                    ''End With
                    ''lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                    '------------------------------------------------------------------------------------------------------------
                End If

                '------------------------------
                ' 価格出力
                '------------------------------
                With udtParam
                    If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                       Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then          ' 取得元項目名判定
                        .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("SECONDKEY"))) & "円")
                    Else
                        .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("PRICE"))) & "円")
                    End If

                    .lngPositionX = objABitmap(0).Width
                    .lngCharLower = 445
                    '.lngCharLower = 325        '---(2006.01.23) 短冊画像サイズ変更
                    .objFont = objFont(1)
                    .lngCharHeight = -18
                    .lngCharWidth = 38
                    .objColor = System.Drawing.Color.Black
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)   ' 縦書き文字列分解出力

                '------------------------------
                ' 生成画像情報テーブル更新処理
                '------------------------------
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & "0"
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                    .SELLKBN = GC_OOS_ONSELE
                End With
                If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                    Exit Function
                End If

                '------------------------------------------------------------------------------------------
                ' 売り切れ画像生成
                '------------------------------------------------------------------------------------------
                '------------------------------
                ' バッファ領域初期化
                '------------------------------
                strTBImageCD(0) = pMaterialID(1)
                If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strTBImageCD) Then
                    Exit Function
                End If

                '------------------------------
                '　品名出力
                '------------------------------
                If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ"))
                        .lngPositionX = objABitmap(0).Width
                        .lngCharLower = 10
                        .objColor = System.Drawing.Color.Black
                        .objFont = objFont(0)
                        .lngCharHeight = LC_TITLE_HEIGHT + 5
                        '.lngCharHeight = LC_TITLE_HEIGHT                       '--- (2006.01.23) 短冊画像サイズ変更
                        .lngCharWidth = 43
                    End With
                    lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                Else
                    '--- (2006.01.23) 短冊画像サイズ変更 -----------------------------------------------------------------------
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ")) & CStr(pRows("GOODSNMJ2"))
                        .lngPositionX = objABitmap(0).Width
                        .lngCharLower = 10
                        .objColor = System.Drawing.Color.Black
                        .objFont = objFont(2)
                        .lngCharHeight = LC_TITLE_HEIGHT - 6
                        .lngCharWidth = 38
                    End With
                    lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                    'With udtParam
                    '    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    '    .lngPositionX = objABitmap(0).Width
                    '    .lngCharLower = 10
                    '    .objColor = System.Drawing.Color.Black
                    '    .objFont = objFont(2)
                    '    .lngCharHeight = LC_TITLE_HEIGHT - 5
                    '    .lngCharWidth = 28
                    'End With
                    'lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                    'With udtParam
                    '    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    '    .lngPositionX = objABitmap(0).Width / 2
                    '    .lngCharLower = 10
                    '    .objColor = System.Drawing.Color.Black
                    '    .objFont = objFont(2)
                    '    .lngCharHeight = LC_TITLE_HEIGHT - 5
                    '    .lngCharWidth = 26
                    'End With
                    'lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                    '-----------------------------------------------------------------------------------------------------------
                End If

                '------------------------------
                ' 価格出力
                '------------------------------
                With udtParam
                    ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 --------------------------
                    .strPutStrings = GF_RevStr("品切れ・入荷無し")      'MenuImage短冊
                    ''.strPutStrings = GF_RevStr("品切れ")
                    ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 --------------------------
                    .lngPositionX = objBBitmap(0).Width
                    .lngCharLower = 435
                    '.lngCharLower = 310            '--- (2006.01.23) 短冊画像サイズ変更
                    .objFont = objFont(1)
                    .lngCharHeight = -18
                    .lngCharWidth = 38
                    .objColor = System.Drawing.Color.Red
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力

                '------------------------------
                ' 生成画像情報テーブル更新処理
                '------------------------------
                udtTPD020.SELLKBN = GC_OOS_SOLDOUT
                If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                    Exit Function
                End If

                objABitmap(0).Dispose()
                objAGraph.Dispose()
                objBBitmap(0).Dispose()
                objBGraph.Dispose()

                '------------------------------
                ' 商品マスタ／フラグ更新
                '------------------------------
                If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                    Exit Function
                End If


            Else

                '--- (2006.04.06) 飲み放題画像追加 ------------------------------------------------------------
                '------------------------------
                ' 描画フォント設定
                '------------------------------
                '--- (2006.01.23) 短冊画像サイズ変更 ------------
                If Not LF_FontSetup(objFont(0), pEJCD, 32) Then                     ' 品名表示フォント(通常表示)
                    Exit Function
                End If
                ''If Not LF_FontSetup(objFont(0), pEJCD, 28) Then                     ' 品名表示フォント(通常表示)
                ''    Exit Function
                ''End If
                '------------------------------------------------
                If Not LF_FontSetup(objFont(1), pEJCD, 20) Then                     ' 価格表示フォント
                    Exit Function
                End If
                '--- (2006.01.23) 短冊画像サイズ変更 ------------
                If Not LF_FontSetup(objFont(2), pEJCD, 22) Then                     ' 品名表示フォント(日本語縮小表示)
                    Exit Function
                End If
                'If Not LF_FontSetup(objFont(2), pEJCD, 23) Then                     ' 品名表示フォント(日本語縮小表示)
                '    Exit Function
                'End If
                '------------------------------------------------
                If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                    Exit Function
                End If

                '------------------------------
                ' バッファ領域初期化
                '------------------------------
                strTCImageCD(0) = pMaterialID(1)
                If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strTCImageCD) Then
                    Exit Function
                End If

                '------------------------------
                '　品名出力
                '------------------------------
                If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ"))
                        .lngPositionX = objCBitmap(0).Width
                        .lngCharLower = 10
                        .objColor = System.Drawing.Color.Black
                        .objFont = objFont(0)
                        .lngCharHeight = LC_TITLE_HEIGHT + 5
                        '.lngCharHeight = LC_TITLE_HEIGHT                       '--- (2006.01.23) 短冊画像サイズ変更
                        .lngCharWidth = 43
                    End With
                    lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
                Else
                    '--- (2006.01.23) 短冊画像サイズ変更 -----------------------------------------------------------------------
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ")) & CStr(pRows("GOODSNMJ2"))
                        .lngPositionX = objCBitmap(0).Width
                        .lngCharLower = 10
                        .objColor = System.Drawing.Color.Black
                        .objFont = objFont(2)
                        .lngCharHeight = LC_TITLE_HEIGHT - 6
                        .lngCharWidth = 38
                    End With
                    lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
                    '-----------------------------------------------------------------------------------------------------------
                End If

                '------------------------------
                ' 価格出力
                '------------------------------
                With udtParam
                    .strPutStrings = GF_RevStr("飲み放題")
                    .lngPositionX = objCBitmap(0).Width
                    .lngCharLower = 435
                    .objFont = objFont(1)
                    .lngCharHeight = -18
                    .lngCharWidth = 38
                    .objColor = System.Drawing.Color.Red
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力

                '------------------------------
                ' 生成画像情報テーブル更新処理
                '------------------------------
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & "0"
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                    .SELLKBN = GC_OOS_ONSELE
                End With

                udtTPD020.SELLKBN = GC_OOS_NONE

                If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                    Exit Function
                End If

                objCBitmap(0).Dispose()
                objCGraph.Dispose()

                '----------------------------------------------------------------------------------------------
            End If

        End If
        LF_MakeTJGraphics = True

    End Function
    '--- (2006.06.28) 飲み放題対応 追加----------------------------------↓
    Private Function LF_MakeTJGraphics_FREE(ByVal pMaterialID() As String, _
                                       ByVal pRows As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pEJCD As String, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pGrpSubNo2 As Long, _
                                       ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        'Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        'Dim objABitmap(0) As Bitmap
        'Dim objAGraph As Graphics
        'Dim objAPicture As PictureBox
        'Dim strTBImageCD(0) As String                                        ' --- 売り切れ画像
        'Dim objBBitmap(0) As Bitmap
        'Dim objBGraph As Graphics
        'Dim objBPicture As PictureBox
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                           ' Dummy

        '--- (2006.04.06) 飲み放題メニュー
        Dim strTCImageCD(0) As String                                        ' --- 飲み放題画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing
        Dim strTDImageCD(0) As String                                        ' --- 飲み放題品切れ画像
        Dim objDBitmap(0) As Bitmap
        Dim objDGraph As Graphics = Nothing
        Dim objDPicture As PictureBox = Nothing

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics_FREE = False

        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "C" & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD020 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    '(2006.06.28) 飲み放題対応-------
                    '.LINE = Space(5)
                    .LINE = "F"
                    '--------------------------------
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            '--- (2006.01.23) 短冊画像サイズ変更 ------------
            If Not LF_FontSetup(objFont(0), pEJCD, 32) Then                     ' 品名表示フォント(通常表示)
                Exit Function
            End If
            ''If Not LF_FontSetup(objFont(0), pEJCD, 28) Then                     ' 品名表示フォント(通常表示)
            ''    Exit Function
            ''End If
            '------------------------------------------------
            If Not LF_FontSetup(objFont(1), pEJCD, 20) Then                     ' 価格表示フォント
                Exit Function
            End If
            '--- (2006.01.23) 短冊画像サイズ変更 ------------
            If Not LF_FontSetup(objFont(2), pEJCD, 22) Then                     ' 品名表示フォント(日本語縮小表示)
                Exit Function
            End If
            'If Not LF_FontSetup(objFont(2), pEJCD, 23) Then                     ' 品名表示フォント(日本語縮小表示)
            '    Exit Function
            'End If
            '------------------------------------------------
            If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                Exit Function
            End If

            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTCImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strTCImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objCBitmap(0).Width
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    .lngCharHeight = LC_TITLE_HEIGHT + 5
                    '.lngCharHeight = LC_TITLE_HEIGHT                       '--- (2006.01.23) 短冊画像サイズ変更
                    .lngCharWidth = 43
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                '--- (2006.01.23) 短冊画像サイズ変更 -----------------------------------------------------------------------
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ")) & CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = objCBitmap(0).Width
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE_HEIGHT - 6
                    .lngCharWidth = 38
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
                '-----------------------------------------------------------------------------------------------------------
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = GF_RevStr("飲み放題")
                .lngPositionX = objCBitmap(0).Width
                .lngCharLower = 435
                .objFont = objFont(1)
                .lngCharHeight = -18
                .lngCharWidth = 38
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                '(2006.06.28) 飲み放題対応-------
                '.LINE = Space(5)
                .LINE = "F"
                '--------------------------------
                .REFID = Trim$(pRows("GOODSCD")) & "0"
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With


            If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTDImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objDBitmap, objDGraph, objRect, objDPicture, strTDImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objDBitmap(0).Width
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    .lngCharHeight = LC_TITLE_HEIGHT + 5
                    '.lngCharHeight = LC_TITLE_HEIGHT                       '--- (2006.01.23) 短冊画像サイズ変更
                    .lngCharWidth = 43
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ")) & CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = objDBitmap(0).Width
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE_HEIGHT - 6
                    .lngCharWidth = 38
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 --------------------------
                .strPutStrings = GF_RevStr("入荷待ち")
                ''.strPutStrings = GF_RevStr("品切れ")
                ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 --------------------------
                .lngPositionX = objDBitmap(0).Width
                .lngCharLower = 435
                '.lngCharLower = 310            '--- (2006.01.23) 短冊画像サイズ変更
                .objFont = objFont(1)
                .lngCharHeight = -18
                .lngCharWidth = 38
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT_FREE
            If Not LF_SaveGroup(udtTPD020, 0, objDBitmap(0), objDGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                Exit Function
            End If

            objCBitmap(0).Dispose()
            objCGraph.Dispose()
            objDBitmap(0).Dispose()
            objDGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If
            '----------------------------------------------------------------------------------------------

        End If

        LF_MakeTJGraphics_FREE = True

    End Function
    '--- (2006.06.28) 飲み放題対応 追加----------------------------------↑

    '800x600用短冊画像作成
    Private Function LF_MakeTJGraphics_2(ByVal pMaterialID() As String, _
                                       ByVal pRows As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pEJCD As String, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pGrpSubNo2 As Long, _
                                       ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing
        Dim strTBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                           ' Dummy

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics_2 = False

        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "A" & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath2, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp, DispType.SVGA) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD020 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            If Not LF_FontSetup(objFont(0), pEJCD, 25) Then                     ' 品名表示フォント(通常表示)
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), pEJCD, 20) Then                     ' 価格表示フォント
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 21) Then                     ' 品名表示フォント(日本語縮小表示)
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strAImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    '.lngPositionX = objABitmap(0).Width + 4
                    .lngPositionX = objABitmap(0).Width + 11   '12インチ対応 2006.10.23
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 4
                    .lngCharWidth = objABitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                '商品名に2行目がある場合
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    '.lngPositionX = objABitmap(0).Width + 4
                    .lngPositionX = objABitmap(0).Width - 3 '12インチ対応 2006.10.23
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    '.lngPositionX = (objABitmap(0).Width + 4) / 2
                    .lngPositionX = (objABitmap(0).Width) / 2      '12インチ対応 2006.10.23
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                '--- (2006.02.14) 定額メニュー対応 -----------------------------------------------------
                'If Trim$(pRows("PRICETYPE")) = "0" Then
                If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                   Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then          ' 取得元項目名判定
                    .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("SECONDKEY"))) & "円")
                Else
                    .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("PRICE"))) & "円")
                End If
                'Else
                '    .strPutStrings = ""
                'End If
                '---------------------------------------------------------------------------------------

                '.lngPositionX = objABitmap(0).Width
                .lngPositionX = objABitmap(0).Width - 8   '12インチ対応 2006.10.23
                .lngCharLower = 415 '265
                .objFont = objFont(1)
                .lngCharHeight = -14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Black
            End With
            lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)   ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_ONSELE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTBImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strTBImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    '.lngPositionX = objBBitmap(0).Width + 4
                    .lngPositionX = objBBitmap(0).Width + 11   '12インチ対応 2006.10.23
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 4
                    .lngCharWidth = objBBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    '.lngPositionX = objBBitmap(0).Width + 4
                    .lngPositionX = objBBitmap(0).Width - 3  '12インチ対応 2006.10.23
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    '.lngPositionX = (objBBitmap(0).Width + 4) / 2
                    .lngPositionX = (objBBitmap(0).Width) / 2    '12インチ対応 2006.10.23
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .strPutStrings = GF_RevStr("品切れ・入荷無し")   'MenuImage2短冊
                ''.strPutStrings = GF_RevStr("品切れ")
                ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                '.lngPositionX = objBBitmap(0).Width
                .lngPositionX = objBBitmap(0).Width - 8    '12インチ対応 2006.10.23
                .lngCharLower = 415  '265
                .objFont = objFont(1)
                .lngCharHeight = -14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT
            If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            objABitmap(0).Dispose()
            objAGraph.Dispose()
            objBBitmap(0).Dispose()
            objBGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

        End If

        LF_MakeTJGraphics_2 = True

    End Function

    ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
    '800x600用短冊画像作成(飲み放題用)
    Private Function LF_MakeTJGraphics_2_FREE(ByVal pMaterialID() As String, _
                                       ByVal pRows As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pEJCD As String, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pGrpSubNo2 As Long, _
                                       ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                            ' Dummy

        Dim strTCImageCD(0) As String                                        ' 飲み放題通常表示画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing
        Dim strTDImageCD(0) As String                                        ' 飲み放題品切れ画像
        Dim objDBitmap(0) As Bitmap
        Dim objDGraph As Graphics = Nothing
        Dim objDPicture As PictureBox = Nothing

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics_2_FREE = False

        ' --- [※ メモ (2008.01.11) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "C" & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath2, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp, DispType.SVGA) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD020 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = "F"
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            If Not LF_FontSetup(objFont(0), pEJCD, 25) Then                     ' 品名表示フォント(通常表示)
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), pEJCD, 20) Then                     ' 価格表示フォント
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 21) Then                     ' 品名表示フォント(日本語縮小表示)
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTCImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strTCImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objCBitmap(0).Width + 11
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 4
                    .lngCharWidth = objCBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                '商品名に2行目がある場合
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objCBitmap(0).Width - 3
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objCBitmap(0).Width) / 2
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = GF_RevStr("飲み放題")
                .lngPositionX = objCBitmap(0).Width - 8
                .lngCharLower = 415 '265
                .objFont = objFont(1)
                .lngCharHeight = -14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)           ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                '.LINE = Space(5)
                .LINE = "F"
                .REFID = Trim$(pRows("GOODSCD")) & "0"
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTDImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objDBitmap, objDGraph, objRect, objDPicture, strTDImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objDBitmap(0).Width + 11
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 4
                    .lngCharWidth = objDBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objDBitmap(0).Width - 3
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objDBitmap(0).Width) / 2
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE2_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = GF_RevStr("入荷待ち")
                .lngPositionX = objDBitmap(0).Width - 8
                .lngCharLower = 415  '265
                .objFont = objFont(1)
                .lngCharHeight = -14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT_FREE
            If Not LF_SaveGroup(udtTPD020, 0, objDBitmap(0), objDGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

            objCBitmap(0).Dispose()
            objCGraph.Dispose()
            objDBitmap(0).Dispose()
            objDGraph.Dispose()
        End If

        LF_MakeTJGraphics_2_FREE = True

    End Function
    ' -----------------------------------------------------------

    '短冊作成 640×480用
    Private Function LF_MakeTJGraphics_3(ByVal pMaterialID() As String, _
                                    ByVal pRows As DataRow, _
                                    ByVal pDispOrder As Long, _
                                    ByVal pEJCD As String, _
                                    ByVal pGrpNo As Long, _
                                    ByVal pGrpSubNo As Long, _
                                    ByVal pGrpSubNo2 As Long, _
                                    ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing
        Dim strTBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                           ' Dummy

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strcount As Integer
        Dim strprice1 As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics_3 = False
        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath3, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp, DispType.VGA) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            strcount = Len(Trim$(pRows("GOODSNMJ")))

            Select Case strcount
                '０〜７文字まで
            Case 0 To 7
                    If Not LF_FontSetup(objFont(0), pEJCD, 27) Then                     ' 品名表示フォント(通常表示) 25
                        Exit Function
                    End If
                    '８〜１０まで
                Case 8 To 10
                    If Not LF_FontSetup(objFont(0), pEJCD, 20) Then                     ' 品名表示フォント(通常表示) 25
                        Exit Function
                    End If
            End Select

            If Not LF_FontSetup(objFont(1), pEJCD, 22) Then                     ' 価格表示フォント 20
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 19) Then                     ' 品名表示フォント(日本語縮小表示)
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strAImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    If strcount < 8 Then
                        .lngPositionX = objABitmap(0).Width + 5 '4
                    Else
                        .lngPositionX = objABitmap(0).Width + 9 '4
                    End If
                    .lngCharLower = 10 '10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    If strcount < 8 Then
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    Else
                        .lngCharHeight = LC_TITLE3_HEIGHT - 8
                    End If
                    .lngCharWidth = objABitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objABitmap(0).Width - 5 '+ 4
                    .lngCharLower = 10 '10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objABitmap(0).Width - 10) / 2 '+ 4
                    .lngCharLower = 10 '10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                   Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then          ' 取得元項目名判定

                    .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("SECONDKEY"))) & "円")
                Else
                    .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("PRICE"))) & "円")
                End If
                '単価桁数により、表示文字サイズ変更
                strprice1 = Len(Trim$(.strPutStrings))

                Select Case strprice1
                    '０〜５文字
                Case 0 To 5
                        If Not LF_FontSetup(objFont(1), pEJCD, 22) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -22 ' -14
                        .lngCharLower = 338 '265
                        .lngPositionX = objABitmap(0).Width - 13

                    Case 6
                        If Not LF_FontSetup(objFont(1), pEJCD, 16) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -18 ' -14
                        .lngCharLower = 353 '265
                        .lngPositionX = objABitmap(0).Width - 8

                    Case 7
                        If Not LF_FontSetup(objFont(1), pEJCD, 14) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -16 ' -14
                        .lngCharLower = 353 '265
                        .lngPositionX = objABitmap(0).Width - 7

                    Case 8
                        If Not LF_FontSetup(objFont(1), pEJCD, 12) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -14 ' -14
                        .lngCharLower = 353 '265
                        .lngPositionX = objABitmap(0).Width - 6

                    Case Else
                        If Not LF_FontSetup(objFont(1), pEJCD, 12) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -14 ' -14
                        .lngCharLower = 353 '265
                        .lngPositionX = objABitmap(0).Width - 6

                End Select

                .objFont = objFont(1)
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Black
            End With
            lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)   ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_ONSELE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTBImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strTBImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    If strcount < 8 Then
                        .lngPositionX = objBBitmap(0).Width + 5 '4
                    Else
                        .lngPositionX = objBBitmap(0).Width + 9
                    End If
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    If strcount < 8 Then
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    Else
                        .lngCharHeight = LC_TITLE3_HEIGHT - 8
                    End If
                    .lngCharWidth = objBBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objBBitmap(0).Width - 5 '4
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objBBitmap(0).Width - 10) / 2
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .strPutStrings = GF_RevStr("入荷待ち")
                ''.strPutStrings = GF_RevStr("品切れ")
                ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .lngPositionX = objBBitmap(0).Width - 13
                .lngCharLower = 338

                If Not LF_FontSetup(objFont(1), pEJCD, 22) Then                     ' 価格表示フォント
                    Exit Function
                End If
                .objFont = objFont(1)
                .lngCharHeight = -22 '-14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT
            If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            objABitmap(0).Dispose()
            objAGraph.Dispose()
            objBBitmap(0).Dispose()
            objBGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

        End If

        LF_MakeTJGraphics_3 = True

    End Function
    '短冊作成 800×480用
    Private Function LF_MakeTJGraphics_4(ByVal pMaterialID() As String, _
                                    ByVal pRows As DataRow, _
                                    ByVal pDispOrder As Long, _
                                    ByVal pEJCD As String, _
                                    ByVal pGrpNo As Long, _
                                    ByVal pGrpSubNo As Long, _
                                    ByVal pGrpSubNo2 As Long, _
                                    ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing
        Dim strTBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                           ' Dummy

        '---2006.6.9 飲み放題メニュー追加対応 START---
        Dim strTCImageCD(0) As String
        Dim objCBitmap(0) As Bitmap
        '---2006.6.9 飲み放題メニュー追加対応 END---


        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strcount As Integer
        Dim strprice1 As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics_4 = False
        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "*.jpg"         '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "A" & "*.jpg"      '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath3, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp, DispType.VGA) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If
        Else
            '------------------------------
            ' 描画フォント設定
            '------------------------------
            strcount = Len(Trim$(pRows("GOODSNMJ")))
            Select Case strcount
                '０〜７文字まで
            Case 0 To 7
                    If Not LF_FontSetup(objFont(0), pEJCD, 35) Then                     ' 品名表示フォント(通常表示) 25
                        Exit Function
                    End If
                    '８〜１０まで
                Case 8 To 10
                    If Not LF_FontSetup(objFont(0), pEJCD, 35) Then                     ' 品名表示フォント(通常表示) 25
                        Exit Function
                    End If
            End Select

            If Not LF_FontSetup(objFont(1), pEJCD, 27) Then                     ' 価格表示フォント 20
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 25) Then                     ' 品名表示フォント(日本語縮小表示=商品名が２つある場合)　19
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                Exit Function
            End If


            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strAImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    If strcount < 8 Then
                        .lngPositionX = objABitmap(0).Width + 5 '4
                    Else
                        .lngPositionX = objABitmap(0).Width + 5 '9
                    End If
                    .lngCharLower = 10 '10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    If strcount < 8 Then
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    Else
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1 '8
                    End If
                    .lngCharWidth = objABitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objABitmap(0).Width - 5 '+ 4、-5
                    .lngCharLower = 10 '10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objABitmap(0).Width - 10) / 2 '+ 4、-5
                    .lngCharLower = 10 '10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                   Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then          ' 取得元項目名判定

                    .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("SECONDKEY"))) & "円")
                Else
                    .strPutStrings = GF_RevStr(GF_ChgNumeric(Trim$(pRows("PRICE"))) & "円")
                End If
                '単価桁数により、表示文字サイズ変更
                strprice1 = Len(Trim$(.strPutStrings))

                Select Case strprice1
                    '０〜５文字
                Case 0 To 5
                        If Not LF_FontSetup(objFont(1), pEJCD, 27) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -22 ' -14
                        .lngCharLower = 415 '265,338
                        .lngPositionX = objABitmap(0).Width - 13

                    Case 6
                        If Not LF_FontSetup(objFont(1), pEJCD, 22) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -18 ' -14
                        .lngCharLower = 415 '265
                        .lngPositionX = objABitmap(0).Width - 8

                    Case 7
                        If Not LF_FontSetup(objFont(1), pEJCD, 18) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -14 ' -14
                        .lngCharLower = 415 '265
                        .lngPositionX = objABitmap(0).Width - 7

                    Case 8
                        If Not LF_FontSetup(objFont(1), pEJCD, 15) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -14 ' -14
                        .lngCharLower = 415 '265
                        .lngPositionX = objABitmap(0).Width - 6

                    Case Else
                        If Not LF_FontSetup(objFont(1), pEJCD, 15) Then                     ' 価格表示フォント 20
                            Exit Function
                        End If
                        .lngCharHeight = -14 ' -14
                        .lngCharLower = 415 '265
                        .lngPositionX = objABitmap(0).Width - 6

                End Select

                .objFont = objFont(1)
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Black
            End With
            lngSubX = LF_PutVString(udtParam, objAGraph, Nothing)   ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_ONSELE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTBImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strTBImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    If strcount < 8 Then
                        .lngPositionX = objBBitmap(0).Width + 5 '4
                    Else
                        .lngPositionX = objBBitmap(0).Width + 5
                    End If
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    If strcount < 8 Then
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    Else
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    End If
                    .lngCharWidth = objBBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objBBitmap(0).Width - 5 '4
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objBBitmap(0).Width - 10) / 2
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .strPutStrings = GF_RevStr("品切れ・入荷無し")  'MenuImage3短冊
                ''.strPutStrings = GF_RevStr("品切れ")
                ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .lngPositionX = objBBitmap(0).Width - 11 '8 '13
                .lngCharLower = 415

                If Not LF_FontSetup(objFont(1), pEJCD, 27) Then                     ' 価格表示フォント
                    Exit Function
                End If
                .objFont = objFont(1) 'objFont(1)
                .lngCharHeight = -14 '-22 '-14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objBGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT
            If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            objABitmap(0).Dispose()
            objAGraph.Dispose()
            objBBitmap(0).Dispose()
            objBGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

        End If
        LF_MakeTJGraphics_4 = True

    End Function

    '短冊作成 （飲み放題対応）800×480用
    Private Function LF_MakeTJGraphics_4_FREE(ByVal pMaterialID() As String, _
                                    ByVal pRows As DataRow, _
                                    ByVal pDispOrder As Long, _
                                    ByVal pEJCD As String, _
                                    ByVal pGrpNo As Long, _
                                    ByVal pGrpSubNo As Long, _
                                    ByVal pGrpSubNo2 As Long, _
                                    ByVal pCreateMode As typCreateMode) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        'Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        'Dim objABitmap(0) As Bitmap
        'Dim objAGraph As Graphics
        'Dim objAPicture As PictureBox
        'Dim strTBImageCD(0) As String                                        ' --- 売り切れ画像
        'Dim objBBitmap(0) As Bitmap
        'Dim objBGraph As Graphics
        'Dim objBPicture As PictureBox
        Dim objFont(3) As Font
        Dim objRect As RectangleF                                           ' Dummy

        '---2006.6.9 飲み放題メニュー追加対応 START---
        Dim strTCImageCD(0) As String
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing
        Dim strTDImageCD(0) As String                                        ' --- 飲み放題品切れ画像
        Dim objDBitmap(0) As Bitmap
        Dim objDGraph As Graphics = Nothing
        Dim objDPicture As PictureBox = Nothing
        '---2006.6.9 飲み放題メニュー追加対応 END---


        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutVString
        Dim lngSubX As Long

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strcount As Integer

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeTJGraphics_4_FREE = False
        ' --- [※ メモ (2004.05.07) ※] ----------------------------------------------------
        ' 商品情報が変更されておらず、且つ旧生成画像保存パスにファイルが存在する場合のみ、
        ' ファイルコピー処理を行う
        ' また、旧生成画像保存パスに複数画像存在した場合は、最新のものを適用するものとする
        ' ----------------------------------------------------------------------------------

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "*.jpg"         '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Tanzaku) & "C" & "*.jpg"      '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath3, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Tanzaku, strTimeStamp, DispType.VGA) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    '(2006.06.28) 飲み放題対応-------
                    '.LINE = Space(5)
                    .LINE = "F"
                    '--------------------------------
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Tanzaku)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If
        Else
            '--- 2006.06.09 飲み放題画像追加処理 START---
            '------------------------------
            ' 描画フォント設定
            '------------------------------
            strcount = Len(Trim$(pRows("GOODSNMJ")))

            Select Case strcount
                '０〜７文字まで
            Case 0 To 7
                    If Not LF_FontSetup(objFont(0), pEJCD, 35) Then                     ' 品名表示フォント(通常表示) 25
                        Exit Function
                    End If
                    '８〜１０まで
                Case 8 To 10
                    If Not LF_FontSetup(objFont(0), pEJCD, 35) Then                     ' 品名表示フォント(通常表示) 25
                        Exit Function
                    End If
            End Select

            If Not LF_FontSetup(objFont(1), pEJCD, 27) Then                     ' 価格表示フォント 20
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 25) Then                     ' 品名表示フォント(日本語縮小表示=商品名が２つある場合)　19
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 20) Then                     ' 品名表示フォント(英語縮小文字)
                Exit Function
            End If

            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTCImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strTCImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    If strcount < 8 Then
                        .lngPositionX = objCBitmap(0).Width + 5 '4
                    Else
                        .lngPositionX = objCBitmap(0).Width + 5
                    End If
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    If strcount < 8 Then
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    Else
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    End If
                    .lngCharWidth = objCBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objCBitmap(0).Width - 5 '4
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objCBitmap(0).Width - 10) / 2
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = GF_RevStr("飲み放題")
                .lngPositionX = objCBitmap(0).Width - 13
                .lngCharLower = 415

                If Not LF_FontSetup(objFont(1), pEJCD, 27) Then                     ' 価格表示フォント
                    Exit Function
                End If
                .objFont = objFont(1)
                .lngCharHeight = -22 '-14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objCGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                '(2006.06.28) 飲み放題対応-------
                '.LINE = Space(5)
                .LINE = "F"
                '--------------------------------
                .REFID = Trim$(pRows("GOODSCD")) & "0"
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With

            If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTDImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objDBitmap, objDGraph, objRect, objDPicture, strTDImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) = 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    If strcount < 8 Then
                        .lngPositionX = objDBitmap(0).Width + 5 '4
                    Else
                        .lngPositionX = objDBitmap(0).Width + 5
                    End If
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                    If strcount < 8 Then
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    Else
                        .lngCharHeight = LC_TITLE3_HEIGHT - 1
                    End If
                    .lngCharWidth = objDBitmap(0).Width
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
            Else
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .lngPositionX = objDBitmap(0).Width - 5 '4
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 25
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngPositionX = (objDBitmap(0).Width - 10) / 2
                    .lngCharLower = 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(2)
                    .lngCharHeight = LC_TITLE3_HEIGHT - 6
                    .lngCharWidth = 23
                End With
                lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力
            End If

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .strPutStrings = GF_RevStr("入荷待ち")
                ''.strPutStrings = GF_RevStr("品切れ")
                ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------------
                .lngPositionX = objDBitmap(0).Width - 13
                .lngCharLower = 415

                If Not LF_FontSetup(objFont(1), pEJCD, 27) Then                     ' 価格表示フォント
                    Exit Function
                End If
                .objFont = objFont(1)
                .lngCharHeight = -22 '-14
                .lngCharWidth = 31
                .objColor = System.Drawing.Color.Red
            End With
            lngSubX = LF_PutVString(udtParam, objDGraph, Nothing)       ' 縦書き文字列分解出力

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT_FREE
            If Not LF_SaveGroup(udtTPD020, 0, objDBitmap(0), objDGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

            objCBitmap(0).Dispose()
            objCGraph.Dispose()
            objDBitmap(0).Dispose()
            objDGraph.Dispose()

        End If
        LF_MakeTJGraphics_4_FREE = True

    End Function
    '--- (2006.04.07) 飲み放題メニュー対応に伴い、引数追加 --------------------------------
    'Private Function LF_MakeGJGraphics(ByVal pMaterialID() As String, _
    '                                   ByVal pRows As DataRow, _
    '                                   ByVal pDispOrder As Long, _
    '                                   ByVal pEJCD As String, _
    '                                   ByVal pGrpNo As Long, _
    '                                   ByVal pGrpSubNo As Long, _
    '                                   ByVal pGrpSubNo2 As Long, _
    '                                   ByVal pLine As Long, _
    '                                   ByVal pCreateMode As typCreateMode) As Boolean
    Private Function LF_MakeGJGraphics(ByVal pMaterialID() As String, _
                                       ByVal pRows As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pEJCD As String, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pGrpSubNo2 As Long, _
                                       ByVal pLine As Long, _
                                       ByVal pCreateMode As typCreateMode, _
                                       Optional ByVal pFreeMode As Boolean = False) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing

        Dim strBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing

        '--- (2006.04.06) 飲み放題メニュー追加
        Dim strCImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing

        Dim objFont(4) As Font
        'Dim objFont(2) As Font                                             ' (2006.01.23) フォント種類増量
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long

        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Photo12) & "*.jpg"      '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Photo12) & "A" & "*.jpg"      '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Photo12, strTimeStamp) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD020 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp) Then
                    Exit Function
                End If
            End If
        Else
            '--- (2006.04.11) 飲み放題メニュー対応 判定文追加
            If pFreeMode = False Then

                '------------------------------
                ' 描画フォント設定
                '------------------------------
                If Not LF_FontSetup(objFont(0), pEJCD, 18) Then
                    Exit Function
                End If
                If Not LF_FontSetup(objFont(1), pEJCD, 24) Then
                    Exit Function
                End If
                If Not LF_FontSetup(objFont(2), pEJCD, 24) Then
                    Exit Function
                End If
                '--- (2006.01.23) フォントサイズを大中小の3種類に変更 --------------------------
                If Not LF_FontSetup(objFont(3), pEJCD, 24) Then
                    Exit Function
                End If
                If Not LF_FontSetup(objFont(4), pEJCD, 28) Then
                    Exit Function
                End If
                '-------------------------------------------------------------------------------

                '------------------------------------------------------------------------------------------
                ' 通常表示画像生成
                '------------------------------------------------------------------------------------------
                '------------------------------
                ' バッファ領域初期化
                '------------------------------
                strAImageCD(0) = pMaterialID(0)
                If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                    Exit Function
                End If

                '------------------------------
                '　品名出力
                '------------------------------
                '---(2006.01.23) 文字サイズを大中小の3種類に変更 -----------------------------------------
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .objColor = System.Drawing.Color.White
                    .lngCharLower = 0
                    .lngPositionY = 6

                    If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                        .lngCharHeight = 25
                        .objFont = objFont(0)
                    Else
                        Select Case Len(CStr(pRows("GOODSNMJ")))
                            Case 1 To 5
                                .lngCharHeight = 35
                                .objFont = objFont(4)
                            Case 6 To 7
                                .lngCharHeight = 30
                                .objFont = objFont(3)
                            Case Else
                                .lngCharHeight = 25
                                .objFont = objFont(0)
                        End Select
                    End If
                End With
                'With udtParam
                '    .strPutStrings = CStr(pRows("GOODSNMJ"))
                '    .lngCharHeight = 25
                '    .lngCharLower = 0
                '    .lngPositionY = 6
                '    .objColor = System.Drawing.Color.White
                '    .objFont = objFont(0)
                'End With
                '-----------------------------------------------------------------------------------------
                lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)

                ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ2"))
                        .lngCharHeight = 25
                        .lngCharLower = 0
                        .lngPositionY = 24
                        .objColor = System.Drawing.Color.White
                        .objFont = objFont(0)
                    End With
                    lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)
                End If
                ' ------------------------------------------------------------------

                '------------------------------
                ' 価格出力
                '------------------------------
                With udtParam
                    '--- (2006.02.14) 定額メニュー対応 --------------------------------------------------------------
                    'If Trim$(pRows("PRICETYPE")) = "0" Then
                    If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                       Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then       ' 取得元項目名判定
                        '.strPutStrings = GF_ChgNumeric(Trim$(pRows("SECONDKEY"))) & "円"
                        .strPutStrings = Format(CLng(Trim$(pRows("SECONDKEY"))), "###0") & "円"
                    Else
                        '.strPutStrings = GF_ChgNumeric(Trim$(pRows("PRICE"))) & "円"
                        .strPutStrings = Format(CLng(Trim$(pRows("PRICE"))), "###0") & "円"
                    End If
                    'Else
                    '    .strPutStrings = ""
                    'End If
                    '------------------------------------------------------------------------------------------------
                    .lngCharHeight = 30
                    .lngCharLower = 160
                    .lngPositionY = 149
                    .lngCharWidth = 15
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(1)
                End With
                lngSubX = LF_PutHString3(udtParam, objAGraph)

                '------------------------------
                ' 商品画像出力
                '------------------------------
                Try
                    strItemImage = Trim$(pRows("IMAGEDATA"))
                    If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                    Else
                        If Len(Trim$(strItemImage)) <> 0 Then
                            strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                        Else
                            strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                        End If
                    End If
                    objItemImg = New Bitmap(strItemImage)
                    Call objAGraph.DrawImage(objItemImg, 25, 42, 143, 110)
                    objItemImg.Dispose()
                Catch
                    Exit Function
                End Try

                '--- (2006.02.20) おすすめアイコン対応 -------------------------------
                Try
                    If Trim$(pRows("SPFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objAGraph.DrawImage(objItemImg, 6, 120, 100, 50)   '左下
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try
                '---------------------------------------------------------------------

                '--- (2006.02.21) 新作フラグ -----------------------------------------
                Try
                    If Trim$(pRows("NEWFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objAGraph.DrawImage(objItemImg, 140, 42, 50, 25)  '右上
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try
                '---------------------------------------------------------------------

                '------------------------------
                ' 生成画像情報テーブル更新処理
                '------------------------------
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                    .SELLKBN = GC_OOS_ONSELE
                End With
                If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                    Exit Function
                End If

                '------------------------------------------------------------------------------------------
                ' 売り切れ画像生成
                '------------------------------------------------------------------------------------------
                '------------------------------
                ' バッファ領域初期化
                '------------------------------
                strBImageCD(0) = pMaterialID(1)
                If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strBImageCD) Then
                    Exit Function
                End If

                '------------------------------
                '　品名出力
                '------------------------------
                '---(2006.01.23) 文字サイズを大中小の3種類に変更 -----------------------------------------
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ"))
                    .objColor = System.Drawing.Color.White
                    .lngCharLower = 0
                    .lngPositionY = 6

                    If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                        .lngCharHeight = 25
                        .objFont = objFont(0)
                    Else
                        Select Case Len(CStr(pRows("GOODSNMJ")))
                            Case 1 To 5
                                .lngCharHeight = 35
                                .objFont = objFont(4)
                            Case 6 To 7
                                .lngCharHeight = 30
                                .objFont = objFont(3)
                            Case Else
                                .lngCharHeight = 25
                                .objFont = objFont(0)
                        End Select
                    End If
                End With
                'With udtParam
                '    .strPutStrings = Trim$(pRows("GOODSNMJ"))
                '    .lngCharHeight = 25
                '    .lngCharLower = 0
                '    .lngPositionY = 6
                '    .objColor = System.Drawing.Color.White
                '    .objFont = objFont(0)
                'End With
                lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
                '-----------------------------------------------------------------------------------------
                ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ2"))
                        .lngCharHeight = 25
                        .lngCharLower = 0
                        .lngPositionY = 24
                        .objColor = System.Drawing.Color.White
                        .objFont = objFont(0)
                    End With
                    lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
                End If
                ' ------------------------------------------------------------------

                '------------------------------
                ' 価格出力
                '------------------------------
                With udtParam
                    ' ↓  2005.10.08 品切れ→入荷待ち　変更対応
                    .strPutStrings = "品切れ・入荷無し"       'MenuImage写真12解説無し
                    ''.strPutStrings = "品切れ"
                    ' ↑  2005.10.08 品切れ→入荷待ち　変更対応
                    .lngCharHeight = 30
                    .lngCharLower = 40  '90
                    .lngPositionY = 153 '149
                    ' ↓  2005.10.08 品切れ→入荷待ち　変更対応
                    .lngCharWidth = 27  '27
                    ''.lngCharWidth = 20
                    ' ↑  2005.10.08 品切れ→入荷待ち　変更対応
                    .objColor = System.Drawing.Color.Red
                    .objFont = objFont(0) 'objFont(2)
                End With
                lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)

                '------------------------------
                ' 商品画像出力
                '------------------------------
                Try
                    strItemImage = Trim$(pRows("IMAGEDATA"))
                    If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                    Else
                        If Len(Trim$(strItemImage)) <> 0 Then
                            strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                        Else
                            strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                        End If
                    End If
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 25, 42, 143, 110)
                    objItemImg.Dispose()
                Catch
                    Exit Function
                End Try

                '--- (2006.02.20) おすすめアイコン対応 -------------------------------
                Try
                    If Trim$(pRows("SPFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objBGraph.DrawImage(objItemImg, 6, 120, 100, 50)   '左下
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try
                '---------------------------------------------------------------------

                '--- (2006.02.21) 新作フラグ -----------------------------------------
                Try
                    If Trim$(pRows("NEWFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objBGraph.DrawImage(objItemImg, 140, 42, 50, 25)  '右上
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try
                '---------------------------------------------------------------------

                udtTPD020.SELLKBN = GC_OOS_SOLDOUT
                If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                    Exit Function
                End If

                objABitmap(0).Dispose()
                objAGraph.Dispose()
                objBBitmap(0).Dispose()
                objBGraph.Dispose()

                '------------------------------
                ' 商品マスタ／フラグ更新
                '------------------------------
                If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                    Exit Function
                End If


            Else

                '------------------------------
                ' 描画フォント設定
                '------------------------------
                If Not LF_FontSetup(objFont(0), pEJCD, 18) Then
                    Exit Function
                End If
                If Not LF_FontSetup(objFont(1), pEJCD, 24) Then
                    Exit Function
                End If
                If Not LF_FontSetup(objFont(2), pEJCD, 24) Then
                    Exit Function
                End If
                '--- (2006.01.23) フォントサイズを大中小の3種類に変更 --------------------------
                If Not LF_FontSetup(objFont(3), pEJCD, 24) Then
                    Exit Function
                End If
                If Not LF_FontSetup(objFont(4), pEJCD, 28) Then
                    Exit Function
                End If
                '-------------------------------------------------------------------------------

                '--- (2006.04.06) 飲み放題メニュー追加 --------------------------------------------------
                '------------------------------
                ' バッファ領域初期化
                '------------------------------
                strCImageCD(0) = pMaterialID(1)
                If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strCImageCD) Then
                    Exit Function
                End If

                '------------------------------
                '　品名出力
                '------------------------------
                With udtParam
                    .strPutStrings = Trim$(pRows("GOODSNMJ"))
                    .lngCharHeight = 25
                    .lngCharLower = 0
                    .lngPositionY = 6
                    .objColor = System.Drawing.Color.White
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
                ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    With udtParam
                        .strPutStrings = CStr(pRows("GOODSNMJ2"))
                        .lngCharHeight = 25
                        .lngCharLower = 0
                        .lngPositionY = 24
                        .objColor = System.Drawing.Color.White
                        .objFont = objFont(0)
                    End With
                    lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
                End If
                ' ------------------------------------------------------------------

                '------------------------------
                ' 価格出力
                '------------------------------
                With udtParam
                    .strPutStrings = "飲み放題"
                    .lngCharHeight = 30
                    .lngCharLower = 90
                    .lngPositionY = 149
                    .lngCharWidth = 27
                    .objColor = System.Drawing.Color.Red
                    .objFont = objFont(2)
                End With
                lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)

                '------------------------------
                ' 商品画像出力
                '------------------------------
                Try
                    strItemImage = Trim$(pRows("IMAGEDATA"))
                    If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                    Else
                        If Len(Trim$(strItemImage)) <> 0 Then
                            strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                        Else
                            strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                        End If
                    End If
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 25, 42, 143, 110)
                    objItemImg.Dispose()
                Catch
                    Exit Function
                End Try

                Try
                    If Trim$(pRows("SPFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objCGraph.DrawImage(objItemImg, 6, 120, 100, 50)   '左下
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try
                '---------------------------------------------------------------------

                '--- (2006.02.21) 新作フラグ -----------------------------------------
                Try
                    If Trim$(pRows("NEWFLG")) = "1" Then
                        strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                        objItemImg = New Bitmap(strItemImage)
                        Call objCGraph.DrawImage(objItemImg, 140, 42, 50, 25)  '右上
                        objItemImg.Dispose()
                    End If
                Catch
                    Exit Function
                End Try
                '---------------------------------------------------------------------

                '------------------------------
                ' 生成画像情報テーブル更新処理
                '------------------------------
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                    .SELLKBN = GC_OOS_NONE
                End With

                If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                    Exit Function
                End If

                objCBitmap(0).Dispose()
                objCGraph.Dispose()

            End If
        End If
        LF_MakeGJGraphics = True

    End Function

    Private Function LF_MakeGJGraphics_FREE(ByVal pMaterialID() As String, _
                                       ByVal pRows As DataRow, _
                                       ByVal pDispOrder As Long, _
                                       ByVal pEJCD As String, _
                                       ByVal pGrpNo As Long, _
                                       ByVal pGrpSubNo As Long, _
                                       ByVal pGrpSubNo2 As Long, _
                                       ByVal pLine As Long, _
                                       ByVal pCreateMode As typCreateMode _
                                       ) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        'Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        'Dim objABitmap(0) As Bitmap
        'Dim objAGraph As Graphics
        'Dim objAPicture As PictureBox

        'Dim strBImageCD(0) As String                                        ' --- 売り切れ画像
        'Dim objBBitmap(0) As Bitmap
        'Dim objBGraph As Graphics
        'Dim objBPicture As PictureBox

        '--- (2006.04.06) 飲み放題メニュー追加
        Dim strCImageCD(0) As String                                        ' --- 飲み放題画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing
        Dim strDImageCD(0) As String                                        ' --- 飲み放題売り切れ画像
        Dim objDBitmap(0) As Bitmap
        Dim objDGraph As Graphics = Nothing
        Dim objDPicture As PictureBox = Nothing

        Dim objFont(4) As Font
        'Dim objFont(2) As Font                                             ' (2006.01.23) フォント種類増量
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long

        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics_FREE = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Photo12) & "*.jpg"
        strPattern = Trim$(pRows("GOODSCD")) & "_" & CStr(typImgPattern.Photo12) & "C" & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Photo12, strTimeStamp) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD020 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    '(2006.06.28) 飲み放題対応-------
                    '.LINE = Space(5)           
                    .LINE = "F"
                    '--------------------------------
                    .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            If Not LF_FontSetup(objFont(0), pEJCD, 18) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), pEJCD, 24) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 24) Then
                Exit Function
            End If
            '--- (2006.01.23) フォントサイズを大中小の3種類に変更 --------------------------
            If Not LF_FontSetup(objFont(3), pEJCD, 24) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont(4), pEJCD, 28) Then
                Exit Function
            End If
            '-------------------------------------------------------------------------------

            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strCImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strCImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                .lngPositionY = 6
                .objColor = System.Drawing.Color.White
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 25
                    .lngCharLower = 0
                    .lngPositionY = 24
                    .objColor = System.Drawing.Color.White
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = "飲み放題"
                .lngCharHeight = 30
                .lngCharLower = 90
                .lngPositionY = 149
                .lngCharWidth = 27
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objCGraph.DrawImage(objItemImg, 25, 42, 143, 110)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 6, 120, 100, 50)   '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.21) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 140, 42, 50, 25)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                '(2006.06.28) 飲み放題対応-------
                '.LINE = Space(5)
                .LINE = "F"
                '--------------------------------
                .REFID = Trim$(pRows("GOODSCD")) & CStr(typImgPattern.Photo12)
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With

            If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strDImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objDBitmap, objDGraph, objRect, objDPicture, strDImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            '---(2006.01.23) 文字サイズを大中小の3種類に変更 -----------------------------------------
            With udtParam
                .strPutStrings = CStr(pRows("GOODSNMJ"))
                .objColor = System.Drawing.Color.White
                .lngCharLower = 0
                .lngPositionY = 6

                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    .lngCharHeight = 25
                    .objFont = objFont(0)
                Else
                    Select Case Len(CStr(pRows("GOODSNMJ")))
                        Case 1 To 5
                            .lngCharHeight = 35
                            .objFont = objFont(4)
                        Case 6 To 7
                            .lngCharHeight = 30
                            .objFont = objFont(3)
                        Case Else
                            .lngCharHeight = 25
                            .objFont = objFont(0)
                    End Select
                End If
            End With
            'With udtParam
            '    .strPutStrings = Trim$(pRows("GOODSNMJ"))
            '    .lngCharHeight = 25
            '    .lngCharLower = 0
            '    .lngPositionY = 6
            '    .objColor = System.Drawing.Color.White
            '    .objFont = objFont(0)
            'End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            '-----------------------------------------------------------------------------------------
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 25
                    .lngCharLower = 0
                    .lngPositionY = 24
                    .objColor = System.Drawing.Color.White
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                ' ↓  2005.10.08 品切れ→入荷待ち　変更対応
                .strPutStrings = "入荷待ち"
                ''.strPutStrings = "品切れ"
                ' ↑  2005.10.08 品切れ→入荷待ち　変更対応
                .lngCharHeight = 30
                .lngCharLower = 90
                .lngPositionY = 149
                ' ↓  2005.10.08 品切れ→入荷待ち　変更対応
                .lngCharWidth = 27
                ''.lngCharWidth = 20
                ' ↑  2005.10.08 品切れ→入荷待ち　変更対応
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S013JC")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objDGraph.DrawImage(objItemImg, 25, 42, 143, 110)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            '--- (2006.02.20) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S042UC")
                    objItemImg = New Bitmap(strItemImage)
                    Call objDGraph.DrawImage(objItemImg, 6, 120, 100, 50)   '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.21) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("S043UC")
                    objItemImg = New Bitmap(strItemImage)
                    Call objDGraph.DrawImage(objItemImg, 140, 42, 50, 25)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            udtTPD020.SELLKBN = GC_OOS_SOLDOUT_FREE
            If Not LF_SaveGroup(udtTPD020, 0, objDBitmap(0), objDGraph, pEJCD, typImageKind.ItemImage, Nothing) Then
                Exit Function
            End If

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

            objCBitmap(0).Dispose()
            objCGraph.Dispose()
            objDBitmap(0).Dispose()
            objDGraph.Dispose()

        End If

        LF_MakeGJGraphics_FREE = True

    End Function

    '12インチ対応　2006.10.19
    '800x600サイズ用　9分割画像作成処理

    Private Function LF_MakeGJGraphics_2(ByVal pMaterialID() As String, _
                                         ByVal pRows As DataRow, _
                                         ByVal pDispOrder As Long, _
                                         ByVal pEJCD As String, _
                                         ByVal pGrpNo As Long, _
                                         ByVal pGrpSubNo As Long, _
                                         ByVal pGrpSubNo2 As Long, _
                                         ByVal pLine As Long, _
                                         ByVal pCreateMode As typCreateMode, _
                                         ByVal pFlag As String) As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing

        Dim strBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing

        '--- (2006.06.09) 飲み放題メニュー追加
        Dim strCImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing

        Dim objFont(3) As Font     '更新　2006/02/02
        Dim lngFontSize As Long
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long

        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strFlag As String = "" '更新 2006/03/08 追加
        Dim strstatus1 As String = "" '更新 2006/03/16 追加
        Dim strstatus2 As String = "" '更新 2006/03/16 追加
        Dim strstatus3 As String = ""
        Dim strstatus4 As String = ""

        strstatus1 = Trim$(pRows("SPFLG"))
        strstatus2 = Trim$(pRows("NEWFLG"))
        strstatus3 = Trim$(pRows("SPFLG"))
        strstatus4 = Trim$(pRows("NEWFLG"))

        '画像切り分けフラグを確認
        Select Case pFlag

            Case "6"    '6分割時
                strFlag = CStr(typImgPattern.Photo6)

            Case "4"    '4分割時
                strFlag = CStr(typImgPattern.Photo4)

            Case Else   '入力なしは6分割と見なす
                strFlag = CStr(typImgPattern.Photo6)

        End Select
        '以下更新部（strFlag）→元データ：”CStr(typImgPattern.Photo6)”

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics_2 = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "*.jpg"         '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "A" & "*.jpg"    '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath2, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            '4分割時以外は6分割扱い
            If pFlag = "4" Then
                If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Photo4, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            Else
                If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Photo6, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                '----------------------------------
                '　更新 2006/02/01 TPD026追加処理
                '----------------------------------
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & strFlag
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            'GOODSNMJの文字数をカウント
            '文字数１〜６なら　大に
            '文字数７〜８なら　中に
            '文字数９〜なら　　小に

            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                If Len(Trim$(pRows("GOODSNMJ2"))) < 9 And _
                    Len(Trim$(pRows("GOODSNMJ"))) < 9 Then
                    lngFontSize = 23
                Else
                    lngFontSize = 19
                End If
            Else
                Select Case Len(Trim$(pRows("GOODSNMJ")))
                    Case 1 To 6
                        lngFontSize = 31 '更新　2006/02/02 30
                    Case 7 To 8
                        lngFontSize = 26 '更新  2006/06/08 21
                    Case 9 To 10
                        lngFontSize = 21 '更新  2006/06/08 19
                    Case Else
                        lngFontSize = 19
                End Select
            End If

            If Not LF_FontSetup(objFont(0), pEJCD, lngFontSize) Then '19
                Exit Function
            End If
            'If Not LF_FontSetup(objFont(1), pEJCD, 25) Then '19        '2005.10.27 障害対応
            '    Exit Function
            'End If
            If Not LF_FontSetup(objFont(1), pEJCD, 23) Then '19
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 25) Then '23→25     
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 30) Then '19        
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strAImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = CStr(pRows("GOODSNMJ"))
                .lngCharLower = 0
                'If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                '    .lngCharHeight = 15
                'Else
                .lngCharHeight = 25
                'End If
                '.lngPositionY = 10 '更新　2006/02/02 2
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '8文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If

                .objColor = System.Drawing.Color.Black '更新 2006/02/02 white
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)

            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新　2006/02/02 17 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)
            End If
            ' ------------------------------------------------------------------


            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then

                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA66")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objAGraph.DrawImage(objItemImg, 15, 45, 225, 167)  '-- 12インチ対応 2006.10.20
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ------------------------------------------------------------------

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                   Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then       ' 取得元項目名判定
                    .strPutStrings = Format(CLng(Trim$(pRows("SECONDKEY"))), "###0") & "円"
                Else
                    .strPutStrings = Format(CLng(Trim$(pRows("PRICE"))), "###0") & "円"
                End If
                '.lngCharHeight = 30
                ''                .lngCharLower = 167            '2005.10.27 障害対応
                '.lngCharLower = 173   '171　151
                '.lngPositionY = 187   '115  165
                '.lngCharWidth = 16 '9　12 
                '.objColor = System.Drawing.Color.White
                '.objFont = objFont(3)
                '-- 12インチ対応  2006.10.23
                .lngCharHeight = 30
                .lngCharLower = 205
                .lngPositionY = 220
                .lngCharWidth = 16
                .objColor = System.Drawing.Color.White
                .objFont = objFont(3)
            End With
            lngSubX = LF_PutHString3(udtParam, objAGraph)

            '--- (2006.03.16) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA72")
                    objItemImg = New Bitmap(strItemImage)
                    'Call objAGraph.DrawImage(objItemImg, 0, 147, 122, 55)  '左下 90　35 始点 0,125　大きさ110,50
                    Call objAGraph.DrawImage(objItemImg, 0, 170, 122, 55)  '左下 90　35 始点 0,125　大きさ110,50
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.03.16) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA73")
                    objItemImg = New Bitmap(strItemImage)
                    'Call objAGraph.DrawImage(objItemImg, 157, 40, 66, 33)  '右上 始点 135 大きさ 60,30
                    Call objAGraph.DrawImage(objItemImg, 180, 45, 66, 33)  '右上 始点 135 大きさ 60,30
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRows("GOODSCD")) & strFlag
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_ONSELE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strBImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strBImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    '.lngPositionY = 10
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30 '25
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新 2006/02/06 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------
            '    画像出力、価格出力の順序を入れ替えのため、コメントアウト。
            ''------------------------------
            '' 価格出力
            ''------------------------------
            ''With udtParam
            ''    .lngCharHeight = 30
            ''    .lngCharLower = 125
            ''    .lngPositionY = 47  '115
            ''    .objColor = System.Drawing.Color.Red
            ''    .objFont = objFont(2)
            ''End With
            ''lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA66")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objBGraph.DrawImage(objItemImg, 15, 45, 225, 167)  '-- 12インチ対応 2006.10.20
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------
            ' ----------------------------------
            ' 更新 2006/02/08 
            ' 　　　入荷待ち文字影付け対応
            ' ----------------------------------
            With udtParam
                '.strPutStrings = "入荷待ち"
                '.lngCharHeight = 30
                '.lngCharLower = 102  '124
                '.lngPositionY = 189  '47,167
                '.objColor = System.Drawing.Color.Black
                '.objFont = objFont(2)
                .strPutStrings = "品切れ・入荷無し"     'MenuImage2写真
                .lngCharHeight = 30
                .lngCharLower = 42 '140
                .lngPositionY = 222
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                '.strPutStrings = "入荷待ち"
                '.lngCharHeight = 30
                '.lngCharLower = 100  '122
                '.lngPositionY = 187  '47 165
                '.objColor = System.Drawing.Color.Red
                '.objFont = objFont(2)
                '-- 12インチ対応  2006.10.23
                .strPutStrings = "品切れ・入荷無し"    'MenuImage2写真
                .lngCharHeight = 30
                .lngCharLower = 40 '140
                .lngPositionY = 220
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------

            '--- (2006.02.22) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA72")
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 0, 170, 122, 55)  '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.22) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA73")
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 180, 45, 66, 33)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------
            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT
            If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            objABitmap(0).Dispose()
            objAGraph.Dispose()
            objBBitmap(0).Dispose()
            objBGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If
        End If

        LF_MakeGJGraphics_2 = True

    End Function

    ' --- (2008.01.11) 飲み放題対応(SVGA用) ---------------------
    '800x600サイズ用　9分割画像作成処理(飲み放題用)
    Private Function LF_MakeGJGraphics_2_FREE(ByVal pMaterialID() As String, _
                                         ByVal pRows As DataRow, _
                                         ByVal pDispOrder As Long, _
                                         ByVal pEJCD As String, _
                                         ByVal pGrpNo As Long, _
                                         ByVal pGrpSubNo As Long, _
                                         ByVal pGrpSubNo2 As Long, _
                                         ByVal pLine As Long, _
                                         ByVal pCreateMode As typCreateMode, _
                                         ByVal pFlag As String) As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTCImageCD(0) As String                                        ' 飲み放題通常表示画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing
        Dim strTDImageCD(0) As String                                        ' 飲み放題品切れ画像
        Dim objDBitmap(0) As Bitmap
        Dim objDGraph As Graphics = Nothing
        Dim objDPicture As PictureBox = Nothing

        Dim objFont(3) As Font
        Dim lngFontSize As Long
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long
        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strFlag As String = ""
        Dim strstatus1 As String = ""
        Dim strstatus2 As String = ""
        Dim strstatus3 As String = ""
        Dim strstatus4 As String = ""

        strstatus1 = Trim$(pRows("SPFLG"))
        strstatus2 = Trim$(pRows("NEWFLG"))
        strstatus3 = Trim$(pRows("SPFLG"))
        strstatus4 = Trim$(pRows("NEWFLG"))

        '画像切り分けフラグを確認
        Select Case pFlag

            Case "6"    '6分割時
                strFlag = CStr(typImgPattern.Photo6)

            Case "4"    '4分割時
                strFlag = CStr(typImgPattern.Photo4)

            Case Else   '入力なしは6分割と見なす
                strFlag = CStr(typImgPattern.Photo6)

        End Select
        '以下更新部（strFlag）→元データ：”CStr(typImgPattern.Photo6)”

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics_2_FREE = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "C" & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath2, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            '4分割時以外は6分割扱い
            If pFlag = "4" Then
                If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Photo4, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            Else
                If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Photo6, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = "F"
                    .REFID = Trim$(pRows("GOODSCD")) & strFlag
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.SVGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            'GOODSNMJの文字数をカウント
            '文字数１〜６なら　大に
            '文字数７〜８なら　中に
            '文字数９〜なら　　小に

            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                If Len(Trim$(pRows("GOODSNMJ2"))) < 9 And _
                    Len(Trim$(pRows("GOODSNMJ"))) < 9 Then
                    lngFontSize = 23
                Else
                    lngFontSize = 19
                End If
            Else
                Select Case Len(Trim$(pRows("GOODSNMJ")))
                    Case 1 To 6
                        lngFontSize = 31
                    Case 7 To 8
                        lngFontSize = 26
                    Case 9 To 10
                        lngFontSize = 21
                    Case Else
                        lngFontSize = 19
                End Select
            End If

            If Not LF_FontSetup(objFont(0), pEJCD, lngFontSize) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont(1), pEJCD, 23) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 25) Then
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 30) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTCImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strTCImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = CStr(pRows("GOODSNMJ"))
                .lngCharLower = 0
                .lngCharHeight = 25
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '8文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If

                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)

            ' ------------------------------
            ' タッチパネル商品名２追加
            ' ------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30
                    .lngCharLower = 0
                    .lngPositionY = 18
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            End If

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then

                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA66")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objCGraph.DrawImage(objItemImg, 15, 45, 225, 167)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = "飲み放題"
                .lngCharHeight = 30
                .lngCharLower = 140
                .lngPositionY = 220
                .lngCharWidth = 27
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)

            '------------------------------
            ' おすすめアイコン対応
            '------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA72")
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 0, 170, 122, 55)  '左下 90　35 始点 0,125　大きさ110,50
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try

            '------------------------------
            ' 新作フラグ
            '------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA73")
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 180, 45, 66, 33)  '右上 始点 135 大きさ 60,30
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = "F"
                .REFID = Trim$(pRows("GOODSCD")) & strFlag
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strTDImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objDBitmap, objDGraph, objRect, objDPicture, strTDImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)

            '------------------------------
            ' タッチパネル商品名２追加
            '------------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30
                    .lngCharLower = 0
                    .lngPositionY = 18
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            End If

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA66")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objDGraph.DrawImage(objItemImg, 15, 45, 225, 167)  '-- 12インチ対応 2006.10.20
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ----------------------------------
            ' 入荷待ち文字影付け対応
            ' ----------------------------------
            With udtParam
                .strPutStrings = "入荷待ち"
                .lngCharHeight = 30
                .lngCharLower = 140
                .lngPositionY = 220
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = "入荷待ち"
                .lngCharHeight = 30
                .lngCharLower = 140
                .lngPositionY = 220
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)

            '------------------------------
            ' おすすめアイコン対応
            '------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA72")
                    objItemImg = New Bitmap(strItemImage)
                    Call objDGraph.DrawImage(objItemImg, 0, 170, 122, 55)  '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try

            '------------------------------
            ' 新作フラグ
            '------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("SVGA73")
                    objItemImg = New Bitmap(strItemImage)
                    Call objDGraph.DrawImage(objItemImg, 180, 45, 66, 33)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT_FREE
            If Not LF_SaveGroup(udtTPD020, 0, objDBitmap(0), objDGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.SVGA) Then
                Exit Function
            End If

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

            objCBitmap(0).Dispose()
            objCGraph.Dispose()
            objDBitmap(0).Dispose()
            objDGraph.Dispose()
        End If

        LF_MakeGJGraphics_2_FREE = True

    End Function
    ' -----------------------------------------------------------

    ' 更新 640x480サイズ用　6分割画像作成処理
    ' 更新 2006/03/08 4分割選択時は6分割画像のＩＤを切り分ける為、引数pflag追加
    Private Function LF_MakeGJGraphics_3(ByVal pMaterialID() As String, _
                                         ByVal pRows As DataRow, _
                                         ByVal pDispOrder As Long, _
                                         ByVal pEJCD As String, _
                                         ByVal pGrpNo As Long, _
                                         ByVal pGrpSubNo As Long, _
                                         ByVal pGrpSubNo2 As Long, _
                                         ByVal pLine As Long, _
                                         ByVal pCreateMode As typCreateMode, _
                                         ByVal pFlag As String) As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing

        Dim strBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing

        Dim objFont(3) As Font     '更新　2006/02/02
        Dim lngFontSize As Long
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long

        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strFlag As String = "" '更新 2006/03/08 追加
        Dim strstatus1 As String = "" '更新 2006/03/16 追加
        Dim strstatus2 As String = "" '更新 2006/03/16 追加
        Dim strstatus3 As String = ""
        Dim strstatus4 As String = ""

        strstatus1 = Trim$(pRows("SPFLG"))
        strstatus2 = Trim$(pRows("NEWFLG"))
        strstatus3 = Trim$(pRows("SPFLG"))
        strstatus4 = Trim$(pRows("NEWFLG"))

        '画像切り分けフラグを確認
        Select Case pFlag

            Case "6"    '6分割時
                strFlag = CStr(typImgPattern.Photo6)

            Case "4"    '4分割時
                strFlag = CStr(typImgPattern.Photo4)

            Case Else   '入力なしは6分割と見なす
                strFlag = CStr(typImgPattern.Photo6)

        End Select
        '以下更新部（strFlag）→元データ：”CStr(typImgPattern.Photo6)”

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics_3 = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "*.jpg"
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath3, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), strFlag, strTimeStamp, DispType.VGA) Then
                Exit Function
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                '----------------------------------
                '　更新 2006/02/01 TPD026追加処理
                '----------------------------------
                ' TPD025 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & strFlag
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------

            'GOODSNMJの文字数をカウント
            '文字数１〜６なら　大に
            '文字数７〜８なら　中に
            '文字数９〜なら　　小に

            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                If Len(Trim$(pRows("GOODSNMJ2"))) < 9 And _
                    Len(Trim$(pRows("GOODSNMJ"))) < 9 Then
                    lngFontSize = 23
                Else
                    lngFontSize = 19
                End If
            Else
                Select Case Len(Trim$(pRows("GOODSNMJ")))
                    Case 1 To 6
                        lngFontSize = 30 '更新　2006/02/02 30
                    Case 7 To 8
                        lngFontSize = 23
                    Case 9 To 10
                        lngFontSize = 19
                    Case Else
                        lngFontSize = 19
                End Select
            End If

            If Not LF_FontSetup(objFont(0), pEJCD, lngFontSize) Then '19
                Exit Function
            End If
            'If Not LF_FontSetup(objFont(1), pEJCD, 25) Then '19        '2005.10.27 障害対応
            '    Exit Function
            'End If
            If Not LF_FontSetup(objFont(1), pEJCD, 23) Then '19
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 23) Then '19        
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 30) Then '19        
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strAImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = CStr(pRows("GOODSNMJ"))
                .lngCharLower = 0
                'If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                '    .lngCharHeight = 15
                'Else
                .lngCharHeight = 25
                'End If
                '.lngPositionY = 10 '更新　2006/02/02 2
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If

                .objColor = System.Drawing.Color.Black '更新 2006/02/02 white
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)

            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新　2006/02/02 17 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)
            End If
            ' ------------------------------------------------------------------


            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then

                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS053")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                'Call objAGraph.DrawImage(objItemImg, 15, 40, 170, 120) '更新　2006/02/02 3,45,125,94
                Call objAGraph.DrawImage(objItemImg, 35, 40, 190, 120) '更新　2006/07/27
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try


            ' ------------------------------------------------------------------

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                   Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then       ' 取得元項目名判定
                    .strPutStrings = Format(CLng(Trim$(pRows("SECONDKEY"))), "###0") & "円"
                Else
                    .strPutStrings = Format(CLng(Trim$(pRows("PRICE"))), "###0") & "円"
                End If
                .lngCharHeight = 30
                '                .lngCharLower = 167            '2005.10.27 障害対応
                .lngCharLower = 151   '171
                .lngPositionY = 165   '115
                .lngCharWidth = 16 '9　12 
                .objColor = System.Drawing.Color.White
                .objFont = objFont(3)
            End With
            lngSubX = LF_PutHString3(udtParam, objAGraph)

            '--- (2006.03.16) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS059")
                    objItemImg = New Bitmap(strItemImage)
                    Call objAGraph.DrawImage(objItemImg, 0, 125, 110, 50)  '左下 90　35
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.03.16) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS060")
                    objItemImg = New Bitmap(strItemImage)
                    Call objAGraph.DrawImage(objItemImg, 135, 40, 60, 30)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRows("GOODSCD")) & strFlag
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_ONSELE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strBImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strBImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    '.lngPositionY = 10
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 25
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新 2006/02/06 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------
            '    画像出力、価格出力の順序を入れ替えのため、コメントアウト。
            ''------------------------------
            '' 価格出力
            ''------------------------------
            ''With udtParam
            ''    .lngCharHeight = 30
            ''    .lngCharLower = 125
            ''    .lngPositionY = 47  '115
            ''    .objColor = System.Drawing.Color.Red
            ''    .objFont = objFont(2)
            ''End With
            ''lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS053") '更新 2006/02/02 S013JC
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                'Call objBGraph.DrawImage(objItemImg, 15, 40, 170, 120)
                Call objBGraph.DrawImage(objItemImg, 35, 40, 190, 120)
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------
            ' ----------------------------------
            ' 更新 2006/02/08 
            ' 　　　入荷待ち文字影付け対応
            ' ----------------------------------
            With udtParam
                .strPutStrings = "入荷待ち"
                .lngCharHeight = 30
                .lngCharLower = 102
                .lngPositionY = 167  '47
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = "入荷待ち"
                .lngCharHeight = 30
                .lngCharLower = 100
                .lngPositionY = 165  '47
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------

            '--- (2006.02.22) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS059")
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 0, 125, 110, 50)  '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.22) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS060")
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 135, 40, 60, 30)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------
            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT
            If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            objABitmap(0).Dispose()
            objAGraph.Dispose()
            objBBitmap(0).Dispose()
            objBGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

        End If

        LF_MakeGJGraphics_3 = True

    End Function

    ' 更新 800x480サイズ用　6分割画像作成処理
    ' 更新 2006/03/08 4分割選択時は6分割画像のＩＤを切り分ける為、引数pflag追加
    Private Function LF_MakeGJGraphics_4(ByVal pMaterialID() As String, _
                                         ByVal pRows As DataRow, _
                                         ByVal pDispOrder As Long, _
                                         ByVal pEJCD As String, _
                                         ByVal pGrpNo As Long, _
                                         ByVal pGrpSubNo As Long, _
                                         ByVal pGrpSubNo2 As Long, _
                                         ByVal pLine As Long, _
                                         ByVal pCreateMode As typCreateMode, _
                                         ByVal pFlag As String) As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        Dim objABitmap(0) As Bitmap
        Dim objAGraph As Graphics = Nothing
        Dim objAPicture As PictureBox = Nothing

        Dim strBImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objBBitmap(0) As Bitmap
        Dim objBGraph As Graphics = Nothing
        Dim objBPicture As PictureBox = Nothing

        '--- (2006.06.09) 飲み放題メニュー追加
        Dim strCImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objCBitmap(0) As Bitmap

        Dim objFont(3) As Font     '更新　2006/02/02
        Dim lngFontSize As Long
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long

        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strFlag As String = "" '更新 2006/03/08 追加
        Dim strstatus1 As String = "" '更新 2006/03/16 追加
        Dim strstatus2 As String = "" '更新 2006/03/16 追加
        Dim strstatus3 As String = ""
        Dim strstatus4 As String = ""

        strstatus1 = Trim$(pRows("SPFLG"))
        strstatus2 = Trim$(pRows("NEWFLG"))
        strstatus3 = Trim$(pRows("SPFLG"))
        strstatus4 = Trim$(pRows("NEWFLG"))

        '画像切り分けフラグを確認
        Select Case pFlag

            Case "6"    '6分割時
                strFlag = CStr(typImgPattern.Photo6)

            Case "4"    '4分割時
                strFlag = CStr(typImgPattern.Photo4)

            Case Else   '入力なしは6分割と見なす
                strFlag = CStr(typImgPattern.Photo6)

        End Select
        '以下更新部（strFlag）→元データ：”CStr(typImgPattern.Photo6)”

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics_4 = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "*.jpg"         '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "A" & "*.jpg"    '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath3, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            '4分割時以外は6分割扱い
            If pFlag = "4" Then
                If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Photo4, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            Else
                If Not LF_ExtFileCopy(Trim$(pRows("GOODSCD")), typImgPattern.Photo6, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                '----------------------------------
                '　更新 2006/02/01 TPD026追加処理
                '----------------------------------
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    .LINE = Space(5)
                    .REFID = Trim$(pRows("GOODSCD")) & strFlag
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If
        Else

            '------------------------------
            ' 描画フォント設定
            '------------------------------
            'GOODSNMJの文字数をカウント
            '文字数１〜６なら　大に
            '文字数７〜８なら　中に
            '文字数９〜なら　　小に

            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                If Len(Trim$(pRows("GOODSNMJ2"))) < 9 And _
                    Len(Trim$(pRows("GOODSNMJ"))) < 9 Then
                    lngFontSize = 23
                Else
                    lngFontSize = 19
                End If
            Else
                Select Case Len(Trim$(pRows("GOODSNMJ")))
                    Case 1 To 6
                        lngFontSize = 31 '更新　2006/02/02 30
                    Case 7 To 8
                        lngFontSize = 26 '更新  2006/06/08 21
                    Case 9 To 10
                        lngFontSize = 21 '更新  2006/06/08 19
                    Case Else
                        lngFontSize = 19
                End Select
            End If

            If Not LF_FontSetup(objFont(0), pEJCD, lngFontSize) Then '19
                Exit Function
            End If
            'If Not LF_FontSetup(objFont(1), pEJCD, 25) Then '19        '2005.10.27 障害対応
            '    Exit Function
            'End If
            If Not LF_FontSetup(objFont(1), pEJCD, 23) Then '19
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 25) Then '23→25     
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 30) Then '19        
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 通常表示画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strAImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objABitmap, objAGraph, objRect, objAPicture, strAImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = CStr(pRows("GOODSNMJ"))
                .lngCharLower = 0
                'If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                '    .lngCharHeight = 15
                'Else
                .lngCharHeight = 25
                'End If
                '.lngPositionY = 10 '更新　2006/02/02 2
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '8文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If

                .objColor = System.Drawing.Color.Black '更新 2006/02/02 white
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)

            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新　2006/02/02 17 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objAGraph, Nothing)
            End If
            ' ------------------------------------------------------------------


            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then

                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS053")
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objAGraph.DrawImage(objItemImg, 15, 40, 192, 144) '更新　2006/02/02 15,40,170,120
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ------------------------------------------------------------------

            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                If Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE Or _
                   Trim$(pRows("GROUPKBN")) = GC_ORDER_PRICE2 Then       ' 取得元項目名判定
                    .strPutStrings = Format(CLng(Trim$(pRows("SECONDKEY"))), "###0") & "円"
                Else
                    .strPutStrings = Format(CLng(Trim$(pRows("PRICE"))), "###0") & "円"
                End If
                .lngCharHeight = 30
                '                .lngCharLower = 167            '2005.10.27 障害対応
                .lngCharLower = 173   '171　151
                .lngPositionY = 187   '115  165
                .lngCharWidth = 16 '9　12 
                .objColor = System.Drawing.Color.White
                .objFont = objFont(3)
            End With
            lngSubX = LF_PutHString3(udtParam, objAGraph)

            '--- (2006.03.16) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS059")
                    objItemImg = New Bitmap(strItemImage)
                    Call objAGraph.DrawImage(objItemImg, 0, 147, 122, 55)  '左下 90　35 始点 0,125　大きさ110,50
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.03.16) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS060")
                    objItemImg = New Bitmap(strItemImage)
                    Call objAGraph.DrawImage(objItemImg, 157, 40, 66, 33)  '右上 始点 135 大きさ 60,30
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = Trim$(pRows("GOODSCD")) & strFlag
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_ONSELE
            End With
            If Not LF_SaveGroup(udtTPD020, 0, objABitmap(0), objAGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strBImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objBBitmap, objBGraph, objRect, objBPicture, strBImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    '.lngPositionY = 10
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30 '25
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新 2006/02/06 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------
            '    画像出力、価格出力の順序を入れ替えのため、コメントアウト。
            ''------------------------------
            '' 価格出力
            ''------------------------------
            ''With udtParam
            ''    .lngCharHeight = 30
            ''    .lngCharLower = 125
            ''    .lngPositionY = 47  '115
            ''    .objColor = System.Drawing.Color.Red
            ''    .objFont = objFont(2)
            ''End With
            ''lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS053") '更新 2006/02/02 S013JC
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objBGraph.DrawImage(objItemImg, 15, 40, 192, 144) '170,120
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------
            ' ----------------------------------
            ' 更新 2006/02/08 
            ' 　　　入荷待ち文字影付け対応
            ' ----------------------------------
            With udtParam
                .strPutStrings = "品切れ・入荷無し"  'MenuImage3写真
                .lngCharHeight = 30
                .lngCharLower = 12  '102
                .lngPositionY = 189  '47,167
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = "品切れ・入荷無し"   'MenuImage3写真
                .lngCharHeight = 30
                .lngCharLower = 10  '100
                .lngPositionY = 187  '47 165
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------

            '--- (2006.02.22) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS059")
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 0, 147, 122, 55)  '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.22) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS060")
                    objItemImg = New Bitmap(strItemImage)
                    Call objBGraph.DrawImage(objItemImg, 157, 40, 66, 33)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------
            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT
            If Not LF_SaveGroup(udtTPD020, 0, objBBitmap(0), objBGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            objABitmap(0).Dispose()
            objAGraph.Dispose()
            objBBitmap(0).Dispose()
            objBGraph.Dispose()

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If
        End If

        LF_MakeGJGraphics_4 = True

    End Function
    ' 更新 800x480サイズ用　6分割画像作成処理（飲み放題用）
    ' 更新 2006/03/08 4分割選択時は6分割画像のＩＤを切り分ける為、引数pflag追加
    Private Function LF_MakeGJGraphics_4_FREE(ByVal pMaterialID() As String, _
                                         ByVal pRows As DataRow, _
                                         ByVal pDispOrder As Long, _
                                         ByVal pEJCD As String, _
                                         ByVal pGrpNo As Long, _
                                         ByVal pGrpSubNo As Long, _
                                         ByVal pGrpSubNo2 As Long, _
                                         ByVal pLine As Long, _
                                         ByVal pCreateMode As typCreateMode, _
                                         ByVal pFlag As String) As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        'Dim strAImageCD(0) As String                                        ' --- 通常表示画像
        'Dim objABitmap(0) As Bitmap
        'Dim objAGraph As Graphics
        'Dim objAPicture As PictureBox

        'Dim strBImageCD(0) As String                                        ' --- 売り切れ画像
        'Dim objBBitmap(0) As Bitmap
        'Dim objBGraph As Graphics
        'Dim objBPicture As PictureBox

        '--- (2006.06.09) 飲み放題メニュー追加
        Dim strCImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objCBitmap(0) As Bitmap
        Dim objCGraph As Graphics = Nothing
        Dim objCPicture As PictureBox = Nothing
        Dim strDImageCD(0) As String                                        ' --- 売り切れ画像
        Dim objDBitmap(0) As Bitmap
        Dim objDGraph As Graphics = Nothing
        Dim objDPicture As PictureBox = Nothing

        Dim objFont(3) As Font     '更新　2006/02/02
        Dim lngFontSize As Long
        Dim objRect As RectangleF                                           ' Dummy
        Dim objItemImg As Bitmap

        Dim udtTPD020 As typTPD020 = Nothing
        Dim udtParam As typPutHString
        Dim lngSubX As Long

        Dim strItemImage As String = Nothing

        Dim strPattern As String = Nothing
        Dim strTimeStamp As String = Nothing
        Dim strFlag As String = "" '更新 2006/03/08 追加
        Dim strstatus1 As String = "" '更新 2006/03/16 追加
        Dim strstatus2 As String = "" '更新 2006/03/16 追加
        Dim strstatus3 As String = ""
        Dim strstatus4 As String = ""

        strstatus1 = Trim$(pRows("SPFLG"))
        strstatus2 = Trim$(pRows("NEWFLG"))
        strstatus3 = Trim$(pRows("SPFLG"))
        strstatus4 = Trim$(pRows("NEWFLG"))

        '画像切り分けフラグを確認
        Select Case pFlag

            Case "6"    '6分割時
                strFlag = CStr(typImgPattern.Photo6)

            Case "4"    '4分割時
                strFlag = CStr(typImgPattern.Photo4)

            Case Else   '入力なしは6分割と見なす
                strFlag = CStr(typImgPattern.Photo6)

        End Select
        '以下更新部（strFlag）→元データ：”CStr(typImgPattern.Photo6)”

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_MakeGJGraphics_4_FREE = False

        '------------------------------
        ' 生成処理要否判定
        '------------------------------
        'strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "*.jpg"         '2006.06.28 飲み放題対応
        strPattern = Trim$(pRows("GOODSCD")) & "_" & strFlag & "C" & "*.jpg"    '2006.06.28 飲み放題対応
        If Trim$(pRows("GENERATEFLG")) = GC_FALSE And _
           System.IO.Directory.GetFiles(g_udtAppConfig.strOMImgPath3, strPattern).GetLength(0) <> 0 Then

            '------------------------------
            ' 旧生成画像コピー処理
            '------------------------------
            '4分割時以外は6分割扱い
            If pFlag = "4" Then
                If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Photo4, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            Else
                If Not LF_ExtFileCopy_FREE(Trim$(pRows("GOODSCD")), typImgPattern.Photo6, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If

            If pCreateMode <> typCreateMode.RealTimeTransfar And _
               pCreateMode <> typCreateMode.SubDataTransfar Then
                '----------------------------------
                '　更新 2006/02/01 TPD026追加処理
                '----------------------------------
                ' TPD026 追加処理
                With udtTPD020
                    .MENUID = Space(3)
                    .MENUBTNID = Space(3)
                    .MENUGRPID = Space(3)
                    .MENUGRPID2 = Space(2)
                    .MENUGRPID3 = Space(2)
                    .MENULV = "1"
                    '(2006.06.28) 飲み放題対応-------
                    '.LINE = Space(5)           
                    .LINE = "F"
                    '--------------------------------
                    .REFID = Trim$(pRows("GOODSCD")) & strFlag
                    .REFGRP = Space(4)
                    .DISPORDER = Space(3)
                    .UPDID = GC_UPDID
                    .UPDYMD = Now
                End With
                If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                    Exit Function
                End If
            End If
        Else

            '---2006.06.09 張本 ADD 飲み放題生成処理追加 ---
            '------------------------------
            ' 描画フォント設定
            '------------------------------

            'GOODSNMJの文字数をカウント
            '文字数１〜６なら　大に
            '文字数７〜８なら　中に
            '文字数９〜なら　　小に
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                If Len(Trim$(pRows("GOODSNMJ2"))) < 9 And _
                    Len(Trim$(pRows("GOODSNMJ"))) < 9 Then
                    lngFontSize = 23
                Else
                    lngFontSize = 19
                End If
            Else
                Select Case Len(Trim$(pRows("GOODSNMJ")))
                    Case 1 To 6
                        lngFontSize = 31 '更新　2006/02/02 30
                    Case 7 To 8
                        lngFontSize = 26 '更新  2006/06/08 21
                    Case 9 To 10
                        lngFontSize = 21 '更新  2006/06/08 19
                    Case Else
                        lngFontSize = 19
                End Select
            End If

            If Not LF_FontSetup(objFont(0), pEJCD, lngFontSize) Then '19
                Exit Function
            End If
            'If Not LF_FontSetup(objFont(1), pEJCD, 25) Then '19        '2005.10.27 障害対応
            '    Exit Function
            'End If
            If Not LF_FontSetup(objFont(1), pEJCD, 23) Then '19
                Exit Function
            End If
            If Not LF_FontSetup(objFont(2), pEJCD, 25) Then '23→25     
                Exit Function
            End If
            If Not LF_FontSetup(objFont(3), pEJCD, 30) Then '19        
                Exit Function
            End If

            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strCImageCD(0) = pMaterialID(0)
            If Not LF_InitialPicture(objCBitmap, objCGraph, objRect, objCPicture, strCImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    '.lngPositionY = 10
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30 '25
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新 2006/02/06 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS053") '更新 2006/02/02 S013JC
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objCGraph.DrawImage(objItemImg, 15, 40, 192, 144) '170,120
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------
            ' ----------------------------------
            ' 更新 2006/06/09 
            ' 　　　飲み放題メニュー対応
            ' ----------------------------------
            With udtParam
                .strPutStrings = "飲み放題"
                .lngCharHeight = 30
                .lngCharLower = 102  '124
                .lngPositionY = 189  '47,167
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            '------------------------------
            ' 『飲み放題』の影を表示
            '------------------------------
            With udtParam
                .strPutStrings = "飲み放題"
                .lngCharHeight = 30
                .lngCharLower = 100  '122
                .lngPositionY = 187  '47 165
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objCGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------

            '--- (2006.02.22) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS059")
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 0, 147, 122, 55)  '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.22) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS060")
                    objItemImg = New Bitmap(strItemImage)
                    Call objCGraph.DrawImage(objItemImg, 157, 40, 66, 33)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------
            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            With udtTPD020
                .MENUID = Space(3)
                .MENUBTNID = Space(3)
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                '(2006.06.28) 飲み放題対応-------
                '.LINE = Space(5)
                .LINE = "F"
                '--------------------------------
                .REFID = Trim$(pRows("GOODSCD")) & strFlag
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
                .SELLKBN = GC_OOS_NONE
            End With

            If Not LF_SaveGroup(udtTPD020, 0, objCBitmap(0), objCGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------------------------------------------------------------------
            ' 売り切れ画像生成
            '------------------------------------------------------------------------------------------
            '------------------------------
            ' バッファ領域初期化
            '------------------------------
            strDImageCD(0) = pMaterialID(1)
            If Not LF_InitialPicture(objDBitmap, objDGraph, objRect, objDPicture, strDImageCD) Then
                Exit Function
            End If

            '------------------------------
            '　品名出力
            '------------------------------
            With udtParam
                .strPutStrings = Trim$(pRows("GOODSNMJ"))
                .lngCharHeight = 25
                .lngCharLower = 0
                If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                    If Len(Trim$(pRows("GOODSNMJ2"))) > 8 Then
                        .lngPositionY = 3 '8文字より多い場合
                    Else
                        .lngPositionY = 1 '8文字以下の場合
                    End If
                Else
                    '.lngPositionY = 10
                    If Len(Trim$(pRows("GOODSNMJ"))) > 6 Then
                        If Len(Trim$(pRows("GOODSNMJ"))) > 8 Then
                            .lngPositionY = 10 '6文字より多い時はy軸はこのポジション
                        Else
                            .lngPositionY = 8  '7〜8文字はy軸はこのポジション
                        End If
                    Else
                        .lngPositionY = 6 '6文字以下の場合はy軸はこのポジション
                    End If
                End If
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(0)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            ' --- (2004.02.09) タッチパネル商品名２追加 ------------------------
            If Len(Trim$(pRows("GOODSNMJ2"))) <> 0 Then
                With udtParam
                    .strPutStrings = CStr(pRows("GOODSNMJ2"))
                    .lngCharHeight = 30 '25
                    .lngCharLower = 0
                    .lngPositionY = 18 '更新 2006/02/06 10
                    .objColor = System.Drawing.Color.Black
                    .objFont = objFont(0)
                End With
                lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            End If
            ' ------------------------------------------------------------------

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------
            '    画像出力、価格出力の順序を入れ替えのため、コメントアウト。
            ''------------------------------
            '' 価格出力
            ''------------------------------
            ''With udtParam
            ''    .lngCharHeight = 30
            ''    .lngCharLower = 125
            ''    .lngPositionY = 47  '115
            ''    .objColor = System.Drawing.Color.Red
            ''    .objFont = objFont(2)
            ''End With
            ''lngSubX = LF_PutHString(udtParam, objBGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応  ------------------------------------

            '------------------------------
            ' 商品画像出力
            '------------------------------
            Try
                strItemImage = Trim$(pRows("IMAGEDATA"))
                If Len(Trim$(strItemImage)) = 0 And Len(Trim$(pRows("GROUPIMG"))) = 0 Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS053") '更新 2006/02/02 S013JC
                Else
                    If Len(Trim$(strItemImage)) <> 0 Then
                        strItemImage = GF_GetAppInfo("ITEM_PATH") & "\" & Trim$(pRows("IMAGEDATA"))
                    Else
                        strItemImage = GF_GetAppInfo("GROUP_PATH") & "\" & Trim$(pRows("GROUPIMG"))
                    End If
                End If
                objItemImg = New Bitmap(strItemImage)
                Call objDGraph.DrawImage(objItemImg, 15, 40, 192, 144) '170,120
                objItemImg.Dispose()
            Catch
                Exit Function
            End Try

            ' ↓ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------
            ' ----------------------------------
            ' 更新 2006/02/08 
            ' 　　　入荷待ち文字影付け対応
            ' ----------------------------------
            With udtParam
                .strPutStrings = "入荷待ち"
                .lngCharHeight = 30
                .lngCharLower = 102  '124
                .lngPositionY = 189  '47,167
                .objColor = System.Drawing.Color.Black
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            '------------------------------
            ' 価格出力
            '------------------------------
            With udtParam
                .strPutStrings = "入荷待ち"
                .lngCharHeight = 30
                .lngCharLower = 100  '122
                .lngPositionY = 187  '47 165
                .objColor = System.Drawing.Color.Red
                .objFont = objFont(2)
            End With
            lngSubX = LF_PutHString(udtParam, objDGraph, Nothing)
            ' ↑ 2005.10.08 品切れ→入荷待ち　変更対応 ---------------------------------

            '--- (2006.02.22) おすすめアイコン対応 -------------------------------
            Try
                If Trim$(pRows("SPFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS059")
                    objItemImg = New Bitmap(strItemImage)
                    Call objDGraph.DrawImage(objItemImg, 0, 147, 122, 55)  '左下
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------

            '--- (2006.02.22) 新作フラグ -----------------------------------------
            Try
                If Trim$(pRows("NEWFLG")) = "1" Then
                    strItemImage = GF_GetAppInfo("MATERIAL_V") & "\" & GF_GetMaterial("VGS060")
                    objItemImg = New Bitmap(strItemImage)
                    Call objDGraph.DrawImage(objItemImg, 157, 40, 66, 33)  '右上
                    objItemImg.Dispose()
                End If
            Catch
                Exit Function
            End Try
            '---------------------------------------------------------------------
            '------------------------------
            ' 生成画像情報テーブル更新処理
            '------------------------------
            udtTPD020.SELLKBN = GC_OOS_SOLDOUT_FREE
            If Not LF_SaveGroup(udtTPD020, 0, objDBitmap(0), objDGraph, pEJCD, typImageKind.ItemImage, Nothing, Nothing, DispType.VGA) Then
                Exit Function
            End If

            '------------------------------
            ' 商品マスタ／フラグ更新
            '------------------------------
            If Not LF_UpdTPM010(Trim$(pRows("GOODSCD"))) Then
                Exit Function
            End If

            objCBitmap(0).Dispose()
            objCGraph.Dispose()
            objDBitmap(0).Dispose()
            objDGraph.Dispose()


        End If
        LF_MakeGJGraphics_4_FREE = True

    End Function

    Private Function LF_PutVString(ByVal pArgs As typPutVString, ByVal pGrph As Graphics, Optional ByVal pBackImg As Bitmap = Nothing) As Long

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngX As Long
        Dim lngY As Long
        Dim lngCnt As Long
        Dim strPutChar As String = Nothing
        Dim lngByteCnt As Long
        Dim objSfmt As New StringFormat()

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_PutVString = 0
        lngX = 0
        lngY = pArgs.lngCharLower
        lngCnt = 0
        lngByteCnt = 1
        objSfmt.FormatFlags = StringFormatFlags.DirectionVertical

        '------------------------------
        ' 縦書文字列出力処理
        '------------------------------
        Try
            If Not IsNothing(pBackImg) Then
                'If pArgs.lngCharWidth = LC_TITLE_WIDTH Then                 ' グループタイトル出力時
                If pArgs.lngCharWidth = LC_TITLE_WIDTH Or _
                   pArgs.lngCharWidth = LC_TITLE2_WIDTH Or _
                    pArgs.lngCharWidth = LC_TITLE3_WIDTH Then              ' グループタイトル出力時
                    Call pGrph.DrawImage(pBackImg, pArgs.lngPositionX + (pArgs.lngCharWidth * -1), 0, pBackImg.Width, pBackImg.Height)
                    Call pGrph.DrawImage(pBackImg, pArgs.lngPositionX + (pArgs.lngCharWidth * -1) + (pArgs.lngCharWidth - pBackImg.Width), 0, pBackImg.Width, pBackImg.Height)
                Else                                                        ' 品名出力時
                    Call pGrph.DrawImage(pBackImg, pArgs.lngPositionX + (pArgs.lngCharWidth * -1), 0, pBackImg.Width, pBackImg.Height)
                End If
            End If

            Do Until lngCnt >= Len(pArgs.strPutStrings)
                With pGrph
                    .TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias
                    strPutChar = GF_MidB(pArgs.strPutStrings, lngByteCnt, 2)
                    Select Case strPutChar
                        Case "ml"
                            .DrawString(strPutChar, _
                                        pArgs.objFont, _
                                        New SolidBrush(pArgs.objColor), _
                                        pArgs.lngPositionX - pArgs.lngCharWidth, _
                                        lngY)
                        Case Else
                            .DrawString(strPutChar, _
                                        pArgs.objFont, _
                                        New SolidBrush(pArgs.objColor), _
                                        pArgs.lngPositionX - pArgs.lngCharWidth, _
                                        lngY, objSfmt)
                    End Select
                    .InterpolationMode = Drawing.Drawing2D.InterpolationMode.Bicubic
                End With
                lngY = lngY + pArgs.lngCharHeight
                lngCnt = lngCnt + 1
                lngByteCnt = lngByteCnt + 2
            Loop
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_PutVString = pArgs.lngCharWidth

    End Function

    Private Function LF_PutHString(ByVal pArgs As typPutHString, ByVal pGrph As Graphics, Optional ByVal pBackImg As Bitmap = Nothing) As Long

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngX As Long
        Dim lngY As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_PutHString = 0
        lngX = pArgs.lngCharLower
        lngY = 0

        '------------------------------
        ' 横書文字列出力処理
        '------------------------------
        Try
            If Not IsNothing(pBackImg) Then
                Call pGrph.DrawImage(pBackImg, 0, pArgs.lngPositionY, pBackImg.Width, pBackImg.Height)
            End If

            With pGrph
                .TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias
                .DrawString(pArgs.strPutStrings, _
                            pArgs.objFont, _
                            New SolidBrush(pArgs.objColor), _
                            lngX, _
                            pArgs.lngPositionY)
                .InterpolationMode = Drawing.Drawing2D.InterpolationMode.Bicubic
            End With
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_PutHString = pArgs.lngCharHeight

    End Function

    Private Function LF_PutHString2(ByVal pArgs As typPutHString, _
                                    ByVal pGrph As Graphics, _
                                    Optional ByVal pBackImg As Bitmap = Nothing, _
                                    Optional ByVal pDispType As DispType = DispType.XGA) As Long

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngX As Long
        Dim lngY As Long
        Dim lngCnt As Long
        Dim strPutChar As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_PutHString2 = 0
        Select Case pDispType
            Case DispType.XGA
                lngX = (8 - Len(pArgs.strPutStrings)) * 8
            Case DispType.SVGA
                lngX = (8 - Len(pArgs.strPutStrings)) * 6
                '更新 2006/03/10 8インチ対応
            Case Else
                lngX = (8 - Len(pArgs.strPutStrings)) * 4
        End Select
        lngY = 0

        '------------------------------
        ' 横書文字列出力処理
        '------------------------------
        Try
            If Not IsNothing(pBackImg) Then
                Call pGrph.DrawImage(pBackImg, 0, pArgs.lngPositionY, pBackImg.Width, pBackImg.Height)
            End If

            lngCnt = 0
            While lngCnt < Len(pArgs.strPutStrings)
                strPutChar = GF_MidB(pArgs.strPutStrings, (lngCnt * 2) + 1, 2)
                With pGrph
                    .TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias
                    .DrawString(strPutChar, _
                                pArgs.objFont, _
                                New SolidBrush(pArgs.objColor), _
                                lngX, _
                                pArgs.lngPositionY)
                    .InterpolationMode = Drawing.Drawing2D.InterpolationMode.Bicubic
                End With
                'lngX = lngX + 16
                Select Case pDispType
                    Case DispType.XGA
                        lngX = lngX + 16
                    Case DispType.SVGA
                        lngX = lngX + 12
                        '更新 2006/03/10 8インチ対応
                    Case Else
                        lngX = lngX + 8
                End Select
                lngCnt = lngCnt + 1
            End While
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_PutHString2 = pArgs.lngCharHeight

    End Function

    ' --- (2004.02.19) 追加 S ---
    Private Function LF_PutHString3(ByVal pArgs As typPutHString, ByVal pGrph As Graphics) As Long

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim lngCCnt As Long
        Dim lngX As Long
        Dim lngY As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_PutHString3 = 0
        lngX = pArgs.lngCharLower
        lngY = pArgs.lngPositionY

        Try
            For lngCCnt = 0 To Len(pArgs.strPutStrings) - 1
                With pGrph
                    .TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias
                    .DrawString(Mid$(pArgs.strPutStrings, (Len(pArgs.strPutStrings) - lngCCnt), 1), _
                                pArgs.objFont, _
                                New SolidBrush(pArgs.objColor), _
                                lngX, _
                                pArgs.lngPositionY)
                    .InterpolationMode = Drawing.Drawing2D.InterpolationMode.Bicubic
                End With
                lngX = lngX - pArgs.lngCharWidth
            Next
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_PutHString3 = pArgs.lngCharHeight

    End Function
    ' --- (2004.02.19) 追加 E ---

    Private Function LF_GetMenuImgNm(ByVal pArgs As typTPD020, _
                                     ByVal pTime As String, _
                                     Optional ByVal pDisptype As DispType = DispType.XGA) As String

        Dim strName As String = Nothing
        Dim strPath As String = Nothing

        Select Case pDisptype
            Case DispType.XGA
                strPath = g_udtAppConfig.strNMImgPath
            Case DispType.SVGA
                strPath = g_udtAppConfig.strNMImgPath2
                '更新 2006/03/10 ８インチ対応
            Case Else
                strPath = g_udtAppConfig.strNMImgPath3
        End Select

        strName = strPath & "\" & _
                  pArgs.MENUID & "_" & _
                  pArgs.MENUBTNID & "_" & _
                  pArgs.MENUGRPID & "_" & _
                  pArgs.MENUGRPID2 & "_" & _
                  pArgs.MENUGRPID3 & "_" & _
                  pArgs.MENULV & "_" & _
                  pArgs.LINE & "_" & _
                  pArgs.DISPORDER & "_" & _
                  pArgs.SELLKBN & "_" & _
                  pTime & _
                  ".jpg"
        LF_GetMenuImgNm = strName

    End Function

    Private Function LF_GetItemImgNm(ByVal pArgs As typTPD020, _
                                     ByVal pTime As String, _
                                     Optional ByVal pDisptype As DispType = DispType.XGA) As String

        Dim strName As String = Nothing
        Dim strPath As String = Nothing

        Select Case pDisptype
            Case DispType.XGA
                strPath = g_udtAppConfig.strNMImgPath
            Case DispType.SVGA
                strPath = g_udtAppConfig.strNMImgPath2
                '更新 2006/03/10 8インチ対応
            Case Else
                strPath = g_udtAppConfig.strNMImgPath3
        End Select

        strName = strPath & "\" & _
                  Mid$(pArgs.REFID, 1, 4) & "_" & Mid$(pArgs.REFID, 5, 1) & _
                  pArgs.SELLKBN & _
                  pTime & _
                  ".jpg"
        LF_GetItemImgNm = strName

    End Function

    Private Function LF_GetGenrImgNm(ByVal pArgs As typTPD020, _
                                     ByVal pTime As String, _
                                     Optional ByVal pDisptype As DispType = DispType.XGA) As String

        Dim strName As String = Nothing
        Dim strPath As String = Nothing

        Select Case pDisptype
            Case DispType.XGA
                strPath = g_udtAppConfig.strNMImgPath
            Case DispType.SVGA
                strPath = g_udtAppConfig.strNMImgPath2
                '更新 2006/03/10 ８インチ対応
            Case Else
                strPath = g_udtAppConfig.strNMImgPath3
        End Select
        strName = strPath & "\" & _
                  pArgs.REFGRP & "_" & CStr(typImgPattern.Tanzaku) & _
                  pArgs.SELLKBN & _
                  pTime & _
                  ".jpg"
        LF_GetGenrImgNm = strName

    End Function

    Private Enum typImageKind
        GroupImage = 0
        ItemImage = 1
        GenrImage = 2
    End Enum

    'Private Function LF_SaveGroup(ByVal pArgs As typTPD020, _
    '                              ByVal pXPos As Long, _
    '                              ByVal pBaseBitmap As Bitmap, _
    '                              ByVal pGrph As Graphics, _
    '                              ByVal pEJCD As String, _
    '                              ByVal pItemKind As typImageKind, _
    '                              Optional ByVal pEndBitmap As Bitmap = Nothing, _
    '                              Optional ByVal pItemCnt As Long = 0) As Boolean
    Private Function LF_SaveGroup(ByVal pArgs As typTPD020, _
                                  ByVal pXPos As Long, _
                                  ByVal pBaseBitmap As Bitmap, _
                                  ByVal pGrph As Graphics, _
                                  ByVal pEJCD As String, _
                                  ByVal pItemKind As typImageKind, _
                                  Optional ByVal pEndBitmap As Bitmap = Nothing, _
                                  Optional ByVal pItemCnt As Long = 0, _
                                  Optional ByVal pDispType As DispType = DispType.XGA) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim saveName As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_SaveGroup = False

        '------------------------------
        ' 終了バナー出力
        '------------------------------
        If Not IsNothing(pEndBitmap) Then
            pXPos = pXPos - 3
            pGrph.DrawImage(pEndBitmap, pXPos, 0, pEndBitmap.Width, pEndBitmap.Height)
        End If

        '------------------------------
        ' エンコード方式の指定
        '------------------------------
        Dim myEncoderParameters As New System.Drawing.Imaging.EncoderParameters(1)
        Dim myEncoderParameter As New System.Drawing.Imaging.EncoderParameter(System.Drawing.Imaging.Encoder.Quality, 90)
        myEncoderParameters.Param(0) = myEncoderParameter

        '------------------------------
        ' 保存形式の指定
        '------------------------------
        Dim myImageCodecInfo As System.Drawing.Imaging.ImageCodecInfo
        myImageCodecInfo = GF_GetEncoderInfo("image/jpeg")
        Dim ext As String = Nothing = myImageCodecInfo.FilenameExtension.Split(";"c)(0)
        ext = System.IO.Path.GetExtension(ext).ToLower()

        '------------------------------
        ' 保存対象領域のトリミング
        '------------------------------
        Dim objSaveBitm As New Bitmap((pBaseBitmap.Width - pXPos), pBaseBitmap.Height, System.Drawing.Imaging.PixelFormat.Format32bppRgb)
        Dim objSaveGrph As Graphics = Graphics.FromImage(objSaveBitm)
        Dim objSaveRect As New Rectangle(0, 0, (pBaseBitmap.Width - pXPos), pBaseBitmap.Height)
        objSaveGrph.DrawImage(pBaseBitmap, objSaveRect, pXPos, 0, (pBaseBitmap.Width - pXPos), pBaseBitmap.Height, GraphicsUnit.Pixel)

        '------------------------------
        ' 保存処理
        '------------------------------
        Select Case pItemKind
            Case typImageKind.GroupImage                                    ' グループ画像ファイル名取得
                saveName = System.IO.Path.ChangeExtension(LF_GetMenuImgNm(pArgs, L_strTime, pDispType), ext)

            Case typImageKind.ItemImage                                     ' 単品画像ファイル名取得
                ''2006.06.28　飲み放題対応　削除
                ''-- (2006.04.25) 飲み放題対応 判定追加
                'If pArgs.SELLKBN = GC_OOS_NONE And L_FreeMode = True Then
                '    If LF_GetImgDB(pArgs, strSerial) Then
                '        saveName = System.IO.Path.ChangeExtension(LF_GetItemImgNm(pArgs, strSerial, pDispType), ext)
                '    Else
                '        saveName = System.IO.Path.ChangeExtension(LF_GetItemImgNm(pArgs, L_strTime, pDispType), ext)
                '    End If
                'Else
                '    saveName = System.IO.Path.ChangeExtension(LF_GetItemImgNm(pArgs, L_strTime, pDispType), ext)
                'End If
                saveName = System.IO.Path.ChangeExtension(LF_GetItemImgNm(pArgs, L_strTime, pDispType), ext)

            Case typImageKind.GenrImage
                saveName = System.IO.Path.ChangeExtension(LF_GetGenrImgNm(pArgs, L_strTime, pDispType), ext)

            Case Else
                Exit Function
        End Select
        objSaveBitm.Save(saveName, myImageCodecInfo, myEncoderParameters)
        objSaveBitm.Dispose()

        '------------------------------
        ' ＤＢ格納処理
        '------------------------------
        '--- (2006.04.07) 飲み放題メニュー追加により、判定方法変更  (2006.06.28)　飲み放題対応
        If pArgs.SELLKBN <> GC_OOS_SOLDOUT Then
            'If pArgs.SELLKBN <> GC_OOS_SOLDOUT And L_FreeMode = False Then
            If Not LF_InsertImgDB(pArgs, L_strTime, pDispType) Then
                Exit Function
            End If
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_SaveGroup = True

    End Function

    Private Function LF_GetImgDB(ByVal pArgs As typTPD020, ByRef pstrSerial As String) As Boolean
        '-- 2006.04.25 新規作成
        '   飲み放題用画像は、TPD020からシリアルを取得して作成する

        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRow As DataRow = Nothing

        LF_GetImgDB = False

        With pArgs
            strSQL = ""
            strSQL = strSQL & "SELECT IMGSERIAL"
            strSQL = strSQL & "  FROM TPD020"
            strSQL = strSQL & " WHERE MENUID = '" & .MENUID & "'"
            strSQL = strSQL & "   AND MENUBTNID = '" & .MENUBTNID & "'"
            strSQL = strSQL & "   AND MENUGRPID = '" & .MENUGRPID & "'"
            strSQL = strSQL & "   AND MENUGRPID2 = '" & .MENUGRPID2 & "'"
            strSQL = strSQL & "   AND MENUGRPID3 = '" & .MENUGRPID3 & "'"
            strSQL = strSQL & "   AND MENULV = '" & .MENULV & "'"
            strSQL = strSQL & "   AND LINE = '" & .LINE & "'"
            strSQL = strSQL & "   AND REFID = '" & IIf(Len(Trim$(.REFID)) <> 0, .REFID, Space(5)) & "'"
            strSQL = strSQL & "   AND REFGRP = '" & IIf(Len(Trim$(.REFGRP)) <> 0, .REFGRP, Space(4)) & "'"
            strSQL = strSQL & "   AND DISPORDER = '" & .DISPORDER & "'"
        End With

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        If objData.Tables("com").Rows.Count > 0 Then
            If Not GF_GetRows(objData, 0, objRow) Then
                Exit Function
            End If
            pstrSerial = Trim$(objRow("IMGSERIAL"))
        Else
            If Not LF_InsertImgDB(pArgs, L_strTime) Then
                Exit Function
            End If
            pstrSerial = L_strTime

        End If

        LF_GetImgDB = True

    End Function

    Private Function LF_InsertImgDB(ByVal pArgs As typTPD020, _
                                    ByVal pTime As String, _
                                    Optional ByVal pDisptype As DispType = DispType.XGA) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim strTBLNM As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_InsertImgDB = False

        '------------------------------
        ' 入出力テーブル切り替え
        '------------------------------
        Select Case pDisptype
            Case DispType.XGA
                strTBLNM = "TPD020"
            Case DispType.SVGA
                strTBLNM = "TPD025"
                '更新 2006/03/10 ８インチ対応
            Case Else
                strTBLNM = "TPD026"
        End Select

        With pArgs
            strSQL = ""
            strSQL = strSQL & "SELECT COUNT(*) AS CNT"
            strSQL = strSQL & "  FROM " & strTBLNM
            strSQL = strSQL & " WHERE " & strTBLNM & ".MENUID     = '" & .MENUID & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".MENUBTNID  = '" & .MENUBTNID & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".MENUGRPID  = '" & .MENUGRPID & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".MENUGRPID2 = '" & .MENUGRPID2 & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".MENUGRPID3 = '" & IIf(Len(Trim$(.MENUGRPID3)) = 0, Space(2), .MENUGRPID3) & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".MENULV     = '" & .MENULV & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".LINE       = '" & .LINE & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".REFID      = '" & IIf(Len(Trim$(.REFID)) <> 0, .REFID, Space(5)) & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".REFGRP     = '" & IIf(Len(Trim$(.REFGRP)) <> 0, .REFGRP, Space(4)) & "'"
            strSQL = strSQL & "   AND " & strTBLNM & ".DISPORDER  = '" & .DISPORDER & "'"
        End With
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If
        If objData.Tables("com").Rows.Count = 0 Then
            Exit Function
        End If
        If Not GF_GetRows(objData, 0, objRows) Then
            Exit Function
        End If

        '------------------------------
        ' 更新ＳＱＬ文生成
        '------------------------------
        If Trim$(objRows("CNT")) <> "0" Then
            'LF_InsertImgDB = True
            'Exit Function
            With pArgs
                strSQL = ""
                strSQL = strSQL & "UPDATE " & strTBLNM
                strSQL = strSQL & "   SET " & strTBLNM & ".IMGSERIAL  = " & pTime & ","
                strSQL = strSQL & "       " & strTBLNM & ".UPDID      = '" & .UPDID & "',"
                strSQL = strSQL & "       " & strTBLNM & ".UPDYMD     = '" & .UPDYMD & "'"
                strSQL = strSQL & " WHERE " & strTBLNM & ".MENUID     = '" & .MENUID & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".MENUBTNID  = '" & .MENUBTNID & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".MENUGRPID  = '" & .MENUGRPID & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".MENUGRPID2 = '" & .MENUGRPID2 & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".MENUGRPID3 = '" & IIf(Len(Trim$(.MENUGRPID3)) = 0, Space(2), .MENUGRPID3) & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".MENULV     = '" & .MENULV & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".LINE       = '" & .LINE & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".REFID      = '" & IIf(Len(Trim$(.REFID)) <> 0, .REFID, Space(5)) & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".REFGRP     = '" & IIf(Len(Trim$(.REFGRP)) <> 0, .REFGRP, Space(4)) & "'"
                strSQL = strSQL & "   AND " & strTBLNM & ".DISPORDER  = '" & .DISPORDER & "'"
            End With
        Else
            With pArgs
                strSQL = ""
                strSQL = strSQL & "INSERT INTO " & strTBLNM & " VALUES("
                strSQL = strSQL & "'" & .MENUID & "',"
                strSQL = strSQL & "'" & .MENUBTNID & "',"
                strSQL = strSQL & "'" & .MENUGRPID & "',"
                strSQL = strSQL & "'" & .MENUGRPID2 & "',"
                strSQL = strSQL & "'" & IIf(Len(Trim$(.MENUGRPID3)) = 0, Space(2), .MENUGRPID3) & "',"
                strSQL = strSQL & "'" & .MENULV & "',"
                strSQL = strSQL & "'" & .LINE & "',"
                strSQL = strSQL & "'" & IIf(Len(Trim$(.REFID)) <> 0, .REFID, Space(5)) & "',"
                strSQL = strSQL & "'" & IIf(Len(Trim$(.REFGRP)) <> 0, .REFGRP, Space(4)) & "',"
                strSQL = strSQL & "'" & .DISPORDER & "',"
                strSQL = strSQL & pTime & ","
                strSQL = strSQL & "'" & .UPDID & "',"
                strSQL = strSQL & "'" & .UPDYMD & "')"
            End With

        End If
        If Not GF_UpdData(strSQL) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_InsertImgDB = True

    End Function

    Private Function LF_FontSetup(ByRef pFont As Font, ByVal pEJKBN As String, ByVal pFontSize As Long) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_FontSetup = False

        '------------------------------
        ' システム管理マスタ取得
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM040.JFONT"
        strSQL = strSQL & "  FROM TPM040"
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If
        If objData.Tables("com").Rows.Count = 0 Then
            Exit Function
        End If
        If Not GF_GetRows(objData, 0, objRows) Then
            Exit Function
        End If
        pFont = New Font(Trim$(objRows("JFONT")), pFontSize)

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_FontSetup = True

    End Function

    ' 各種ボタン等の素材画像を生成する
    Private Function LF_CreateMaterials(ByVal pStatus As CNL1810, _
                                        ByVal pCreateMode As typCreateMode, _
                                        Optional ByVal pOMenuID As String = "", _
                                        Optional ByVal pRMenuID As String = "") As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim udtVArgs As typPutVString                                       ' 縦書き文字列出力処理引数
        Dim udtVDummy As typPutVString = Nothing                                      ' 縦書き文字列出力処理引数
        Dim udtHArgs As typPutHString                                       ' 横書き文字列出力処理引数
        Dim udtHDummy As typPutHString = Nothing                                      ' 横書き文字列出力処理引数
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtMHArgs() As typPutHString                                    ' 横書き文字列出力処理引数(複数行描画処理向け)
        Dim objFont2 As Font = Nothing
        Dim strGuide As String = Nothing
        Dim strWork(2) As String

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMaterials = False

        '------------------------------
        ' 『戻る』ボタン(日本語)
        '------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
        '    Exit Function
        'End If
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "戻る"
            .lngCharLower = 30
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 9           '2005.10.24
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C001JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『確認・取消』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "これまでの"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "ご注文"
            .lngCharLower = 43
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 27
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("C002JC", udtMHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        ReDim udtMHArgs(3)
        With udtMHArgs(0)
            .strPutStrings = "注文／訂正"
            .lngCharLower = 2
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        ' ガイダンス文字列取得
        strGuide = LF_GetGuide("ETCMSG", "I01") & Space(100)                ' 後半のスペースは、指定文字列が短い場合のダミースペース
        strWork(0) = GF_MidB(strGuide, 1, 12)
        strWork(1) = GF_MidB(strGuide, 13, 12)
        strWork(2) = GF_MidB(strGuide, 25, 12)

        If Not LF_FontSetup(objFont2, GC_EJKBN_J, 16) Then
            Exit Function
        End If
        With udtMHArgs(1)
            .strPutStrings = strWork(0)
            .lngCharLower = 5
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 35
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(2)
            .strPutStrings = strWork(1)
            .lngCharLower = 5
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 48
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(3)
            .strPutStrings = strWork(2)
            .lngCharLower = 5
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 61
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("C003JC", udtMHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 呼出ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "呼　出"
            .lngCharLower = 12
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("C006JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 和英切替ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "お会計"
            .lngCharLower = 12
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("C007JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 前ページ遷移ボタン(日本語)
        '------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
        '    Exit Function
        'End If
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "前頁"
            .lngCharLower = 40
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 7      '2005.10.24
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C008JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 次ページ遷移ボタン(日本語)
        '------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
        '    Exit Function
        'End If
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次頁"
            .lngCharLower = 32
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 7      '2005.10.24
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C009JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『増やす』ボタン(日本語)
        '------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 16) Then
        '    Exit Function
        'End If
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "増やす"
            '            .lngCharLower = 9
            .lngCharLower = 7
            .objFont = objFont
            .lngCharWidth = 0
            '            .lngPositionY = 4      '2005.10.24
            .lngPositionY = 7
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C011UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『減らす』ボタン(日本語)
        '------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 16) Then
        '    Exit Function
        'End If
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "減らす"
            '            .lngCharLower = 9
            .lngCharLower = 7
            .objFont = objFont
            .lngCharWidth = 0
            '            .lngPositionY = 4      '2005.10.24
            .lngPositionY = 7
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C012UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - いいえ』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "いいえ"
            .lngCharLower = 27
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 9
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C013UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - はい』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "はい"
            .lngCharLower = 9
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 9
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("C014UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - はい』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "ご　案　内"
            .lngCharLower = 50
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S005JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 詳細画面遷移ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtVArgs
            .strPutStrings = "詳細"
            .lngCharLower = 7
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionX = 11
            .lngCharHeight = 18
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S004UC", udtVArgs, udtHDummy)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 詳細画面遷移ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtVArgs
            .strPutStrings = "減らす"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionX = 11
            .lngCharHeight = 18
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S003UC", udtVArgs, udtHDummy)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - はい』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 26) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "詳細"
            .lngCharLower = 0
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 2
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S022JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' お会計確認画面「はい」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 26) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "はい"
            .lngCharLower = 90
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("S024JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' お会計確認画面「いいえ」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 26) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "いいえ"
            .lngCharLower = 75
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("S025JC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ' --- (2003.11.26) ボタン素材追加 ----------------------------------
        '------------------------------
        ' 注文確認画面「はい」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注文する"
            .lngCharLower = 65
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S030UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 注文確認画面「いいえ」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            '.strPutStrings = "注文しない"
            .strPutStrings = "　戻　る　"
            .lngCharLower = 60
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S031UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
        ' ------------------------------------------------------------------

        ' --- (2003.11.28) ボタン素材追加 ----------------------------------
        '------------------------------
        ' 注文履歴画面「履歴削除」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "履歴を消去する"
            .lngCharLower = 20                  '-- (2006.03.03) Template変更
            '.lngCharLower = 10
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S032UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 注文確認画面「全削除」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            '.strPutStrings = "注文を取り消す"
            .strPutStrings = "注 文 取 消 し"
            .lngCharLower = 35
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S033UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
        ' ------------------------------------------------------------------

        ' --- (2003.12.03) ボタン素材追加 ----------------------------------
        '------------------------------
        ' 注文履歴画面「戻る」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "戻　る"
            .lngCharLower = 65          '--- (2006.02.23) Template変更に伴い、表示位置調整
            '.strPutStrings = "戻る"
            '.lngCharLower = 90
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S034UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 注文催促画面「閉じる」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 26) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "メニューに戻る"
            .lngCharLower = 18
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("S035UC", udtVDummy, udtHArgs)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
        ' ------------------------------------------------------------------

        ' --- (2004.07.21) ボタン素材追加 ----------------------------------
        '------------------------------
        ' 厨房メッセージ画面「戻る」ボタン
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 26) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "戻　る"
            .lngCharLower = 75  '18
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("S040UC", udtVDummy, udtHArgs)
        'pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
        ' ------------------------------------------------------------------

        ' --- (2005.07.11) ボタン素材追加 ----------------------------------
        '------------------------------
        ' 『注文』ボタン(日本語)
        '------------------------------
        '--- (2006.02.13) GIF画像に変更 -----------------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 34) Then
        '    Exit Function
        'End If
        'ReDim udtMHArgs(2)
        'With udtMHArgs(0)
        '    .strPutStrings = "確認／変更"
        '    .lngCharLower = 20
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 30
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        'If Not LF_FontSetup(objFont2, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtMHArgs(1)
        '    .strPutStrings = "このボタンを押し"
        '    .lngCharLower = 11
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 80
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'With udtMHArgs(2)
        '    .strPutStrings = "注文してください"
        '    .lngCharLower = 11
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 110
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_2("S100UC", udtMHArgs)
        '------------------------------------------------------------------------------------

        '------------------------------
        ' 『確認・取消』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "これまで"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 30
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "のご注文"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 57
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("S101UC", udtMHArgs)

        '------------------------------
        ' 注文内容表示『取消』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "取消"
            .lngCharLower = 2
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 2
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S102UC", udtVDummy, udtHArgs)
        ' ------------------------------------------------------------------

        ' --- (2005.10.05) ボタン素材追加 ----------------------------------
        '------------------------------
        ' 『注文』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "注 文"
            .lngCharLower = 20
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 5
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        If Not LF_FontSetup(objFont2, GC_EJKBN_J, 10) Then
            Exit Function
        End If
        With udtMHArgs(1)
            .strPutStrings = "このボタンを押し"
            .lngCharLower = 3
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 25
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(2)
            .strPutStrings = "注文してください"
            .lngCharLower = 3
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 35
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("S103UC", udtMHArgs)

        '------------------------------
        ' 『これまでのご注文』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "これまで"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 5
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "のご注文"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 25
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("S104UC", udtMHArgs)

        '------------------------------
        ' 厨房用画面ボタン（白）
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 16) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "厨房用画面"
            .lngCharLower = 2
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S105UC", udtVDummy, udtHArgs)
        '------------------------------
        ' 厨房用画面ボタン（赤）
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 16) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "厨房用画面"
            .lngCharLower = 2
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S108UC", udtVDummy, udtHArgs)

        '------------------------------
        ' 『従業員』ボタン(日本語)
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "従業員"
            .lngCharLower = 15
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 7
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        With udtMHArgs(1)
            .strPutStrings = "ボタン"
            .lngCharLower = 15
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 27
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_2("S106UC", udtMHArgs)
        ' ------------------------------------------------------------------

        '--- (2006.01.25) ボタン新規作成 ----------------------------------
        '--------------------------------------
        ' 注文確認画面「次の商品を選ぶ」ボタン
        '--------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選ぶ"
            .lngCharLower = 35
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S041UC", udtVDummy, udtHArgs)

        '--------------------------------------
        ' 『混雑中』ショートカットなし時
        '--------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 34) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "混 雑 中"
            .lngCharLower = 37
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 30
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        If Not LF_FontSetup(objFont2, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtMHArgs(1)
            .strPutStrings = "注文はしばらく"
            .lngCharLower = 19
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 80
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(2)
            .strPutStrings = "お待ちください"
            .lngCharLower = 19
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 110
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("S110UC", udtMHArgs)

        '--------------------------------------
        ' 『混雑中』ショートカットあり時
        '--------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "混雑中"
            .lngCharLower = 17
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 5
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        If Not LF_FontSetup(objFont2, GC_EJKBN_J, 10) Then
            Exit Function
        End If
        With udtMHArgs(1)
            .strPutStrings = "注文はしばらく"
            .lngCharLower = 8
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 25
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(2)
            .strPutStrings = "お待ちください"
            .lngCharLower = 8
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 35
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("S109UC", udtMHArgs)

        '--------------------------------------
        ' 『詳細』広告画像からの注文
        '--------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "詳しく！"
        '    .lngCharLower = 13
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 11
        '    .lngCharHeight = 0
        '    '.objColor = System.Drawing.Color.Black
        '    .objColor = System.Drawing.Color.DarkBlue
        '    '.objColor = System.Drawing.Color.MediumBlue
        'End With
        'Call LS_CreateMaterial_1("C016JC", udtVDummy, udtHArgs)

        '----------------------------------------------------------------------------

        '--- (2006.02.02) 注文ボタンGIF画像 -----------------------------------------
        'Dim strFileName As String
        'strFileName = LF_GetMaterial("G001IF", "")
        'System.IO.File.Copy(GF_GetAppInfo("MATERIAL_V") & "\" & strFileName, g_udtAppConfig.strNMImgPath & "\" & strFileName, True)
        '----------------------------------------------------------------------------

        '--- (2006.02.23) -----------------------------------------------------------
        '------------------------------
        ' 「割勘」ボタン（大）
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "割り勘"
            .lngCharLower = 65
            '.lngCharLower = 75     '「割勘」の時
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S044UC", udtVDummy, udtHArgs)
        '------------------------------
        ' 「割勘」ボタン（小）
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "割り勘"
            .lngCharLower = 19
            '.lngCharLower = 75     '「割勘」の時
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 22
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("S045UC", udtVDummy, udtHArgs)
        '----------------------------------------------------------------------------

        '------------------------------
        ' メニューボタン
        '------------------------------
        strSQL = ""
        If pCreateMode = typCreateMode.RealTimeTransfar Then
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            strSQL = strSQL & " WHERE TPM060.MENUID  = '" & pOMenuID & "'"
            strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"
        Else
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            strSQL = strSQL & " WHERE TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"
        End If
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If
        lngCnt = 0
        While lngCnt < objData.Tables("com").Rows.Count
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            '---(2005.10.05) 魚がし修正対応----------------------------------
            '------------------------------
            ' メニューボタン(日本語)
            '------------------------------
            Dim lngFontSize As Long
            Dim lngPosY As Long
            Select Case Len(Trim$(objRows("MENUGRPNM")))
                '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更

                '-- (2006.01.23) 魚がしサイズから標準サイズに変更 -------------------
                'Case 1 To 10
                '        lngFontSize = 26
                '    Case 11 To 18
                '        lngFontSize = 21
                '    Case Else
                '        lngFontSize = 21
                '--------------------------------------------------------------------
            Case 1 To 5
                    lngFontSize = 30
                    lngPosY = 8
                Case 6 To 7
                    lngFontSize = 26
                    lngPosY = 10
                Case 8 To 9
                    lngFontSize = 21
                    lngPosY = 13
                Case Else
                    lngFontSize = 21
                    lngPosY = 3
            End Select
            ''If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            If Not LF_FontSetup(objFont, GC_EJKBN_J, lngFontSize) Then
                Exit Function
            End If
            Erase udtMHArgs
            ReDim udtMHArgs(1)

            '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            '-- (2006.01.23) 魚がしサイズから標準サイズに戻す ---------------------------------
            'Dim intStart As Integer
            'Dim intEnd As Integer

            'Select Case Len(Trim$(objRows("MENUGRPNM")))
            '    Case 1 To 10
            '        intEnd = 5
            '        intStart = 6
            '        lngPosY = 22
            '    Case 11 To 18
            '        intEnd = 9
            '        intStart = 10
            '        lngPosY = 24
            'End Select
            'With udtMHArgs(0)
            '    .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), 1, intEnd)
            '    .lngCharLower = 1
            '    .objFont = objFont
            '    .lngCharWidth = 0
            '    .lngPositionY = 3
            '    .lngCharHeight = 0
            '    .objColor = System.Drawing.Color.White
            'End With
            'With udtMHArgs(1)
            '    .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intStart, Len(Trim$(objRows("MENUGRPNM"))))
            '    .lngCharLower = 1
            '    .objFont = objFont
            '    .lngCharWidth = 0
            '    .lngPositionY = lngPosY
            '    .lngCharHeight = 0
            '    .objColor = System.Drawing.Color.White
            'End With

            With udtMHArgs(0)
            ' 2014-05-12 2バイト文字制限解除
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), 1, 9)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), 1, 9)
                .lngCharLower = 1
                .objFont = objFont
                .lngCharWidth = 0
                '-- (2006.01.23) 表示文字サイズ変更 ------------------------
                .lngPositionY = lngPosY
                '.lngPositionY = 15
                '-----------------------------------------------------------
                .lngCharHeight = 0
                .objColor = System.Drawing.Color.White
            End With
            With udtMHArgs(1)
            ' 2014-05-12 2バイト文字制限解除
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), 10, 9)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), 10, 9)
                .lngCharLower = 1
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = 20          '--(2006.01.23) 表示文字サイズ変更
                '.lngPositionY = 35
                .lngCharHeight = 0
                .objColor = System.Drawing.Color.White
            End With
            '----------------------------------------------------------------------------------
            '-- ↑ 2005.11.16 メニュー文字サイズ、1行の文字数変更

            If pCreateMode = typCreateMode.RealTimeTransfar Then
                '--- (2006.02.14) 定額メニュー対応 ---------------------------------------------------------------------
                Call LS_CreateMaterial_2("C010UC", udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J)
                'If Trim$(objRows("PRICETYPE")) = "0" Then
                '    Call LS_CreateMaterial_2("C010UC", udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J)
                'Else
                '    With udtMHArgs(0)
                '        .objColor = System.Drawing.Color.Black
                '    End With
                '    With udtMHArgs(1)
                '        .objColor = System.Drawing.Color.Black
                '    End With
                '    Call LS_CreateMaterial_2("C011YU", udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J)
                'End If
                '-------------------------------------------------------------------------------------------------------
                With udtMHArgs(0)
                    .objColor = System.Drawing.Color.DarkRed
                End With
                With udtMHArgs(1)
                    .objColor = System.Drawing.Color.DarkRed
                End With

                '--- 選択中メニューボタン用
                Call LS_CreateMaterial_2("C010YU", udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J)
            Else
                Call LS_CreateMaterial_2("C010UC", udtMHArgs, Trim$(objRows("MENUID")) & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J)
                With udtMHArgs(0)
                    .objColor = System.Drawing.Color.DarkRed
                End With
                With udtMHArgs(1)
                    .objColor = System.Drawing.Color.DarkRed
                End With

                '--- 選択中メニューボタン用
                Call LS_CreateMaterial_2("C010YU", udtMHArgs, Trim$(objRows("MENUID")) & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J)
            End If
            '--------------------------------------------------------------------
            lngCnt = lngCnt + 1
        End While
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 参照画像コピー処理
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM070.FILENM"
        strSQL = strSQL & "  FROM TPM070,"
        strSQL = strSQL & "       TPM040"
        strSQL = strSQL & " WHERE TPM070.IMAGESET  = TPM040.IMAGESET"
        strSQL = strSQL & "   AND TPM070.TRANSKIND = '1'"
        objData = New DataSet()
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If
        lngCnt = 0
        While lngCnt < objData.Tables("com").Rows.Count
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            Try
                If System.IO.File.Exists(g_udtAppConfig.strNMImgPath & "\" & Trim$(objRows("FILENM"))) = False And _
                   System.IO.File.Exists(GF_GetAppInfo("MATERIAL_V") & "\" & Trim$(objRows("FILENM"))) = True Then
                    System.IO.File.Copy(GF_GetAppInfo("MATERIAL_V") & "\" & _
                                        Trim$(objRows("FILENM")), _
                                        g_udtAppConfig.strNMImgPath & "\" & _
                                        Trim$(objRows("FILENM")))
                End If
            Catch
                Exit Function
            End Try

            lngCnt = lngCnt + 1
        End While
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMaterials = True
    End Function


    '--- 2006.10.20 12インチ対応
    Private Function LF_CreateMaterials_2(ByVal pStatus As CNL1810, _
                                        ByVal pCreateMode As typCreateMode, _
                                        Optional ByVal pOMenuID As String = "", _
                                        Optional ByVal pRMenuID As String = "") As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim lngFontSize As Long
        Dim lngPosY As Long
        Dim udtVDummy As typPutVString = Nothing                                      ' 縦書き文字列出力処理引数
        Dim udtHArgs As typPutHString                                       ' 横書き文字列出力処理引数
        Dim strSQL As String = Nothing
        Dim strSQL2 As String = Nothing                                               '更新 2006/02/06 メニュー選択数取り出し用
        Dim objData As New DataSet()
        Dim objData2 As New DataSet()                                       '更新 2006/02/06 メニュー選択数取り出し用データセット 
        Dim objRows As DataRow = Nothing
        Dim objRows2 As DataRow = Nothing                                             '更新 2006/02/06 メニュー選択数取り出し用
        Dim lngCnt As Long
        Dim udtMHArgs() As typPutHString                                    ' 横書き文字列出力処理引数(複数行描画処理向け)
        Dim objFont2 As Font = Nothing
        Dim strWork(2) As String
        Dim strFilenm As String = Nothing
        Dim flag1 As String = Nothing
        Dim flag2 As String = Nothing
        Dim strMenuID As String = Nothing                                             'TOP画像 ﾌﾞﾚｰｸｷｰ
        Dim udtTPD020 As typTPD020 = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMaterials_2 = False

        ''-------------------------------------------
        '' 更新 2006/03/20『詳細』広告画像からの注文
        ''-------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "詳しく！"
        '    .lngCharLower = 13
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 11
        '    .lngCharHeight = 0
        '    '.objColor = System.Drawing.Color.Black
        '    .objColor = System.Drawing.Color.DarkBlue
        '    '.objColor = System.Drawing.Color.MediumBlue
        'End With
        'Call LS_CreateMaterial_1("VGC016", udtVDummy, udtHArgs, Nothing, DispType.VGA)

        '------------------------------
        ' 『確認・取消』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 19) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "これまでのご注文"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                ' ↓更新 2006/02/06 SVG101
        'Call LS_CreateMaterial_2("VGC002", udtMHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_2("SVGA26", udtMHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『混雑中』ボタン(日本語)800x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 32) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "混雑中"
            .lngCharLower = 31
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        If Not LF_FontSetup(objFont2, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtMHArgs(1)
            .strPutStrings = "注文はしばらく"
            .lngCharLower = 10
            .objFont = objFont2
            .lngCharWidth = 5
            .lngPositionY = 60
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(2)
            .strPutStrings = "お待ちください"
            .lngCharLower = 10
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 85
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        'Call LS_CreateMaterial_2("VGC013", udtMHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_2("SVGA36", udtMHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20

        ''------------------------------
        '' 『注文』ボタン(日本語)640x480用
        ''------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 29) Then
        '    Exit Function
        'End If
        'ReDim udtMHArgs(3)
        'With udtMHArgs(0)
        '    .strPutStrings = "注文"
        '    .lngCharLower = 40
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 15
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        '' ガイダンス文字列取得
        'strGuide = LF_GetGuide("ETCMSG", "I03") & Space(100) ' 後半のスペースは、指定文字列が短い場合のダミースペース
        'strWork(0) = GF_MidB(strGuide, 1, 16)
        'strWork(1) = GF_MidB(strGuide, 17, 16)
        'strWork(2) = GF_MidB(strGuide, 33, 16)

        'If Not LF_FontSetup(objFont2, GC_EJKBN_J, 17) Then
        '    Exit Function
        'End If
        'With udtMHArgs(1)
        '    .strPutStrings = strWork(0)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 5
        '    .lngPositionY = 50
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'With udtMHArgs(2)
        '    .strPutStrings = strWork(1)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 69
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        ''更新　2006/02/02 3行目対応
        'With udtMHArgs(3)
        '    .strPutStrings = strWork(2)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 88
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        '' ↓更新 2006/02/06 SVG100
        'Call LS_CreateMaterial_2("VGC003", udtMHArgs, Nothing, DispType.VGA)
        '------------------------------------
        ' 更新 2006/03/20 「詳細」ボタン追加
        '------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "詳細"
        '    .lngCharLower = 1 
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 2
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_1("VGC016", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 呼出ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "呼 出"
            .lngCharLower = 14
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With                '更新↓ 2006/02/06 SVG006

        'Call LS_CreateMaterial_1("VGC006", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA30", udtVDummy, udtHArgs, Nothing, DispType.SVGA)    '12インチ対応 2006.10.20

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' お会計ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "お会計"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 13
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With        '更新↓ 2006/02/06 SVG006　

        'Call LS_CreateMaterial_1("VGC007", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA31", udtVDummy, udtHArgs, Nothing, DispType.SVGA)    '12インチ対応 2006.10.20

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------------------------
        ' 張本 ADD 前ページ遷移ボタン(日本語) 800×480用
        '------------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 23) Then   '2006.06.07 張本変更 27→20 
            Exit Function
        End If
        With udtHArgs
            '.strPutStrings = "前頁"
            '.lngCharLower = 16          '2006.07.27 
            '.objFont = objFont
            '.lngCharWidth = 0
            ''.lngPositionY = 7          '2005.10.24
            '.lngPositionY = 41          '2006.06.07 張本変更 11→42
            '.lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            '-- 2006.10.20 12インチ対応
            .strPutStrings = "前頁"
            .lngCharLower = 30
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前 SVGA39
        'Call LS_CreateMaterial_1("VGC008", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA32", udtVDummy, udtHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '-----------------------------------------------
        ' 張本 ADD 次ページ遷移ボタン(日本語) 800x480用
        '-----------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 23) Then
            Exit Function
        End If
        With udtHArgs
            '.strPutStrings = "次頁"
            '.lngCharLower = 16          '2006.07.27
            '.objFont = objFont
            '.lngCharWidth = 0
            ''.lngPositionY = 7          '2005.10.24
            '.lngPositionY = 41          '2006.06.07 張本変更 11→42
            '.lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            '-- 2006.10.20 12インチ対応
            .strPutStrings = "次頁"
            .lngCharLower = 30
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGC009", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA33", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '-----------------------------------------
        ' 張本 ADD 『前に戻る』(日本語) 800x480用
        '-----------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            '.strPutStrings = "前に"
            '.lngCharLower = 25                     '2006/07/27 更新
            '.objFont = objFont
            '.lngCharWidth = 0
            '.lngPositionY = 1                     '2006/06/07 張本 ADD 出力位置変更 1→35
            '.lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            '-- 2006.10.20 12インチ対応
            .strPutStrings = "前に"
            .lngCharLower = 26
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 1
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            '.strPutStrings = "戻る"
            '.lngCharLower = 25                      '2006/07/27 更新
            '.objFont = objFont
            '.lngCharWidth = 0
            '.lngPositionY = 55                     '2006/06/07 張本 ADD 出力位置変更 19→51
            '.lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            '-- 2006.10.20 12インチ対応
            .strPutStrings = "戻る"
            .lngCharLower = 26
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 19
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        'Call LS_CreateMaterial_2("VGC001", udtMHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_2("SVGA25", udtMHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '--------------------------------------------
        ' 『増やす』ボタン(日本語)640x480用 変更なし
        '--------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "増やす"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 4
            .lngPositionY = 11           '2005.10.24
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前　SVGA35
        'Call LS_CreateMaterial_1("VGC011", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA34", udtVDummy, udtHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '--------------------------------------------
        ' 『減らす』ボタン(日本語)640x480用 変更なし
        '--------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "減らす"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 4
            .lngPositionY = 11           '2005.10.24
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前 SVGA44
        'Call LS_CreateMaterial_1("VGC012", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA35", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - いいえ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "いいえ"
            .lngCharLower = 55
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        'Call LS_CreateMaterial_1("VGS025", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA49", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - はい』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "はい"
            .lngCharLower = 70
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        'Call LS_CreateMaterial_1("VGS024", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA48", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ''------------------------------
        '' 『注文する』ボタン(日本語)640x480用
        ''------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "注文する"
        '    .lngCharLower = 40
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 12
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_1("VGS030", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『次の商品を選ぶ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選ぶ"
            .lngCharLower = 4
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS031", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA53", udtVDummy, udtHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '--- 2006.6.22 張本 ADD 割り勘対応 ---
        '------------------------------
        ' 『割り勘・大』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "割り勘"
            .lngCharLower = 60
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS044", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA61", udtVDummy, udtHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『割り勘・小』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "割り勘"
            .lngCharLower = 11
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 13
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS045", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA62", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '---------------------------------------

        '------------------------------
        ' 『注文履歴を消去する』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 19) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注文履歴を消去する"
            .lngCharLower = 10
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS032", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA54", udtVDummy, udtHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『次の商品を選択する』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選ぶ"
            .lngCharLower = 9
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS041", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA59", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文取消し』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注 文 取 消 し"
            .lngCharLower = 9
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS033", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA55", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『戻　る』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "戻　る"
            .lngCharLower = 60
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS034", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA56", udtVDummy, udtHArgs, Nothing, DispType.SVGA)   '12インチ対応 2006.10.20

        '------------------------------
        ' 『ご案内』(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "ご　案　内"
            .lngCharLower = 19
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 5
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_1("VGS005", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA38", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '-------------------------------------------
        ' 『トップメニュー』ボタン(日本語)640x480用
        '-------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then '2006/06/07 張本 変更 22→19
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            '.strPutStrings = "トップ"
            '.lngCharLower = 8
            '.objFont = objFont
            '.lngCharWidth = 0
            '.lngPositionY = 31              '2006/06/07 張本 変更 2→35
            '.lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            ' -- 12インチ対応 2006.10.20
            .strPutStrings = "トップ"
            .lngCharLower = 22
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 2
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            '.strPutStrings = "メニュー"
            '.lngCharLower = -1
            '.objFont = objFont
            '.lngCharWidth = 0
            '.lngPositionY = 57              '2006/06/07 張本 変更 19→53  
            '.lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            ' -- 12インチ対応 2006.10.20
            .strPutStrings = "メニューへ"
            .lngCharLower = 0
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 19
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'Call LS_CreateMaterial_2("VGC004", udtMHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_2("SVGA28", udtMHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------------------------
        ' 2006/06/07 張本 ADD 広告画面へ出力用ボタン追加
        ' 『トップメニュー』ボタン(日本語)800x480用
        '------------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 21) Then '2006/06/07 張本 変更 22→19
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "トップメニュー"
            .lngCharLower = 0
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = ""
            .lngCharLower = 0
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 0            '2006/06/07 張本 変更 19→44  
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        'With udtMHArgs(0)
        '    .strPutStrings = "トップ"
        '    .lngCharLower = 10
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 4             '2006/06/07 張本 変更 2→34
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'With udtMHArgs(1)
        '    .strPutStrings = "メニュー"
        '    .lngCharLower = 1
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 23            '2006/06/07 張本 変更 19→44  
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_2("VGC005", udtMHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_2("SVGA29", udtMHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 「メニューに戻る」ボタン640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "メニューに戻る"
            .lngCharLower = 15
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        'Call LS_CreateMaterial_1("VGS035", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        Call LS_CreateMaterial_1("SVGA57", udtVDummy, udtHArgs, Nothing, DispType.SVGA)  '12インチ対応 2006.10.20
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ' ------------------------------------------------------------------

        ' --- (2008.12.16) 飲み放題対応(SVGA用) ---------------------
        '--------------------------------
        ' 「飲み放題・大」ボタン800x600用
        '--------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 32) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = GF_GetAppInfo("FREE_MENU_NM")
            .lngCharLower = 15
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 50
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("SVGA75", udtVDummy, udtHArgs, Nothing, DispType.SVGA)

        '--------------------------------
        ' 「飲み放題・小」ボタン800x600用
        '--------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = GF_GetAppInfo("FREE_MENU_NM")
            .lngCharLower = 25
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 18
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("SVGA76", udtVDummy, udtHArgs, Nothing, DispType.SVGA)

        '------------------------------
        ' 「注　文・小」ボタン800x600用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注　文"
            .lngCharLower = 40
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 18
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("SVGA77", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『混雑中・小』ボタン800x600用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "混 雑 中"
            .lngCharLower = 25
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 18
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("SVGA78", udtVDummy, udtHArgs, Nothing, DispType.SVGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1
        ' -----------------------------------------------------------

        '------------------------------
        ' メニューボタン640x480用
        '------------------------------
        strSQL = ""
        If pCreateMode = typCreateMode.RealTimeTransfar Then
            'リアルタイム転送時
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            strSQL = strSQL & " WHERE TPM060.MENUID  = '" & pOMenuID & "'"
            strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"

        Else
            '一括転送時
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            ''strSQL = strSQL & " WHERE TPM060.MENUID = (SELECT TPM040.DEFMENUID FROM TPM040)"
            ''strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & " WHERE TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"

        End If

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        '更新 2006/02/06 メニューボタン8分割と12分割判定追加
        '更新 2006/02/10 メニューボタン色変更 8分割時のみ
        lngCnt = 0
        flag1 = ""
        flag2 = ""
        strFilenm = ""
        strMenuID = ""
        strTimeStamp = Format$(Now, "yyyyMMddHHmmss")

        While lngCnt < objData.Tables("com").Rows.Count

            '次レコード読み込み
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            'ﾌﾞﾚｰｸｷｰ
            If strMenuID <> Trim$(objRows("MENUID")) Then

                '更新 2006/02/06 メニュー数によってボタンサイズ変更
                strSQL2 = ""
                strSQL2 = strSQL2 & "SELECT COUNT(DISTINCT MENUGRPID) AS CNT"
                strSQL2 = strSQL2 & "  FROM TPM060"
                strSQL2 = strSQL2 & " WHERE TPM060.MENUID = '" & Trim$(objRows("MENUID")) & "'"
                strSQL2 = strSQL2 & "   AND TPM060.GROUPCD = 'J000'"
                strSQL2 = strSQL2 & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
                strSQL2 = strSQL2 & " GROUP BY TPM060.MENUID,"
                strSQL2 = strSQL2 & "          TPM060.MENUNM"

                objData2 = New DataSet()
                If Not GF_GetData(strSQL2, objData2) Then
                    Exit Function
                End If
                If objData2.Tables("com").Rows.Count = 0 Then
                    Exit Function
                End If
                If Not GF_GetRows(objData2, 0, objRows2) Then
                    Exit Function
                End If

                'メニューごとのメニュー数を集計    
                If CLng(objRows2("CNT")) > 8 Then
                    '名称 TOPMENU １２分割用
                    'strFilenm = "TMA"
                    strFilenm = "TMC"
                    flag2 = "1"
                Else
                    '名称 TOPMENU ８分割用
                    'strFilenm = "TMB"
                    strFilenm = "TMD"
                    flag2 = "0"
                End If

                'ｷｰ退避
                strMenuID = Trim$(objRows("MENUID"))
            End If

            ' TPD026 追加処理
            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                .MENUBTNID = Trim$(objRows("MENUGRPID"))
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = strFilenm
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
            End With
            If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.SVGA) Then
                Exit Function
            End If

            ' MENUGRPNMの文字数をカウント
            Select Case Len(Trim$(objRows("MENUGRPNM")))
                '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            Case 1
                    If flag2 = "1" Then
                        lngFontSize = 50 '12分割時 36→45
                    Else
                        lngFontSize = 50 '8分割時
                    End If
                Case 2
                    If flag2 = "1" Then
                        lngFontSize = 45 '12分割時 32→45
                    Else
                        lngFontSize = 45 '8分割時
                    End If
                Case 3
                    If flag2 = "1" Then
                        lngFontSize = 45 '12分割時 28→45
                    Else
                        lngFontSize = 45 '8分割時 40→45
                    End If
                Case 4 To 5
                    If flag2 = "1" Then
                        lngFontSize = 43 '12分割時 28→43
                    Else
                        lngFontSize = 43 '8分割時 38→45
                    End If
                Case 6
                    If flag2 = "1" Then
                        lngFontSize = 40 '12分割時 28→40
                    Else
                        lngFontSize = 40 '8分割時 33→40
                    End If

                Case 7
                    If flag2 = "1" Then
                        lngFontSize = 38 '12分割時 22→38
                    Else
                        lngFontSize = 38 '8分割時
                    End If

                Case 8 To 14
                    If flag2 = "1" Then
                        lngFontSize = 38 '12分割時 20→30
                    Else
                        lngFontSize = 38 '8分割時
                    End If
                Case Else
                    If flag2 = "1" Then
                        lngFontSize = 28 '12分割時 18→
                    Else
                        lngFontSize = 35 '8分割時
                    End If

                    'Case 1 To 5
                    '    lngFontSize = 28
                    '    lngPosY = 5
                    '    'lngPosY = 2
                    'Case 6 To 7
                    '    lngFontSize = 20        '-- 2005.10.19 文字サイズ変更
                    '    ''lngFontSize = 20
                    '    lngPosY = 9
                    '    ''lngPosY = 7
                    'Case 8 To 18
                    '    lngFontSize = 28        '-- 2005.10.19 文字サイズ変更
                    '    ''lngFontSize = 16
                    '    lngPosY = 5
                    '    ''lngPosY = 2
                    'Case Else
                    '    lngFontSize = 16
                    '    lngPosY = 2
                    '-- ↑ 2005.10.19 メニュー文字サイズ、1行の文字数変更

            End Select

            If Not LF_FontSetup(objFont, GC_EJKBN_J, lngFontSize) Then
                Exit Function
            End If

            Erase udtMHArgs
            ReDim udtMHArgs(2)

            '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            Dim intStart As Integer
            Dim intEnd As Integer
            Dim intReStart As Integer
            intEnd = 7 '更新 2006/02/03 5
            intStart = 8
            intReStart = 15

            Select Case Len(Trim$(objRows("MENUGRPNM")))
                'Case 1 To 10
                '    intEnd = 7 '更新 2006/02/03 5
                '    intStart = 8
                '    lngPosY = 20
                'Case 11 To 18
                '    intEnd = 9
                '    intStart = 10
                '    lngPosY = 10 '更新 2006/02/02
            Case 1
                    If flag2 = "1" Then
                        'lngPosY = 9 '12分割時
                        lngPosY = 15 ' 2006.10.31
                    Else
                        'lngPosY = 26 '8分割時　
                        lngPosY = 35 ' 2006.10.31
                    End If
                Case 2
                    If flag2 = "1" Then
                        'lngPosY = 12 '12分割時　13→9　
                        lngPosY = 17 ' 2006.10.31
                    Else
                        'lngPosY = 30 '8分割時　
                        lngPosY = 35 ' 2006.10.31
                    End If
                Case 3
                    If flag2 = "1" Then
                        'lngPosY = 12 '12分割時
                        lngPosY = 18 ' 2006.10.31
                    Else
                        'lngPosY = 30 '8分割時　32→30
                        lngPosY = 35 ' 2006.10.31
                    End If
                Case 4 To 5
                    If flag2 = "1" Then
                        'lngPosY = 13 '12分割時
                        lngPosY = 18 ' 2006.10.31
                    Else
                        'lngPosY = 32 '8分割時　
                        lngPosY = 35 ' 2006.10.31
                    End If
                Case 6 To 7
                    If flag2 = "1" Then
                        'lngPosY = 15 '12分割時
                        lngPosY = 20 ' 2006.10.31
                    Else
                        'lngPosY = 35 '8分割時
                        lngPosY = 35 ' 2006.10.31
                    End If

                Case 8 To 14
                    If flag2 = "1" Then
                        'lngPosY = 0 '更新 2006/02/02 12分割時
                        lngPosY = 9 ' 2006.10.31
                    Else
                        'lngPosY = 26 '8分割時
                        lngPosY = 24  '2006.11.07
                    End If
                Case 15 To 21
                    If flag2 = "1" Then
                        'lngPosY = 0 '12分割時
                        lngPosY = 8 ' 2006.10.31
                    Else
                        'lngPosY = 10 '8分割時
                        lngPosY = 18 ' 2006.10.31
                    End If
                Case Else
                    If flag2 = "1" Then
                        lngPosY = 0 '12分割時
                    Else
                        lngPosY = 12 '8分割時 '2006/06/07 張本 ADD 10→12
                    End If
            End Select
            With udtMHArgs(0)
            ' 2014-05-12 2バイト文字制限解除
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), 1, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), 1, intEnd)
                '更新　2006/02/03 文字数により、出力位置変更
                Select Case Len(Trim$(objRows("MENUGRPNM")))
                    Case 1
                        If flag2 = "1" Then
                            .lngCharLower = 105 '5 79→105
                        Else
                            .lngCharLower = 105  '2006/06/07 張本 ADD 80→105
                        End If
                    Case 2
                        If flag2 = "1" Then
                            .lngCharLower = 87 '5 62→87
                        Else
                            .lngCharLower = 83   '2006/06/07 張本 ADD 58→83
                        End If
                    Case 3
                        If flag2 = "1" Then
                            .lngCharLower = 65 '5 50→65
                        Else
                            .lngCharLower = 65   '2006/06/07 張本 ADD 40→65
                        End If
                    Case 4
                        If flag2 = "1" Then
                            .lngCharLower = 43   '28→49
                        Else
                            .lngCharLower = 49   '2006/06/07 張本 ADD 28→49
                        End If
                    Case 5
                        If flag2 = "1" Then
                            .lngCharLower = 23   '10→23
                        Else
                            .lngCharLower = 23    '2006/06/07 張本 ADD 8→23
                        End If
                    Case 6
                        If flag2 = "1" Then
                            .lngCharLower = 12    '0→16
                        Else
                            .lngCharLower = 16    '2006/06/07 張本 ADD 5→16
                        End If
                    Case 7
                        If flag2 = "1" Then
                            .lngCharLower = 0   '1→0　
                        Else
                            .lngCharLower = 0
                        End If
                    Case 8 To 14
                        If flag2 = "1" Then
                            .lngCharLower = 0  '10→0
                        Else
                            .lngCharLower = 0
                        End If

                    Case Else
                        '.lngCharLower = 5
                        If flag2 = "1" Then
                            .lngCharLower = 36   '23→33
                        Else
                            .lngCharLower = 6    '2006/06/07 張本 ADD 5→6
                        End If

                End Select
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = lngPosY
                .lngCharHeight = 0
                If flag2 = "1" Then
                    .objColor = System.Drawing.Color.Black
                Else
                    .objColor = System.Drawing.Color.Black
                End If
            End With
            With udtMHArgs(1)
            ' 2014-05-12 2バイト文字制限解除
                                                                                                                '↓更新　len(trim$(objrows("menugrpnm")))    
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intStart, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), intStart, intEnd)
                If flag2 = "1" Then
                    '.lngCharLower = 5 '5
                    .objColor = System.Drawing.Color.Black
                    If Len(Trim$(objRows("MENUGRPNM"))) > 7 And _
                       Len(Trim$(objRows("MENUGRPNM"))) < 15 Then
                        .lngCharLower = 0
                        .lngPositionY = lngPosY + 28
                    Else
                        .lngCharLower = 36 '2006/06/07 張本 ADD 23→29
                        .lngPositionY = lngPosY + 20
                    End If

                Else
                    .objColor = System.Drawing.Color.Black
                    .lngPositionY = lngPosY + 25
                    If Len(Trim$(objRows("MENUGRPNM"))) > 7 And _
                       Len(Trim$(objRows("MENUGRPNM"))) < 15 Then
                        .lngCharLower = 0
                    Else
                        .lngCharLower = 6 '2006/06/07 張本 ADD 5→6
                    End If
                End If
                .objFont = objFont
                .lngCharWidth = 0
                .lngCharHeight = 0
            End With
            '更新　3行目対応 200/02/06
            With udtMHArgs(2)
            ' 2014-05-12 2バイト文字制限解除
                                                                                                                    '↓更新 len(trim$(objrows("menugrpnm")))
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intReStart, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), intReStart, intEnd)
                .objFont = objFont
                .lngCharWidth = 0
                If flag2 = "1" Then
                    .lngCharLower = 36
                    .lngPositionY = lngPosY + 40
                    .objColor = System.Drawing.Color.Black
                Else
                    .lngCharLower = 6 '2006/06/07 張本 ADD 5→6
                    .lngPositionY = lngPosY + 50
                    .objColor = System.Drawing.Color.Black
                End If
                .lngCharHeight = 0
            End With

            ' 画像生成処理
            If pCreateMode = typCreateMode.RealTimeTransfar Then
                '更新 2006/02/06 ↓ "SVG200"
                Call LS_CreateMaterial_2(strFilenm & Trim$(objRows("MENUGRPID")), udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J & strTimeStamp, DispType.SVGA)
            Else
                Call LS_CreateMaterial_2(strFilenm & Trim$(objRows("MENUGRPID")), udtMHArgs, Trim$(objRows("MENUID")) & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J & strTimeStamp, DispType.SVGA)
            End If


            lngCnt = lngCnt + 1

        End While

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 参照画像コピー処理
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM070.FILENM"
        strSQL = strSQL & "  FROM TPM070,"
        strSQL = strSQL & "       TPM040"
        strSQL = strSQL & " WHERE TPM070.IMAGESET  = TPM040.IMAGESET"
        strSQL = strSQL & "   AND TPM070.TRANSKIND = '2'"

        objData = New DataSet()

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        lngCnt = 0
        While lngCnt < objData.Tables("com").Rows.Count
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            Dim strobjrow As String
            strobjrow = objRows("FILENM")

            Try '                                            ↓更新 2006/02/01 2→3　
                'If System.IO.File.Exists(g_udtAppConfig.strNMImgPath3 & "\" & Trim$(objRows("FILENM"))) = False And _
                '   System.IO.File.Exists(GF_GetAppInfo("MATERIAL_V") & "\" & Trim$(objRows("FILENM"))) = True Then
                '    System.IO.File.Copy(GF_GetAppInfo("MATERIAL_V") & "\" & _
                '                        Trim$(objRows("FILENM")), _
                '                        g_udtAppConfig.strNMImgPath3 & "\" & _
                '                        Trim$(objRows("FILENM")))
                'End If

                '--- 12インチ対応 2006.10.23
                If System.IO.File.Exists(g_udtAppConfig.strNMImgPath2 & "\" & Trim$(objRows("FILENM"))) = False And _
                   System.IO.File.Exists(GF_GetAppInfo("MATERIAL_V") & "\" & Trim$(objRows("FILENM"))) = True Then
                    System.IO.File.Copy(GF_GetAppInfo("MATERIAL_V") & "\" & _
                                        Trim$(objRows("FILENM")), _
                                        g_udtAppConfig.strNMImgPath2 & "\" & _
                                        Trim$(objRows("FILENM")))
                End If
            Catch
                Exit Function
            End Try

            lngCnt = lngCnt + 1
        End While
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMaterials_2 = True
    End Function

    ' 各種ボタン等の素材画像を生成する 640x480用
    Private Function LF_CreateMaterials_3(ByVal pStatus As CNL1810, _
                                        ByVal pCreateMode As typCreateMode, _
                                        Optional ByVal pOMenuID As String = "", _
                                        Optional ByVal pRMenuID As String = "") As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim lngFontSize As Long
        Dim lngPosY As Long
        Dim udtVDummy As typPutVString = Nothing                                      ' 縦書き文字列出力処理引数
        Dim udtHArgs As typPutHString                                       ' 横書き文字列出力処理引数
        Dim strSQL As String = Nothing
        Dim strSQL2 As String = Nothing                                               '更新 2006/02/06 メニュー選択数取り出し用
        Dim objData As New DataSet()
        Dim objData2 As New DataSet()                                       '更新 2006/02/06 メニュー選択数取り出し用データセット 
        Dim objRows As DataRow = Nothing
        Dim objRows2 As DataRow = Nothing                                             '更新 2006/02/06 メニュー選択数取り出し用
        Dim lngCnt As Long
        Dim udtMHArgs() As typPutHString                                    ' 横書き文字列出力処理引数(複数行描画処理向け)
        Dim strWork(2) As String
        Dim strFilenm As String = Nothing
        Dim flag1 As String = Nothing
        Dim flag2 As String = Nothing
        Dim strMenuID As String = Nothing                                             'TOP画像 ﾌﾞﾚｰｸｷｰ
        Dim udtTPD020 As typTPD020 = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMaterials_3 = False

        '-------------------------------------------
        ' 更新 2006/03/20『詳細』広告画像からの注文
        '-------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "詳しく！"
            .lngCharLower = 13
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 11
            .lngCharHeight = 0
            '.objColor = System.Drawing.Color.Black
            .objColor = System.Drawing.Color.DarkBlue
            '.objColor = System.Drawing.Color.MediumBlue
        End With
        Call LS_CreateMaterial_1("VGC016", udtVDummy, udtHArgs, Nothing, DispType.VGA)

        '------------------------------
        ' 『確認・取消』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "これまでのご注文"
            .lngCharLower = 2
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 17
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                ' ↓更新 2006/02/06 SVG101
        Call LS_CreateMaterial_2("VGC002", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ''------------------------------
        '' 『注文』ボタン(日本語)640x480用
        ''------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 29) Then
        '    Exit Function
        'End If
        'ReDim udtMHArgs(3)
        'With udtMHArgs(0)
        '    .strPutStrings = "注文"
        '    .lngCharLower = 40
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 15
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        '' ガイダンス文字列取得
        'strGuide = LF_GetGuide("ETCMSG", "I03") & Space(100) ' 後半のスペースは、指定文字列が短い場合のダミースペース
        'strWork(0) = GF_MidB(strGuide, 1, 16)
        'strWork(1) = GF_MidB(strGuide, 17, 16)
        'strWork(2) = GF_MidB(strGuide, 33, 16)

        'If Not LF_FontSetup(objFont2, GC_EJKBN_J, 17) Then
        '    Exit Function
        'End If
        'With udtMHArgs(1)
        '    .strPutStrings = strWork(0)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 5
        '    .lngPositionY = 50
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'With udtMHArgs(2)
        '    .strPutStrings = strWork(1)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 69
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        ''更新　2006/02/02 3行目対応
        'With udtMHArgs(3)
        '    .strPutStrings = strWork(2)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 88
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        '' ↓更新 2006/02/06 SVG100
        'Call LS_CreateMaterial_2("VGC003", udtMHArgs, Nothing, DispType.VGA)
        '------------------------------------
        ' 更新 2006/03/20 「詳細」ボタン追加
        '------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "詳細"
        '    .lngCharLower = 1 
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 2
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_1("VGC016", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 呼出ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "呼 出"
            .lngCharLower = 11
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With                '更新↓ 2006/02/06 SVG006
        Call LS_CreateMaterial_1("VGC006", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' お会計ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "お会計"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 13
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With        '更新↓ 2006/02/06 SVG006　　
        Call LS_CreateMaterial_1("VGC007", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 前ページ遷移ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "前頁"
            .lngCharLower = 30
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 7          '2005.10.24
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前 SVGA39
        Call LS_CreateMaterial_1("VGC008", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 次ページ遷移ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次頁"
            .lngCharLower = 30
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 7          '2005.10.24
            .lngPositionY = 11
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGC009", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『前に戻る』(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "前に"
            .lngCharLower = 26
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 1
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "戻る"
            .lngCharLower = 26
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 19
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("VGC001", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『増やす』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "増やす"
            .lngCharLower = 4
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 4
            .lngPositionY = 8           '2005.10.24
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前　SVGA35
        Call LS_CreateMaterial_1("VGC011", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『減らす』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "減らす"
            .lngCharLower = 4
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 4
            .lngPositionY = 8           '2005.10.24
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前 SVGA44
        Call LS_CreateMaterial_1("VGC012", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - いいえ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "いいえ"
            .lngCharLower = 55
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("VGS025", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - はい』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "はい"
            .lngCharLower = 70
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("VGS024", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ''------------------------------
        '' 『注文する』ボタン(日本語)640x480用
        ''------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "注文する"
        '    .lngCharLower = 40
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 12
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_1("VGS030", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『次の商品を選ぶ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選ぶ"
            .lngCharLower = 4
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS031", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文履歴を消去する』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 19) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注文履歴を消去する"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS032", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『次の商品を選択する』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 19) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選択する"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS041", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文取消し』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注 文 取 消 し"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS033", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『戻　る』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "戻　る"
            .lngCharLower = 55
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 13
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS034", udtVDummy, udtHArgs, Nothing, DispType.VGA)

        '------------------------------
        ' 『ご案内』(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "ご　案　内"
            .lngCharLower = 19
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 5
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS005", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『トップメニューへ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "トップ"
            .lngCharLower = 22
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 2
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "メニューへ"
            .lngCharLower = 0
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 19
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("VGC004", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1


        '------------------------------
        ' 「メニューに戻る」ボタン640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "メニューに戻る"
            .lngCharLower = 15
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("VGS035", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ' ------------------------------------------------------------------


        '------------------------------
        ' メニューボタン640x480用
        '------------------------------
        strSQL = ""
        If pCreateMode = typCreateMode.RealTimeTransfar Then
            'リアルタイム転送時
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            strSQL = strSQL & " WHERE TPM060.MENUID  = '" & pOMenuID & "'"
            strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"

        Else
            '一括転送時
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            ''strSQL = strSQL & " WHERE TPM060.MENUID = (SELECT TPM040.DEFMENUID FROM TPM040)"
            ''strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & " WHERE TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"

        End If

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        '更新 2006/02/06 メニューボタン8分割と12分割判定追加
        '更新 2006/02/10 メニューボタン色変更 8分割時のみ
        lngCnt = 0
        flag1 = ""
        flag2 = ""
        strFilenm = ""
        strMenuID = ""
        strTimeStamp = Format$(Now, "yyyyMMddHHmmss")

        While lngCnt < objData.Tables("com").Rows.Count

            '次レコード読み込み
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            'ﾌﾞﾚｰｸｷｰ
            If strMenuID <> Trim$(objRows("MENUID")) Then

                '更新 2006/02/06 メニュー数によってボタンサイズ変更
                strSQL2 = ""
                strSQL2 = strSQL2 & "SELECT COUNT(DISTINCT MENUGRPID) AS CNT"
                strSQL2 = strSQL2 & "  FROM TPM060"
                strSQL2 = strSQL2 & " WHERE TPM060.MENUID = '" & Trim$(objRows("MENUID")) & "'"
                strSQL2 = strSQL2 & "   AND TPM060.GROUPCD = 'J000'"
                strSQL2 = strSQL2 & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
                strSQL2 = strSQL2 & " GROUP BY TPM060.MENUID,"
                strSQL2 = strSQL2 & "          TPM060.MENUNM"

                objData2 = New DataSet()
                If Not GF_GetData(strSQL2, objData2) Then
                    Exit Function
                End If
                If objData2.Tables("com").Rows.Count = 0 Then
                    Exit Function
                End If
                If Not GF_GetRows(objData2, 0, objRows2) Then
                    Exit Function
                End If

                'メニューごとのメニュー数を集計    
                If CLng(objRows2("CNT")) > 8 Then
                    '名称 TOPMENU １２分割用
                    strFilenm = "TMA"
                    flag2 = "1"
                Else
                    '名称 TOPMENU ８分割用
                    strFilenm = "TMB"
                    flag2 = "0"
                End If

                'ｷｰ退避
                strMenuID = Trim$(objRows("MENUID"))
            End If

            ' TPD026 追加処理
            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                .MENUBTNID = Trim$(objRows("MENUGRPID"))
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = strFilenm
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
            End With
            If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                Exit Function
            End If

            ' MENUGRPNMの文字数をカウント
            Select Case Len(Trim$(objRows("MENUGRPNM")))
                '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            Case 1
                    If flag2 = "1" Then
                        lngFontSize = 36 '12分割時 
                    Else
                        lngFontSize = 50 '8分割時
                    End If
                Case 2
                    If flag2 = "1" Then
                        lngFontSize = 32 '12分割時 
                    Else
                        lngFontSize = 45 '8分割時
                    End If
                Case 3
                    If flag2 = "1" Then
                        lngFontSize = 28 '12分割時 
                    Else
                        lngFontSize = 40 '8分割時
                    End If
                Case 4 To 5
                    If flag2 = "1" Then
                        lngFontSize = 28 '12分割時 
                    Else
                        lngFontSize = 38 '8分割時
                    End If
                Case 6
                    If flag2 = "1" Then
                        lngFontSize = 26 '12分割時 
                    Else
                        lngFontSize = 33 '8分割時
                    End If

                Case 7
                    If flag2 = "1" Then
                        lngFontSize = 22 '12分割時 
                    Else
                        lngFontSize = 30 '8分割時
                    End If

                Case 8 To 14
                    If flag2 = "1" Then
                        lngFontSize = 20 '12分割時
                    Else
                        lngFontSize = 30 '8分割時
                    End If
                Case Else
                    If flag2 = "1" Then
                        lngFontSize = 18 '12分割時
                    Else
                        lngFontSize = 28 '8分割時
                    End If

                    'Case 1 To 5
                    '    lngFontSize = 28
                    '    lngPosY = 5
                    '    'lngPosY = 2
                    'Case 6 To 7
                    '    lngFontSize = 20        '-- 2005.10.19 文字サイズ変更
                    '    ''lngFontSize = 20
                    '    lngPosY = 9
                    '    ''lngPosY = 7
                    'Case 8 To 18
                    '    lngFontSize = 28        '-- 2005.10.19 文字サイズ変更
                    '    ''lngFontSize = 16
                    '    lngPosY = 5
                    '    ''lngPosY = 2
                    'Case Else
                    '    lngFontSize = 16
                    '    lngPosY = 2
                    '-- ↑ 2005.10.19 メニュー文字サイズ、1行の文字数変更

            End Select

            If Not LF_FontSetup(objFont, GC_EJKBN_J, lngFontSize) Then
                Exit Function
            End If

            Erase udtMHArgs
            ReDim udtMHArgs(2)

            '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            Dim intStart As Integer
            Dim intEnd As Integer
            Dim intReStart As Integer
            intEnd = 7 '更新 2006/02/03 5
            intStart = 8
            intReStart = 15

            Select Case Len(Trim$(objRows("MENUGRPNM")))
                'Case 1 To 10
                '    intEnd = 7 '更新 2006/02/03 5
                '    intStart = 8
                '    lngPosY = 20
                'Case 11 To 18
                '    intEnd = 9
                '    intStart = 10
                '    lngPosY = 10 '更新 2006/02/02
            Case 1
                    If flag2 = "1" Then
                        lngPosY = 9 '12分割時
                    Else
                        lngPosY = 26 '8分割時　
                    End If
                Case 2
                    If flag2 = "1" Then
                        lngPosY = 13 '12分割時
                    Else
                        lngPosY = 30 '8分割時　
                    End If
                Case 3
                    If flag2 = "1" Then
                        lngPosY = 15 '12分割時
                    Else
                        lngPosY = 32 '8分割時　
                    End If
                Case 4 To 5
                    If flag2 = "1" Then
                        lngPosY = 15 '12分割時
                    Else
                        lngPosY = 32 '8分割時　
                    End If
                Case 6 To 7
                    If flag2 = "1" Then
                        lngPosY = 18 '12分割時
                    Else
                        lngPosY = 35 '8分割時　
                    End If

                Case 8 To 14
                    If flag2 = "1" Then
                        lngPosY = 10 '更新 2006/02/02 12分割時
                    Else
                        lngPosY = 26 '8分割時
                    End If
                Case 15 To 21
                    If flag2 = "1" Then
                        lngPosY = 2 '12分割時
                    Else
                        lngPosY = 10 '8分割時
                    End If
                Case Else
                    If flag2 = "1" Then
                        lngPosY = 2 '12分割時
                    Else
                        lngPosY = 10 '8分割時
                    End If
            End Select
            With udtMHArgs(0)
            ' 2014-05-12 2バイト文字制限解除
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), 1, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), 1, intEnd)
                '更新　2006/02/03 文字数により、出力位置変更
                Select Case Len(Trim$(objRows("MENUGRPNM")))
                    Case 1
                        If flag2 = "1" Then
                            .lngCharLower = 79 '5
                        Else
                            .lngCharLower = 80
                        End If
                    Case 2
                        If flag2 = "1" Then
                            .lngCharLower = 62 '5
                        Else
                            .lngCharLower = 58
                        End If
                    Case 3
                        If flag2 = "1" Then
                            .lngCharLower = 50 '5
                        Else
                            .lngCharLower = 40
                        End If
                    Case 4
                        If flag2 = "1" Then
                            .lngCharLower = 28
                        Else
                            .lngCharLower = 28
                        End If
                    Case 5
                        If flag2 = "1" Then
                            .lngCharLower = 10
                        Else
                            .lngCharLower = 8
                        End If
                    Case 6
                        If flag2 = "1" Then
                            .lngCharLower = 0
                        Else
                            .lngCharLower = 5
                        End If
                    Case 7
                        If flag2 = "1" Then
                            .lngCharLower = 1
                        Else
                            .lngCharLower = 0
                        End If
                    Case 8 To 14
                        If flag2 = "1" Then
                            .lngCharLower = 10
                        Else
                            .lngCharLower = 0
                        End If

                    Case 15 To 21
                        '.lngCharLower = 5
                        If flag2 = "1" Then
                            .lngCharLower = 23
                        Else
                            .lngCharLower = 5
                        End If

                End Select
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = lngPosY
                .lngCharHeight = 0
                If flag2 = "1" Then
                    .objColor = System.Drawing.Color.Black
                Else
                    .objColor = System.Drawing.Color.White
                End If
            End With
            With udtMHArgs(1)
            ' 2014-05-12 2バイト文字制限解除
                                                                                                                '↓更新　len(trim$(objrows("menugrpnm")))    
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intStart, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), intStart, intEnd)
                If flag2 = "1" Then
                    '.lngCharLower = 5 '5
                    .objColor = System.Drawing.Color.Black
                    .lngPositionY = lngPosY + 20
                    If Len(Trim$(objRows("MENUGRPNM"))) > 7 And _
                       Len(Trim$(objRows("MENUGRPNM"))) < 15 Then
                        .lngCharLower = 10
                    Else
                        .lngCharLower = 23
                    End If

                Else
                    .objColor = System.Drawing.Color.White
                    .lngPositionY = lngPosY + 25
                    If Len(Trim$(objRows("MENUGRPNM"))) > 7 And _
                       Len(Trim$(objRows("MENUGRPNM"))) < 15 Then
                        .lngCharLower = 0
                    Else
                        .lngCharLower = 5
                    End If
                End If
                .objFont = objFont
                .lngCharWidth = 0
                .lngCharHeight = 0
            End With
            '更新　3行目対応 200/02/06
            With udtMHArgs(2)
            ' 2014-05-12 2バイト文字制限解除
                                                                                                                    '↓更新 len(trim$(objrows("menugrpnm")))
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intReStart, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), intReStart, intEnd)
                .objFont = objFont
                .lngCharWidth = 0
                If flag2 = "1" Then
                    .lngCharLower = 23
                    .lngPositionY = lngPosY + 40
                    .objColor = System.Drawing.Color.Black
                Else
                    .lngCharLower = 5
                    .lngPositionY = lngPosY + 50
                    .objColor = System.Drawing.Color.White
                End If
                .lngCharHeight = 0
            End With

            ' 画像生成処理
            If pCreateMode = typCreateMode.RealTimeTransfar Then
                '更新 2006/02/06 ↓ "SVG200"
                Call LS_CreateMaterial_2(strFilenm & Trim$(objRows("MENUGRPID")), udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J & strTimeStamp, DispType.VGA)
            Else
                Call LS_CreateMaterial_2(strFilenm & Trim$(objRows("MENUGRPID")), udtMHArgs, Trim$(objRows("MENUID")) & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J & strTimeStamp, DispType.VGA)
            End If


            lngCnt = lngCnt + 1

        End While

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 参照画像コピー処理
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM070.FILENM"
        strSQL = strSQL & "  FROM TPM070,"
        strSQL = strSQL & "       TPM040"
        strSQL = strSQL & " WHERE TPM070.IMAGESET  = TPM040.IMAGESET"
        strSQL = strSQL & "   AND TPM070.TRANSKIND = '3'"

        objData = New DataSet()

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        lngCnt = 0
        While lngCnt < objData.Tables("com").Rows.Count
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            Dim strobjrow As String = Nothing
            strobjrow = objRows("FILENM")

            Try '                                            ↓更新 2006/02/01 2→3　
                If System.IO.File.Exists(g_udtAppConfig.strNMImgPath3 & "\" & Trim$(objRows("FILENM"))) = False And _
                   System.IO.File.Exists(GF_GetAppInfo("MATERIAL_V") & "\" & Trim$(objRows("FILENM"))) = True Then
                    System.IO.File.Copy(GF_GetAppInfo("MATERIAL_V") & "\" & _
                                        Trim$(objRows("FILENM")), _
                                        g_udtAppConfig.strNMImgPath3 & "\" & _
                                        Trim$(objRows("FILENM")))
                End If
            Catch
                Exit Function
            End Try

            lngCnt = lngCnt + 1
        End While
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMaterials_3 = True
    End Function

    Private Function LF_CreateMaterials_4() As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtMHArgs() As typPutHString                                    ' 横書き文字列出力処理引数(複数行描画処理向け)

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMaterials_4 = False

        '------------------------------
        ' メニューボタン
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM170.MENUID,"
        strSQL = strSQL & "       TPM170.MENUNM"
        strSQL = strSQL & "  FROM TPM170"
        strSQL = strSQL & " WHERE TPM170.GROUPCD = '0000'"
        strSQL = strSQL & "   AND TPM170.ENABLED = '1'"
        strSQL = strSQL & " ORDER BY TPM170.MENUID"

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        lngCnt = 0

        While lngCnt < objData.Tables("com").Rows.Count
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            '------------------------------
            ' メニューボタン(日本語)
            '------------------------------
            Dim lngFontSize As Long
            Dim lngPosY As Long

            lngFontSize = 35
            lngPosY = 20
            If Not LF_FontSetup(objFont, GC_EJKBN_J, lngFontSize) Then
                Exit Function
            End If
            Erase udtMHArgs
            ReDim udtMHArgs(1)

            With udtMHArgs(0)
                .strPutStrings = GF_GetAppInfo("FREE_MENU_NM")
                .lngCharLower = 1
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = lngPosY
                .lngCharHeight = 0
                .objColor = System.Drawing.Color.Black
            End With
            With udtMHArgs(1)
            ' 2014-05-12 2バイト文字制限解除
                '.strPutStrings = Mid$(StrConv(Space(50), VbStrConv.Wide), 10, 9)
                .strPutStrings = Mid$(Space(50), 10, 9)
                .lngCharLower = 1
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = 20          '--(2006.01.23) 表示文字サイズ変更
                .lngCharHeight = 0
                .objColor = System.Drawing.Color.Black
            End With

            Call LS_CreateMaterial_2("C010FD", udtMHArgs, Trim$(objRows("MENUID")) & "000" & GC_EJKBN_J)

            '-- ７インチ版追加 (2006.06.20) ↓--------------
            '       『飲み放題』ボタン（日本語）
            '-----------------------------------------------
            lngFontSize = 35
            lngPosY = 10
            If Not LF_FontSetup(objFont, GC_EJKBN_J, lngFontSize) Then
                Exit Function
            End If
            Erase udtMHArgs
            ReDim udtMHArgs(1)

            With udtMHArgs(0)
                .strPutStrings = GF_GetAppInfo("FREE_MENU_NM")
                .lngCharLower = 20
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = lngPosY
                .lngCharHeight = 0
                .objColor = System.Drawing.Color.Black
            End With
            'With udtMHArgs(1)
            '    .strPutStrings = Mid$(StrConv(Space(50), VbStrConv.Wide), 10, 9)
            '    .lngCharLower = 1
            '    .objFont = objFont
            '    .lngCharWidth = 0
            '    .lngPositionY = 20
            '    .lngCharHeight = 0
            '    .objColor = System.Drawing.Color.Black
            'End With

            Call LS_CreateMaterial_2("VGC017", udtMHArgs, Trim$(objRows("MENUID")) & "000" & GC_EJKBN_J, DispType.VGA)
            '-- ７インチ版追加 (2006.06.20) ↑--------------

            lngCnt = lngCnt + 1
        End While

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMaterials_4 = True

    End Function

    '----------------------------------------------------------
    ' 2006/06/07 張本 ADD 800×480(7インチ)版のボタン作成部 
    '----------------------------------------------------------
    Private Function LF_CreateMaterials_5(ByVal pStatus As CNL1810, _
                                        ByVal pCreateMode As typCreateMode, _
                                        Optional ByVal pOMenuID As String = "", _
                                        Optional ByVal pRMenuID As String = "") As Boolean


        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objFont As Font = Nothing
        Dim lngFontSize As Long
        Dim lngPosY As Long
        Dim udtVDummy As typPutVString = Nothing                                      ' 縦書き文字列出力処理引数
        Dim udtHArgs As typPutHString                                       ' 横書き文字列出力処理引数
        Dim strSQL As String = Nothing
        Dim strSQL2 As String = Nothing                                               '更新 2006/02/06 メニュー選択数取り出し用
        Dim objData As New DataSet()
        Dim objData2 As New DataSet()                                       '更新 2006/02/06 メニュー選択数取り出し用データセット 
        Dim objRows As DataRow = Nothing
        Dim objRows2 As DataRow = Nothing                                             '更新 2006/02/06 メニュー選択数取り出し用
        Dim lngCnt As Long
        Dim udtMHArgs() As typPutHString                                    ' 横書き文字列出力処理引数(複数行描画処理向け)
        Dim objFont2 As Font = Nothing
        Dim strWork(2) As String
        Dim strFilenm As String = Nothing
        Dim flag1 As String = Nothing
        Dim flag2 As String = Nothing
        Dim strMenuID As String = Nothing                                             'TOP画像 ﾌﾞﾚｰｸｷｰ
        Dim udtTPD020 As typTPD020 = Nothing
        Dim strTimeStamp As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_CreateMaterials_5 = False

        ''-------------------------------------------
        '' 更新 2006/03/20『詳細』広告画像からの注文
        ''-------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "詳しく！"
        '    .lngCharLower = 13
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 11
        '    .lngCharHeight = 0
        '    '.objColor = System.Drawing.Color.Black
        '    .objColor = System.Drawing.Color.DarkBlue
        '    '.objColor = System.Drawing.Color.MediumBlue
        'End With
        'Call LS_CreateMaterial_1("VGC016", udtVDummy, udtHArgs, Nothing, DispType.VGA)

        '------------------------------
        ' 『確認・取消』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 19) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "これまでのご注文"
            .lngCharLower = 3
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                ' ↓更新 2006/02/06 SVG101
        Call LS_CreateMaterial_2("VGC002", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『混雑中』ボタン(日本語)800x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 32) Then
            Exit Function
        End If
        ReDim udtMHArgs(2)
        With udtMHArgs(0)
            .strPutStrings = "混雑中"
            .lngCharLower = 31
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With

        If Not LF_FontSetup(objFont2, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtMHArgs(1)
            .strPutStrings = "注文はしばらく"
            .lngCharLower = 10
            .objFont = objFont2
            .lngCharWidth = 5
            .lngPositionY = 60
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(2)
            .strPutStrings = "お待ちください"
            .lngCharLower = 10
            .objFont = objFont2
            .lngCharWidth = 0
            .lngPositionY = 85
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("VGC013", udtMHArgs, Nothing, DispType.VGA)

        ''------------------------------
        '' 『注文』ボタン(日本語)640x480用
        ''------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 29) Then
        '    Exit Function
        'End If
        'ReDim udtMHArgs(3)
        'With udtMHArgs(0)
        '    .strPutStrings = "注文"
        '    .lngCharLower = 40
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 15
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        '' ガイダンス文字列取得
        'strGuide = LF_GetGuide("ETCMSG", "I03") & Space(100) ' 後半のスペースは、指定文字列が短い場合のダミースペース
        'strWork(0) = GF_MidB(strGuide, 1, 16)
        'strWork(1) = GF_MidB(strGuide, 17, 16)
        'strWork(2) = GF_MidB(strGuide, 33, 16)

        'If Not LF_FontSetup(objFont2, GC_EJKBN_J, 17) Then
        '    Exit Function
        'End If
        'With udtMHArgs(1)
        '    .strPutStrings = strWork(0)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 5
        '    .lngPositionY = 50
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'With udtMHArgs(2)
        '    .strPutStrings = strWork(1)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 69
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        ''更新　2006/02/02 3行目対応
        'With udtMHArgs(3)
        '    .strPutStrings = strWork(2)
        '    .lngCharLower = 2
        '    .objFont = objFont2
        '    .lngCharWidth = 0
        '    .lngPositionY = 88
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With

        '' ↓更新 2006/02/06 SVG100
        'Call LS_CreateMaterial_2("VGC003", udtMHArgs, Nothing, DispType.VGA)
        '------------------------------------
        ' 更新 2006/03/20 「詳細」ボタン追加
        '------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "詳細"
        '    .lngCharLower = 1 
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 2
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_1("VGC016", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 呼出ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "呼 出"
            .lngCharLower = 14
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With                '更新↓ 2006/02/06 SVG006
        Call LS_CreateMaterial_1("VGC006", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' お会計ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "お会計"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 13
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With        '更新↓ 2006/02/06 SVG006　　
        Call LS_CreateMaterial_1("VGC007", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------------------------
        ' 張本 ADD 前ページ遷移ボタン(日本語) 800×480用
        '------------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 23) Then   '2006.06.07 張本変更 27→20 
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "前頁"
            .lngCharLower = 16          '2006.07.27 
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 7          '2005.10.24
            .lngPositionY = 41          '2006.06.07 張本変更 11→42
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前 SVGA39
        Call LS_CreateMaterial_1("VGC008", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '-----------------------------------------------
        ' 張本 ADD 次ページ遷移ボタン(日本語) 800x480用
        '-----------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 23) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次頁"
            .lngCharLower = 16          '2006.07.27
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 7          '2005.10.24
            .lngPositionY = 41          '2006.06.07 張本変更 11→42
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGC009", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '-----------------------------------------
        ' 張本 ADD 『前に戻る』(日本語) 800x480用
        '-----------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 22) Then
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "前に"
            .lngCharLower = 25                     '2006/07/27 更新
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 29                     '2006/06/07 張本 ADD 出力位置変更 1→35
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "戻る"
            .lngCharLower = 25                      '2006/07/27 更新
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 55                     '2006/06/07 張本 ADD 出力位置変更 19→51
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("VGC001", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '--------------------------------------------
        ' 『増やす』ボタン(日本語)640x480用 変更なし
        '--------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "増やす"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 4
            .lngPositionY = 11           '2005.10.24
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前　SVGA35
        Call LS_CreateMaterial_1("VGC011", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '--------------------------------------------
        ' 『減らす』ボタン(日本語)640x480用 変更なし
        '--------------------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 18) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "減らす"
            .lngCharLower = 5
            .objFont = objFont
            .lngCharWidth = 0
            '.lngPositionY = 4
            .lngPositionY = 11           '2005.10.24
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With                  '↓変更前 SVGA44
        Call LS_CreateMaterial_1("VGC012", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - いいえ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "いいえ"
            .lngCharLower = 55
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("VGS025", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文 - はい』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "はい"
            .lngCharLower = 70
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 10
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("VGS024", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ''------------------------------
        '' 『注文する』ボタン(日本語)640x480用
        ''------------------------------
        'If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
        '    Exit Function
        'End If
        'With udtHArgs
        '    .strPutStrings = "注文する"
        '    .lngCharLower = 40
        '    .objFont = objFont
        '    .lngCharWidth = 0
        '    .lngPositionY = 12
        '    .lngCharHeight = 0
        '    .objColor = System.Drawing.Color.Black
        'End With
        'Call LS_CreateMaterial_1("VGS030", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『次の商品を選ぶ』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選ぶ"
            .lngCharLower = 4
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 12
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS031", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '--- 2006.6.22 張本 ADD 割り勘対応 ---
        '------------------------------
        ' 『割り勘・大』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "割り勘"
            .lngCharLower = 60
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS044", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『割り勘・小』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "割り勘"
            .lngCharLower = 11
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 13
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS045", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '---------------------------------------

        '------------------------------
        ' 『注文履歴を消去する』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 19) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注文履歴を消去する"
            .lngCharLower = 10
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS032", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『次の商品を選択する』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "次の商品を選ぶ"
            .lngCharLower = 9
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS041", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『注文取消し』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "注 文 取 消 し"
            .lngCharLower = 9
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS033", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 『戻　る』ボタン(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 24) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "戻　る"
            .lngCharLower = 60
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 16
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS034", udtVDummy, udtHArgs, Nothing, DispType.VGA)

        '------------------------------
        ' 『ご案内』(日本語)640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "ご　案　内"
            .lngCharLower = 19
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 5
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_1("VGS005", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '-------------------------------------------
        ' 『トップメニュー』ボタン(日本語)640x480用
        '-------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 20) Then '2006/06/07 張本 変更 22→19
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "トップ"
            .lngCharLower = 8
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 31              '2006/06/07 張本 変更 2→35
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "メニュー"
            .lngCharLower = -1
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 57              '2006/06/07 張本 変更 19→53  
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("VGC004", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------------------------
        ' 2006/06/07 張本 ADD 広告画面へ出力用ボタン追加
        ' 『トップメニュー』ボタン(日本語)800x480用
        '------------------------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 17) Then '2006/06/07 張本 変更 22→19
            Exit Function
        End If
        ReDim udtMHArgs(1)
        With udtMHArgs(0)
            .strPutStrings = "トップ"
            .lngCharLower = 10
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 4             '2006/06/07 張本 変更 2→34
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        With udtMHArgs(1)
            .strPutStrings = "メニュー"
            .lngCharLower = 1
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 23            '2006/06/07 張本 変更 19→44  
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.Black
        End With
        Call LS_CreateMaterial_2("VGC005", udtMHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 「メニューに戻る」ボタン640x480用
        '------------------------------
        If Not LF_FontSetup(objFont, GC_EJKBN_J, 27) Then
            Exit Function
        End If
        With udtHArgs
            .strPutStrings = "メニューに戻る"
            .lngCharLower = 15
            .objFont = objFont
            .lngCharWidth = 0
            .lngPositionY = 15
            .lngCharHeight = 0
            .objColor = System.Drawing.Color.White
        End With
        Call LS_CreateMaterial_1("VGS035", udtVDummy, udtHArgs, Nothing, DispType.VGA)
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        ' ------------------------------------------------------------------


        '------------------------------
        ' メニューボタン640x480用
        '------------------------------
        strSQL = ""
        If pCreateMode = typCreateMode.RealTimeTransfar Then
            'リアルタイム転送時
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            strSQL = strSQL & " WHERE TPM060.MENUID  = '" & pOMenuID & "'"
            strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"

        Else
            '一括転送時
            strSQL = strSQL & "SELECT TPM060.MENUID,"
            strSQL = strSQL & "       TPM060.MENUGRPID,"
            strSQL = strSQL & "       TPM060.MENUGRPNM"
            strSQL = strSQL & "  FROM TPM060"
            ''strSQL = strSQL & " WHERE TPM060.MENUID = (SELECT TPM040.DEFMENUID FROM TPM040)"
            ''strSQL = strSQL & "   AND TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & " WHERE TPM060.GROUPCD = 'J000'"
            strSQL = strSQL & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
            strSQL = strSQL & " ORDER BY TPM060.MENUID,"
            strSQL = strSQL & "          TPM060.MENUGRPID"

        End If

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        '更新 2006/02/06 メニューボタン8分割と12分割判定追加
        '更新 2006/02/10 メニューボタン色変更 8分割時のみ
        lngCnt = 0
        flag1 = ""
        flag2 = ""
        strFilenm = ""
        strMenuID = ""
        strTimeStamp = Format$(Now, "yyyyMMddHHmmss")

        While lngCnt < objData.Tables("com").Rows.Count

            '次レコード読み込み
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            'ﾌﾞﾚｰｸｷｰ
            If strMenuID <> Trim$(objRows("MENUID")) Then

                '更新 2006/02/06 メニュー数によってボタンサイズ変更
                strSQL2 = ""
                strSQL2 = strSQL2 & "SELECT COUNT(DISTINCT MENUGRPID) AS CNT"
                strSQL2 = strSQL2 & "  FROM TPM060"
                strSQL2 = strSQL2 & " WHERE TPM060.MENUID = '" & Trim$(objRows("MENUID")) & "'"
                strSQL2 = strSQL2 & "   AND TPM060.GROUPCD = 'J000'"
                strSQL2 = strSQL2 & "   AND TPM060.ENABLED = '" & GC_TRUE & "'"
                strSQL2 = strSQL2 & " GROUP BY TPM060.MENUID,"
                strSQL2 = strSQL2 & "          TPM060.MENUNM"

                objData2 = New DataSet()
                If Not GF_GetData(strSQL2, objData2) Then
                    Exit Function
                End If
                If objData2.Tables("com").Rows.Count = 0 Then
                    Exit Function
                End If
                If Not GF_GetRows(objData2, 0, objRows2) Then
                    Exit Function
                End If

                'メニューごとのメニュー数を集計    
                If CLng(objRows2("CNT")) > 8 Then
                    '名称 TOPMENU １２分割用
                    strFilenm = "TMA"
                    flag2 = "1"
                Else
                    '名称 TOPMENU ８分割用
                    strFilenm = "TMB"
                    flag2 = "0"
                End If

                'ｷｰ退避
                strMenuID = Trim$(objRows("MENUID"))
            End If

            ' TPD026 追加処理
            With udtTPD020
                .MENUID = IIf(pCreateMode = typCreateMode.RealTimeTransfar, pRMenuID, Trim$(objRows("MENUID")))
                .MENUBTNID = Trim$(objRows("MENUGRPID"))
                .MENUGRPID = Space(3)
                .MENUGRPID2 = Space(2)
                .MENUGRPID3 = Space(2)
                .MENULV = "1"
                .LINE = Space(5)
                .REFID = strFilenm
                .REFGRP = Space(4)
                .DISPORDER = Space(3)
                .UPDID = GC_UPDID
                .UPDYMD = Now
            End With
            If Not LF_InsertImgDB(udtTPD020, strTimeStamp, DispType.VGA) Then
                Exit Function
            End If

            ' MENUGRPNMの文字数をカウント
            Select Case Len(Trim$(objRows("MENUGRPNM")))
                '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            Case 1
                    If flag2 = "1" Then
                        lngFontSize = 50 '12分割時 36→45
                    Else
                        lngFontSize = 50 '8分割時
                    End If
                Case 2
                    If flag2 = "1" Then
                        lngFontSize = 45 '12分割時 32→45
                    Else
                        lngFontSize = 45 '8分割時
                    End If
                Case 3
                    If flag2 = "1" Then
                        lngFontSize = 45 '12分割時 28→45
                    Else
                        lngFontSize = 45 '8分割時 40→45
                    End If
                Case 4 To 5
                    If flag2 = "1" Then
                        lngFontSize = 43 '12分割時 28→43
                    Else
                        lngFontSize = 43 '8分割時 38→45
                    End If
                Case 6
                    If flag2 = "1" Then
                        lngFontSize = 40 '12分割時 28→40
                    Else
                        lngFontSize = 40 '8分割時 33→40
                    End If

                Case 7
                    If flag2 = "1" Then
                        lngFontSize = 38 '12分割時 22→38
                    Else
                        lngFontSize = 38 '8分割時
                    End If

                Case 8 To 14
                    If flag2 = "1" Then
                        lngFontSize = 38 '12分割時 20→30
                    Else
                        lngFontSize = 38 '8分割時
                    End If
                Case Else
                    If flag2 = "1" Then
                        lngFontSize = 28 '12分割時 18→
                    Else
                        lngFontSize = 35 '8分割時
                    End If

                    'Case 1 To 5
                    '    lngFontSize = 28
                    '    lngPosY = 5
                    '    'lngPosY = 2
                    'Case 6 To 7
                    '    lngFontSize = 20        '-- 2005.10.19 文字サイズ変更
                    '    ''lngFontSize = 20
                    '    lngPosY = 9
                    '    ''lngPosY = 7
                    'Case 8 To 18
                    '    lngFontSize = 28        '-- 2005.10.19 文字サイズ変更
                    '    ''lngFontSize = 16
                    '    lngPosY = 5
                    '    ''lngPosY = 2
                    'Case Else
                    '    lngFontSize = 16
                    '    lngPosY = 2
                    '-- ↑ 2005.10.19 メニュー文字サイズ、1行の文字数変更

            End Select

            If Not LF_FontSetup(objFont, GC_EJKBN_J, lngFontSize) Then
                Exit Function
            End If

            Erase udtMHArgs
            ReDim udtMHArgs(2)

            '-- ↓ 2005.11.16 メニュー文字サイズ、1行の文字数変更
            Dim intStart As Integer
            Dim intEnd As Integer
            Dim intReStart As Integer
            intEnd = 7 '更新 2006/02/03 5
            intStart = 8
            intReStart = 15

            Select Case Len(Trim$(objRows("MENUGRPNM")))
                'Case 1 To 10
                '    intEnd = 7 '更新 2006/02/03 5
                '    intStart = 8
                '    lngPosY = 20
                'Case 11 To 18
                '    intEnd = 9
                '    intStart = 10
                '    lngPosY = 10 '更新 2006/02/02
            Case 1
                    If flag2 = "1" Then
                        lngPosY = 9 '12分割時
                    Else
                        lngPosY = 26 '8分割時　
                    End If
                Case 2
                    If flag2 = "1" Then
                        lngPosY = 12 '12分割時　13→9　
                    Else
                        lngPosY = 30 '8分割時　
                    End If
                Case 3
                    If flag2 = "1" Then
                        lngPosY = 12 '12分割時
                    Else
                        lngPosY = 30 '8分割時　32→30
                    End If
                Case 4 To 5
                    If flag2 = "1" Then
                        lngPosY = 13 '12分割時
                    Else
                        lngPosY = 32 '8分割時　
                    End If
                Case 6 To 7
                    If flag2 = "1" Then
                        lngPosY = 15 '12分割時
                    Else
                        lngPosY = 35 '8分割時　
                    End If

                Case 8 To 14
                    If flag2 = "1" Then
                        lngPosY = 0 '更新 2006/02/02 12分割時
                    Else
                        lngPosY = 26 '8分割時
                    End If
                Case 15 To 21
                    If flag2 = "1" Then
                        lngPosY = 0 '12分割時
                    Else
                        lngPosY = 10 '8分割時
                    End If
                Case Else
                    If flag2 = "1" Then
                        lngPosY = 0 '12分割時
                    Else
                        lngPosY = 12 '8分割時 '2006/06/07 張本 ADD 10→12
                    End If
            End Select
            With udtMHArgs(0)
            ' 2014-05-12 2バイト文字制限解除
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), 1, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), 1, intEnd)
                '更新　2006/02/03 文字数により、出力位置変更
                Select Case Len(Trim$(objRows("MENUGRPNM")))
                    Case 1
                        If flag2 = "1" Then
                            .lngCharLower = 105 '5 79→105
                        Else
                            .lngCharLower = 105  '2006/06/07 張本 ADD 80→105
                        End If
                    Case 2
                        If flag2 = "1" Then
                            .lngCharLower = 87 '5 62→87
                        Else
                            .lngCharLower = 83   '2006/06/07 張本 ADD 58→83
                        End If
                    Case 3
                        If flag2 = "1" Then
                            .lngCharLower = 65 '5 50→65
                        Else
                            .lngCharLower = 65   '2006/06/07 張本 ADD 40→65
                        End If
                    Case 4
                        If flag2 = "1" Then
                            .lngCharLower = 43   '28→49
                        Else
                            .lngCharLower = 49   '2006/06/07 張本 ADD 28→49
                        End If
                    Case 5
                        If flag2 = "1" Then
                            .lngCharLower = 23   '10→23
                        Else
                            .lngCharLower = 23    '2006/06/07 張本 ADD 8→23
                        End If
                    Case 6
                        If flag2 = "1" Then
                            .lngCharLower = 12    '0→16
                        Else
                            .lngCharLower = 16    '2006/06/07 張本 ADD 5→16
                        End If
                    Case 7
                        If flag2 = "1" Then
                            .lngCharLower = 0   '1→0　
                        Else
                            .lngCharLower = 0
                        End If
                    Case 8 To 14
                        If flag2 = "1" Then
                            .lngCharLower = 0  '10→0
                        Else
                            .lngCharLower = 0
                        End If

                    Case Else
                        '.lngCharLower = 5
                        If flag2 = "1" Then
                            .lngCharLower = 36   '23→33
                        Else
                            .lngCharLower = 6    '2006/06/07 張本 ADD 5→6
                        End If

                End Select
                .objFont = objFont
                .lngCharWidth = 0
                .lngPositionY = lngPosY
                .lngCharHeight = 0
                If flag2 = "1" Then
                    .objColor = System.Drawing.Color.Black
                Else
                    .objColor = System.Drawing.Color.White
                End If
            End With
            With udtMHArgs(1)
            ' 2014-05-12 2バイト文字制限解除
                                                                                                                '↓更新　len(trim$(objrows("menugrpnm")))    
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intStart, intEnd)
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), intStart, intEnd)
                If flag2 = "1" Then
                    '.lngCharLower = 5 '5
                    .objColor = System.Drawing.Color.Black
                    If Len(Trim$(objRows("MENUGRPNM"))) > 7 And _
                       Len(Trim$(objRows("MENUGRPNM"))) < 15 Then
                        .lngCharLower = 0
                        .lngPositionY = lngPosY + 28
                    Else
                        .lngCharLower = 36 '2006/06/07 張本 ADD 23→29
                        .lngPositionY = lngPosY + 20
                    End If

                Else
                    .objColor = System.Drawing.Color.White
                    .lngPositionY = lngPosY + 25
                    If Len(Trim$(objRows("MENUGRPNM"))) > 7 And _
                       Len(Trim$(objRows("MENUGRPNM"))) < 15 Then
                        .lngCharLower = 0
                    Else
                        .lngCharLower = 6 '2006/06/07 張本 ADD 5→6
                    End If
                End If
                .objFont = objFont
                .lngCharWidth = 0
                .lngCharHeight = 0
            End With
            '更新　3行目対応 200/02/06
            With udtMHArgs(2)
            ' 2014-05-12 2バイト文字制限解除
                                                                                                                    '↓更新 len(trim$(objrows("menugrpnm")))
                .strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & StrConv(Space(50), VbStrConv.Wide), intReStart, intEnd)
                '.strPutStrings = Mid$(Trim$(objRows("MENUGRPNM")) & Space(50), intReStart, intEnd)
                .objFont = objFont
                .lngCharWidth = 0
                If flag2 = "1" Then
                    .lngCharLower = 36
                    .lngPositionY = lngPosY + 40
                    .objColor = System.Drawing.Color.Black
                Else
                    .lngCharLower = 6 '2006/06/07 張本 ADD 5→6
                    .lngPositionY = lngPosY + 50
                    .objColor = System.Drawing.Color.White
                End If
                .lngCharHeight = 0
            End With

            ' 画像生成処理
            If pCreateMode = typCreateMode.RealTimeTransfar Then
                '更新 2006/02/06 ↓ "SVG200"
                Call LS_CreateMaterial_2(strFilenm & Trim$(objRows("MENUGRPID")), udtMHArgs, pRMenuID & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J & strTimeStamp, DispType.VGA)
            Else
                Call LS_CreateMaterial_2(strFilenm & Trim$(objRows("MENUGRPID")), udtMHArgs, Trim$(objRows("MENUID")) & Trim$(objRows("MENUGRPID")) & GC_EJKBN_J & strTimeStamp, DispType.VGA)
            End If


            lngCnt = lngCnt + 1

        End While

        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 参照画像コピー処理
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM070.FILENM"
        strSQL = strSQL & "  FROM TPM070,"
        strSQL = strSQL & "       TPM040"
        strSQL = strSQL & " WHERE TPM070.IMAGESET  = TPM040.IMAGESET"
        strSQL = strSQL & "   AND TPM070.TRANSKIND = '3'"

        objData = New DataSet()

        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If

        lngCnt = 0
        While lngCnt < objData.Tables("com").Rows.Count
            If Not GF_GetRows(objData, lngCnt, objRows) Then
                Exit Function
            End If

            Dim strobjrow As String = Nothing
            strobjrow = objRows("FILENM")

            Try '                                            ↓更新 2006/02/01 2→3　
                If System.IO.File.Exists(g_udtAppConfig.strNMImgPath3 & "\" & Trim$(objRows("FILENM"))) = False And _
                   System.IO.File.Exists(GF_GetAppInfo("MATERIAL_V") & "\" & Trim$(objRows("FILENM"))) = True Then
                    System.IO.File.Copy(GF_GetAppInfo("MATERIAL_V") & "\" & _
                                        Trim$(objRows("FILENM")), _
                                        g_udtAppConfig.strNMImgPath3 & "\" & _
                                        Trim$(objRows("FILENM")))
                End If
            Catch
                Exit Function
            End Try

            lngCnt = lngCnt + 1
        End While
        pStatus.pgs_Status.Value = pStatus.pgs_Status.Value + 1

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_CreateMaterials_5 = True
    End Function

    Private Sub LS_CreateMaterial_1(ByVal pImgCD As String, _
                                         ByVal pVArgs As typPutVString, _
                                         ByVal pHArgs As typPutHString, _
                                         Optional ByVal pSubCD As String = "", _
                                         Optional ByVal pDisptype As DispType = DispType.XGA)

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim strImgSet As String = Nothing

        '------------------------------
        ' 描画領域生成
        '------------------------------
        Try
            objBitmap = New Bitmap(GF_GetAppInfo("MATERIAL_V") & "\" & LF_GetMaterial(pImgCD, strImgSet))
            objGraph = Graphics.FromImage(objBitmap)
        Catch
            GoTo SYSTEM_ERROR
        End Try

        '------------------------------
        ' 文字列描画処理
        ' (返却値は使用しない)
        '------------------------------
        If Len(Trim$(pVArgs.strPutStrings)) <> 0 Then
            Call LF_PutVString(pVArgs, objGraph, Nothing)
        Else
            Call LF_PutHString(pHArgs, objGraph, Nothing)
        End If

        '------------------------------
        ' 保存処理
        '------------------------------
        If Len(Trim$(pSubCD)) = 0 Then
            If Not LF_SaveMaterial(pImgCD & "_" & strImgSet, objBitmap, pDisptype) Then
                GoTo SYSTEM_ERROR
            End If
        Else
            If Not LF_SaveMaterial(pImgCD & "_" & pSubCD & "_" & strImgSet, objBitmap, pDisptype) Then
                GoTo SYSTEM_ERROR
            End If
        End If

        objBitmap.Dispose()
        objGraph.Dispose()
        Exit Sub

SYSTEM_ERROR:
        Call GS_ErrorTerm("LS_CreateMaterial_1")
        Exit Sub
    End Sub

    ' --------------------------------------------------------------------------------
    ' 　機　　能：画像素材生成処理
    ' 　機能概要：(１素材中に複数行の文字列を描画する処理に対応)
    ' 　引　　数：
    ' 　戻 り 値：
    ' 　履　　歴：2003.12.01 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Sub LS_CreateMaterial_2(ByVal pImgCD As String, _
                                         ByVal pHArgs() As typPutHString, _
                                         Optional ByVal pSubCD As String = "", _
                                         Optional ByVal pDisptype As DispType = DispType.XGA)

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objBitmap As Bitmap
        Dim objGraph As Graphics = Nothing
        Dim strImgSet As String = Nothing
        Dim lngCnt As Long

        '------------------------------
        ' 描画領域生成
        '------------------------------
        Try
            objBitmap = New Bitmap(GF_GetAppInfo("MATERIAL_V") & "\" & LF_GetMaterial(pImgCD, strImgSet))
            objGraph = Graphics.FromImage(objBitmap)
        Catch
            GoTo SYSTEM_ERROR
        End Try

        '------------------------------
        ' 文字列描画処理
        ' (返却値は使用しない)
        '------------------------------
        For lngCnt = 0 To UBound(pHArgs)
            Call LF_PutHString(pHArgs(lngCnt), objGraph, Nothing)
        Next lngCnt

        '------------------------------
        ' 保存処理
        '------------------------------
        '--- (2006.02.14) 定額メニュー対応----------------------------------------------------------------
        ' 定額メニューは別Templateを使用するが、ファイル名は通常のコードでつける
        If pImgCD = "C011YU" Then
            pImgCD = "C010UC"
        End If
        '-------------------------------------------------------------------------------------------------
        If Len(Trim$(pSubCD)) = 0 Then
            If Not LF_SaveMaterial(pImgCD & "_" & strImgSet, objBitmap, pDisptype) Then
                GoTo SYSTEM_ERROR
            End If
        Else
            If Not LF_SaveMaterial(pImgCD & "_" & pSubCD & "_" & strImgSet, objBitmap, pDisptype) Then
                GoTo SYSTEM_ERROR
            End If
        End If

        Exit Sub

SYSTEM_ERROR:
        Call GS_ErrorTerm("LS_CreateMaterial_2")
        Exit Sub
    End Sub

    ' --------------------------------------------------------------------------------
    ' 　機　　能：ガイダンスメッセージ等取得処理
    ' 　機能概要：
    ' 　引　　数：
    ' 　戻 り 値：
    ' 　履　　歴：2003.12.01 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_GetGuide(ByVal pCodeID As String, ByVal pCodeVal As String) As String

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_GetGuide = ""

        '------------------------------
        ' メッセージマスタ取得
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM030.CODENM"
        strSQL = strSQL & "  FROM TPM030"
        strSQL = strSQL & " WHERE TPM030.CODEID  = '" & pCodeID & "'"
        strSQL = strSQL & "   AND TPM030.CODEVAL = '" & pCodeVal & "'"
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        End If
        If objData.Tables("com").Rows.Count = 0 Then
            Exit Function
        End If
        If Not GF_GetRows(objData, 0, objRows) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_GetGuide = Trim$(objRows("CODENM"))

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：画像素材名取得処理
    ' 　機能概要：
    ' 　引　　数：
    ' 　戻 り 値：
    ' 　履　　歴：2003.08.25 ソラン北陸 新規作成
    ' --------------------------------------------------------------------------------
    Private Function LF_GetMaterial(ByVal pImageCD As String, ByRef pImageSet As String) As String

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_GetMaterial = ""

        '------------------------------
        ' 引数チェック
        '------------------------------
        If Len(Trim$(pImageCD)) = 0 Then Exit Function

        '------------------------------
        ' 素材画像名取得
        '------------------------------
        strSQL = ""
        strSQL = strSQL & "SELECT TPM070.FILENM,"
        strSQL = strSQL & "       TPM040.IMAGESET"
        strSQL = strSQL & "  FROM TPM070,"
        strSQL = strSQL & "       TPM040"
        strSQL = strSQL & " WHERE TPM070.IMAGESET = TPM040.IMAGESET"
        strSQL = strSQL & "   AND TPM070.IMAGECD  = '" & pImageCD & "'"
        If Not GF_GetData(strSQL, objData) Then
            Exit Function
        Else
            If objData.Tables("com").Rows.Count = 0 Then
                Exit Function
            End If
        End If

        If Not GF_GetRows(objData, 0, objRows) Then
            Exit Function
        Else
            pImageSet = Trim$(objRows("IMAGESET"))
            LF_GetMaterial = Trim$(objRows("FILENM"))
        End If

    End Function

    Private Function LF_SaveMaterial(ByVal pImageCD As String, _
                                     ByVal pBaseBitmap As Bitmap, _
                                     Optional ByVal pDisptype As DispType = DispType.XGA) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strTime As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_SaveMaterial = False
        strTime = Format$(Now, "yyyyMMddHHmmss")

        Try
            '------------------------------
            ' エンコード方式の指定
            '------------------------------
            Dim myEncoderParameters As New System.Drawing.Imaging.EncoderParameters(1)
            Dim myEncoderParameter As New System.Drawing.Imaging.EncoderParameter(System.Drawing.Imaging.Encoder.Quality, 99)
            myEncoderParameters.Param(0) = myEncoderParameter

            '------------------------------
            ' 保存形式の指定
            '------------------------------
            Dim myImageCodecInfo As System.Drawing.Imaging.ImageCodecInfo
            myImageCodecInfo = GF_GetEncoderInfo("image/jpeg")
            Dim ext As String = myImageCodecInfo.FilenameExtension.Split(";"c)(0)
            ext = System.IO.Path.GetExtension(ext).ToLower()

            '------------------------------
            ' 保存対象領域のトリミング
            '------------------------------
            Dim objSaveBitm As New Bitmap(pBaseBitmap.Width, pBaseBitmap.Height, System.Drawing.Imaging.PixelFormat.Format32bppRgb)
            Dim objPicture As PictureBox = Nothing
            Dim objSaveGrph As Graphics = Graphics.FromImage(objSaveBitm)
            Dim objSaveRect As New Rectangle(0, 0, pBaseBitmap.Width, pBaseBitmap.Height)
            objSaveGrph.DrawImage(pBaseBitmap, objSaveRect, 0, 0, pBaseBitmap.Width, pBaseBitmap.Height, GraphicsUnit.Pixel)

            '------------------------------
            ' 保存処理
            '------------------------------
            Dim saveName As String = Nothing
            Select Case pDisptype
                Case DispType.XGA   '1024x768用画像
                    saveName = System.IO.Path.ChangeExtension(g_udtAppConfig.strNMImgPath & "\" & _
                                                        pImageCD & _
                                                        ".jpg", ext)
                Case DispType.SVGA  '800x600用画像
                    saveName = System.IO.Path.ChangeExtension(g_udtAppConfig.strNMImgPath2 & "\" & _
                                                        pImageCD & _
                                                        ".jpg", ext)
                    '更新 2006/03/10 8インチ対応追加
                Case Else           '640x480用画像（プログラム終了回避の為、条件else)
                    saveName = System.IO.Path.ChangeExtension(g_udtAppConfig.strNMImgPath3 & "\" & _
                                                        pImageCD & _
                                                        ".jpg", ext)
            End Select

            objSaveBitm.Save(saveName, myImageCodecInfo, myEncoderParameters)
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_SaveMaterial = True

    End Function

    '--- (2006.02.14) メニュー切り替え対応 ---------------------------
    ' CNL1530.vb から移設。
    ' 2016.2.2 OA) CrossiNavi→TECレジ 原価等保持(FUMENUの値を保持)対応のため変更
    Public Function GF_PutFUMENUData() As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim intFile As Integer
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtFUMENU As typDataFumenu = Nothing
        Dim udtDummy1 As typDataFumenu = Nothing
        Dim strFPath As String = Nothing
        Dim strOpenItem As String = Nothing   ' 2005.10.24 追加
        ' --- (2008.01.30) CCP印字対応 ---------------------
        Dim strCCPItem As String = Nothing
        ' --------------------------------------------------
        ' --- (2013.10.21) 個別CCP印字対応 -----------------
        Dim strSQL2 As String
        Dim objData2 As New DataSet()
        Dim objRows2 As DataRow = Nothing
        Dim lngCnt2 As Long

     	' --------------------------------------------------
   		Dim dictFUMENU As New Dictionary(Of String, typDataFumenu)
        Dim chkExtGOODSCD As Boolean
        Dim chkExtFumenu As Boolean
        Dim goodsCD As String
        Dim udtFUMENU2 As typDataFumenu = Nothing
        Dim countRow As Integer
        Dim byteStatus単価 As Byte
        Dim strWork() As String = Nothing
        Dim strFPathTmp As String = Nothing
        Dim salesTaxSwitching As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_PutFUMENUData = False
        salesTaxSwitching = Trim$(GF_GetAppInfo("SALES_TAX_SWITCHING"))

        Try
            '------------------------------
            ' FUMENU - OPEN
            '------------------------------
            chkExtFumenu = False
            intFile = FreeFile()
            strFPath = GF_GetAppInfo("OES_PATH") & "\" & GF_GetAppInfo("OES_MENUTBL")
            If System.IO.File.Exists(strFPath) = True Then
                FileOpen(intFile, strFPath, OpenMode.Binary)
                countRow = CInt(New System.IO.FileInfo(strFPath).Length / 147)
                For row As Integer = 1 To countRow
                    udtFUMENU2 = readFumenuData(intFile)
                    dictFUMENU.Add(udtFUMENU2.str商品コード, udtFUMENU2)
                Next
                FileClose(intFile)

                'System.IO.File.SetAttributes(strFPath, IO.FileAttributes.Normal)
                'System.IO.File.Delete(strFPath)
                chkExtFumenu = True
            End If

            strFPathTmp = GF_GetAppInfo("OES_PATH") & "\FUMENU_TEMP"
            If System.IO.File.Exists(strFPathTmp) = True Then
                System.IO.File.Delete(strFPathTmp)
            End If
            FileOpen(intFile, strFPathTmp, OpenMode.Binary, OpenAccess.Write, OpenShare.LockWrite)

            '------------------------------
            ' 商品マスタ全件取得
            '------------------------------
            strSQL = ""
            strSQL = strSQL & "SELECT TPM010.* "
            strSQL = strSQL & "     , ISNULL(TPM260.TAXPRICE, 0) AS TAXPRICE "
            strSQL = strSQL & "  FROM TPM010 LEFT JOIN TPM260 ON TPM010.GOODSCD = TPM260.GOODSCD"

            If Not GF_GetData(strSQL, objData) Then
                Exit Function
            End If

            '------------------------------
            ' FUMENU - 出力処理
            '------------------------------
            lngCnt = 0
            lngCnt2 = 0
            'strOpenItem = GF_GetAppInfo("OPENITEM")     ' 2005.10.24 追加
            ' --- (2008.01.30) CCP印字対応 ---------------------
            'strCCPItem = GF_GetAppInfo("CCPITEM")
            ' --------------------------------------------------
            While lngCnt < objData.Tables("com").Rows.Count
                If Not GF_GetRows(objData, lngCnt, objRows) Then
                    Exit Function
                End If

                ' --- (2013.10.21) 個別CCP印字対応 ------------------------------------------------
                chkExtGOODSCD = False
                goodsCD = Trim$(objRows("GOODSCD"))

                strSQL2 = ""
                'strSQL2 = strSQL2 & "SELECT *"
                'strSQL2 = strSQL2 & "  FROM TPM250"
                'strSQL2 = strSQL2 & " WHERE TPM250.GOODSCD = '" & Trim$(objRows("GOODSCD")) & "'"
                strSQL2 = strSQL2 & "SELECT ISNULL(TPM250.CCPENABLED,0) AS CCPENABLED"
                strSQL2 = strSQL2 & "     , TPM600.*"
                strSQL2 = strSQL2 & "  FROM TPM600 LEFT OUTER JOIN TPM250"
                strSQL2 = strSQL2 & "    ON TPM600.GOODSCD = TPM250.GOODSCD"
                strSQL2 = strSQL2 & " WHERE TPM600.GOODSCD = '" & Trim$(objRows("GOODSCD")) & "'"
                objRows2 = Nothing

                If Not GF_GetData(strSQL2, objData2) Then
                    Exit Function
                End If
                If Not GF_GetRows(objData2, lngCnt2, objRows2) Then
                    strCCPItem = "n"
                Else
                    strCCPItem = Trim$(objRows2("CCPENABLED"))
                    lngCnt2 = lngCnt2 + 1

                End If
                ' ----------------------------------------------------------------------------------

                udtFUMENU = udtDummy1
                With udtFUMENU
                    .str商品コード = Trim$(objRows("GOODSCD"))
                    .str部門コード = Trim$(objRows("BUMONCD"))

                    ' --- (2004.11.04) 出力名称変更 ------------------------
                    '.str商品名１ = Trim$(objRows("GOODSNMJ"))
                    '.str商品名２ = Trim$(objRows("GOODSNMJ"))
                    '                    .str商品名１ = Trim$(objRows("GOODSNMJ3"))
                    .str商品名１ = Trim$(objRows("GOODSNMJ4"))                           '2005.10.05 修正
                    .str商品名２ = Trim$(objRows("GOODSNMJ4"))
                    ' ------------------------------------------------------

                    If salesTaxSwitching = "0" Then
                        '税込表記時
                        .int単価 = CInt(Trim$(objRows("TAXPRICE")))
                    Else
                        '税別表記時
                        .int単価 = CInt(Trim$(objRows("PRICE")))
                    End If
                    Select Case Trim$(objRows("STATUS"))
                        Case "0"
                            .intメニュータイプ = CNL1910.ITEM_TYPE.MAIN_MENU
                        Case "1"
                            .intメニュータイプ = CNL1910.ITEM_TYPE.COMMENT_MENU
                        Case "2"
                            .intメニュータイプ = CNL1910.ITEM_TYPE.SUB_MENU
                        Case "3"
                            .intメニュータイプ = CNL1910.ITEM_TYPE.SET_MENU
                        Case Else
                            Exit Function
                    End Select
                    .str出力先ＫＰ = Trim$(objRows("KCPSTATUS"))
                    '---(2005.10.05) 魚がし向け改修---------------------2005.11.16 削除
                    '.str出力先ＫＰ = "00000000" & _
                    '                "00000000" & _
                    '                "00000000" & _
                    '                "00000000"
                    '---------------------------------------------------
                    .strオプション = Trim$(objRows("SCPNO01")) & "," & _
                                     Trim$(objRows("SCPNO02")) & "," & _
                                     Trim$(objRows("SCPNO03")) & "," & _
                                     Trim$(objRows("SCPNO04")) & "," & _
                                     Trim$(objRows("SCPNO05")) & "," & _
                                     Trim$(objRows("SCPNO06")) & "," & _
                                     Trim$(objRows("SCPNO07")) & "," & _
                                     Trim$(objRows("SCPNO08")) & "," & _
                                     Trim$(objRows("SCPNO09")) & "," & _
                                     Trim$(objRows("SCPNO10")) & "," & _
                                     Trim$(objRows("SCPNO11")) & "," & _
                                     Trim$(objRows("SCPNO12"))
       				' OA: 2015.12.10 (Add)
                    If Len(Trim$(strOpenItem)) = 0 Then
                        byteStatus単価 = 0                                          ' プリセット
                    Else
                        strWork = Split(strOpenItem, "/")
                        If CInt(goodsCD) >= CInt(Trim$(strWork(0))) And _
                           CInt(goodsCD) <= CInt(Trim$(strWork(1))) Then
                            byteStatus単価 = 4                                      ' オープン
                        Else
                            byteStatus単価 = 0                                      ' プリセット
                        End If
                    End If

                    ' --- (2004.09.23) ＨＴＬ用名称項目追加 ----------------
                    .strＨＴＬ名称 = GF_PadSpace(RTrim$(objRows("HTLNM1")), 5) & _
                                     GF_PadSpace(RTrim$(objRows("HTLNM2")), 5)
                    ' ------------------------------------------------------

                    .str自社コード = Trim$(objRows2("INSTORECD"))
                    .intサブ単価 = Trim$(objRows2("SUBPRICE"))
                    .str単価種別 = Trim$(objRows2("PRICETYPE"))
                    .str税ステータス = Trim$(objRows2("TAXTYPE"))
                    .str数量加算 = Trim$(objRows2("QADDITIONALFLG"))
                    .str小計割引割増 = Trim$(objRows2("DISCOUNTFLG"))
                    .str飲食持帰 = Trim$(objRows2("TAKEOUTTYPE"))
                    .strOESメニュー = Trim$(objRows2("OESMENUFLG"))

                    If chkExtFumenu Then
                        If dictFUMENU.ContainsKey(goodsCD) Then
                            .byteＰＬＵコード = dictFUMENU(goodsCD).byteＰＬＵコード    '3
                            .byte商品名カナ = dictFUMENU(goodsCD).byte商品名カナ    '4
                            .byteサブ単価 = dictFUMENU(goodsCD).byteサブ単価    '9
                            .byte原価 = dictFUMENU(goodsCD).byte原価    '10
                            .int機能ステータス１ = dictFUMENU(goodsCD).int機能ステータス１ Or (byteStatus単価 And &H4)  '11
                            .int機能ステータス２ = dictFUMENU(goodsCD).int機能ステータス２ Or (.intメニュータイプ And &H7)  '12
                            .int機能ステータス３ = dictFUMENU(goodsCD).int機能ステータス３  '13
                            .byteＫＰ印字優先順位 = dictFUMENU(goodsCD).byteＫＰ印字優先順位    '15
                            .byte税ステータス = dictFUMENU(goodsCD).byte税ステータス  '17
                            .byteKD表示文字色 = dictFUMENU(goodsCD).byteKD表示文字色  '19
                            .byteKD表示文字背景色 = dictFUMENU(goodsCD).byteKD表示文字背景色  '20
                            .byteKDオーダー経過時間１ = dictFUMENU(goodsCD).byteKDオーダー経過時間１    '21
                            .byteKDオーダー経過時間２ = dictFUMENU(goodsCD).byteKDオーダー経過時間２    '22
                            .byte日計_点数 = dictFUMENU(goodsCD).byte日計_点数    '23
                            .byte日計_金額 = dictFUMENU(goodsCD).byte日計_金額    '24
                            .byte累計_点数 = dictFUMENU(goodsCD).byte累計_点数    '25
                            .byte累計_金額 = dictFUMENU(goodsCD).byte累計_金額    '26

                            chkExtGOODSCD = True
                        End If
                    End If
                End With
                '--- (2005.10.24)　魚がし店向けOPEN価格対応-----------------------
                'If Not GF_PutFUMENU(udtFUMENU, intFile) Then
                '    Exit Function
                'End If
                ' --- (2008.01.30) CCP印字対応 ---------------------
                'If Not GF_PutFUMENU(udtFUMENU, intFile, strOpenItem) Then
                If chkExtGOODSCD Then
                    If Not GF_PutFUMENU_FU(udtFUMENU, intFile, strOpenItem, strCCPItem) Then
                        FileClose(intFile)
                        Exit Function
                    End If
                Else
                    If Not GF_PutFUMENU(udtFUMENU, intFile, strOpenItem, strCCPItem) Then
                        FileClose(intFile)
                        Exit Function
                    End If
                End If
                ' --------------------------------------------------
                '-----------------------------------------------------------------
                lngCnt = lngCnt + 1


            End While

            '------------------------------
            ' FUMENU - CLOSE
            '------------------------------
            FileClose(intFile)

            '------------------------------
            ' - RENAME "FUMENU_TEMP" To GF_GetAppInfo("OES_MENUTBL")
            '------------------------------
            If System.IO.File.Exists(strFPath) = True Then
	            System.IO.File.SetAttributes(strFPath, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFPath)
            End If

            If System.IO.File.Exists(strFPathTmp) = True Then
                System.IO.File.Move(strFPathTmp, strFPath)
            End If

        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_PutFUMENUData = True

    End Function

   ' 2016.2.2 OA) CrossiNavi→TECレジ 原価等保持(FUMENUの値を保持)対応のため追加
    Function readFumenuData(ByVal intFile As Short) As typDataFumenu

        Dim bTmp() As Byte
        Dim udtFUMENU1 As typDataFumenu = Nothing

        ReDim bTmp(1) '1
        FileGet(intFile, bTmp)
        udtFUMENU1.str商品コード = bTmp(0).ToString("X2") & bTmp(1).ToString("X2") 'GOODSCD

        ReDim bTmp(0) '2
        FileGet(intFile, bTmp)

        ReDim bTmp(12) '3
        FileGet(intFile, bTmp)
        udtFUMENU1.byteＰＬＵコード = bTmp

        ReDim bTmp(19) '4
        FileGet(intFile, bTmp)
        udtFUMENU1.byte商品名カナ = bTmp

        ReDim bTmp(19) '5
        FileGet(intFile, bTmp)

        ReDim bTmp(19) '6
        FileGet(intFile, bTmp)

        ReDim bTmp(9) '7
        FileGet(intFile, bTmp)

        ReDim bTmp(4) '8
        FileGet(intFile, bTmp)

        ReDim bTmp(4) '9
        FileGet(intFile, bTmp)
        udtFUMENU1.byteサブ単価 = bTmp

        ReDim bTmp(4) '10
        FileGet(intFile, bTmp)
        udtFUMENU1.byte原価 = bTmp

        ReDim bTmp(0) '11
        FileGet(intFile, bTmp)
        udtFUMENU1.int機能ステータス１ = bTmp(0) And &HFB

        ReDim bTmp(0) '12
        FileGet(intFile, bTmp)
        udtFUMENU1.int機能ステータス２ = bTmp(0) And &HF8

        ReDim bTmp(0) '13
        FileGet(intFile, bTmp)
        udtFUMENU1.int機能ステータス３ = bTmp(0)

        ReDim bTmp(3) '14
        FileGet(intFile, bTmp)

        ReDim bTmp(0) '15
        FileGet(intFile, bTmp)
        udtFUMENU1.byteＫＰ印字優先順位 = bTmp

        ReDim bTmp(0) '16
        FileGet(intFile, bTmp)

        ReDim bTmp(0) '17
        FileGet(intFile, bTmp)
        udtFUMENU1.byte税ステータス = bTmp

        ReDim bTmp(11) '18
        FileGet(intFile, bTmp)

        ReDim bTmp(0) '19
        FileGet(intFile, bTmp)
        udtFUMENU1.byteKD表示文字色 = bTmp

        ReDim bTmp(0) '20
        FileGet(intFile, bTmp)
        udtFUMENU1.byteKD表示文字背景色 = bTmp

        ReDim bTmp(0) '21
        FileGet(intFile, bTmp)
        udtFUMENU1.byteKDオーダー経過時間１ = bTmp

        ReDim bTmp(0) '22
        FileGet(intFile, bTmp)
        udtFUMENU1.byteKDオーダー経過時間２ = bTmp

        ReDim bTmp(4) '23
        FileGet(intFile, bTmp)
        udtFUMENU1.byte日計_点数 = bTmp

        ReDim bTmp(4) '24
        FileGet(intFile, bTmp)
        udtFUMENU1.byte日計_金額 = bTmp

        ReDim bTmp(4) '25
        FileGet(intFile, bTmp)
        udtFUMENU1.byte累計_点数 = bTmp

        ReDim bTmp(4) '26
        FileGet(intFile, bTmp)
        udtFUMENU1.byte累計_金額 = bTmp

        readFumenuData = udtFUMENU1

    End Function


    ' 2005/04/05 引数追加
    'Public Function GF_PutFUMENU(ByVal pArgs As typItemData, ByVal pFileNo As Integer) As Boolean
    ' --- (2008.01.30) CCP印字対応 ---------------------
    'Public Function GF_PutFUMENU(ByVal pArgs As typItemData, ByVal pFileNo As Integer, ByVal pOpenItem As String) As Boolean
    ' 2016.2.2 OA) CrossiNavi→TECレジ 原価等保持(FUMENUの値を保持)対応のため変更
    Public Function GF_PutFUMENU(ByVal pArgs As typDataFumenu, ByVal pFileNo As Integer, ByVal pOpenItem As String, ByVal pCCPItem As String) As Boolean
        ' --------------------------------------------------

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objData() As Byte
        Dim strWork As String = Nothing
        Dim strSP() As String = Nothing
        Dim strWork2() As String = Nothing    ' 2005.10.25 追加
        ' --- (2008.01.30) CCP印字対応 ---------------------
        Dim strWork3() As String = Nothing
        ' --------------------------------------------------
       
        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_PutFUMENU = False

        '------------------------------
        ' メニューマスタ(FUMENU)出力
        '------------------------------
        Try
            ' (01) 商品コード
            ReDim objData(1)
            objData(0) = (16 * (CInt(Mid$(pArgs.str商品コード, 1, 1)))) + (CInt(Mid$(pArgs.str商品コード, 2, 1)))
            objData(1) = (16 * (CInt(Mid$(pArgs.str商品コード, 3, 1)))) + (CInt(Mid$(pArgs.str商品コード, 4, 1)))
            FilePut(pFileNo, objData)

            ' (02) 部門コード
            ReDim objData(0)
            objData(0) = (16 * (CInt(Mid$(pArgs.str部門コード, 1, 1)))) + (CInt(Mid$(pArgs.str部門コード, 2, 1)))
            FilePut(pFileNo, objData)

            ' (03) ＰＬＵコード       - [固定値出力]
            'FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes("0000000000000"))
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(pArgs.str自社コード.Substring(1, 13)))

            ' (04) 名称１(カナ用)     - [固定値出力]
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(Space(20)))

            ' (05) 名称２(漢字１用)
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(GF_PadSpace(pArgs.str商品名１, 20)))

            ' (06) 名称３(漢字２用)
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(GF_PadSpace(pArgs.str商品名２, 20)))

            ' (07) 名称４(漢字３用)   - [固定値出力]
            ' --- (2004.09.23) ＨＴＬ用名称項目追加 ------------------------
            'FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(Space(10)))
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(pArgs.strＨＴＬ名称))
            ' --------------------------------------------------------------

            ' (08) 単価
            ReDim objData(4)
            '2015.10.6 OA) マイナス金額のとき、以降のレコードが欠落する(既存の制約)修正
            'strWork = pArgs.int単価.ToString("000000").PadLeft(6)
            strWork = System.Math.Abs(pArgs.int単価).ToString("000000").PadLeft(6)
            objData(0) = CInt(Mid$(strWork, 1, 1))
            objData(1) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 6, 1)))
            If pArgs.int単価 >= 0 Then
                objData(4) = 12
            Else
                objData(4) = 13
            End If
            FilePut(pFileNo, objData)

            ' (09) サブ単価           - [固定値出力]
            ReDim objData(4)
            'strWork = "000000"
            'objData(0) = 0
            'objData(1) = CInt(Mid$(strWork, 1, 1))
            'objData(2) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            'objData(3) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            'objData(4) = (16 * CInt(Mid$(strWork, 6, 1))) + 12
            strWork = System.Math.Abs(pArgs.intサブ単価).ToString("000000").PadLeft(6)
            objData(0) = CInt(Mid$(strWork, 1, 1))
            objData(1) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 6, 1)))
            If pArgs.int単価 >= 0 Then
                objData(4) = 12
            Else
                objData(4) = 13
            End If
            FilePut(pFileNo, objData)

            ' (10) 原価               - [固定値出力]
            ReDim objData(4)
            strWork = "000000"
            objData(0) = 0
            objData(1) = CInt(Mid$(strWork, 1, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(4) = (16 * CInt(Mid$(strWork, 6, 1))) + 12
            FilePut(pFileNo, objData)

            ' (11) 機能ステータス１   - [固定値出力]
            ReDim objData(0)
            ' --- (2005.10.24) 魚がしセントラル対応-------------------------
            ''objData(0) = 2
            'If Len(Trim$(pOpenItem)) = 0 Then
            '    objData(0) = 2                                          ' プリセット
            'Else
            '    strWork2 = Split(pOpenItem, "/")
            '    If CInt(pArgs.str商品コード) >= CInt(Trim$(strWork2(0))) And _
            '       CInt(pArgs.str商品コード) <= CInt(Trim$(strWork2(1))) Then
            '        objData(0) = 6                                      ' オープン
            '    Else
            '        objData(0) = 2                                      ' プリセット
            '    End If
            'End If
            '単価種別
            If pArgs.str単価種別.Equals("0") Then
                ' プリセット
                objData(0) = 0
            Else
                ' オープン
                objData(0) = 4
            End If
            '飲食／持ち帰り
            Select Case pArgs.str飲食持帰
                Case "0"
                    '飲食のみ
                    objData(0) = objData(0) + 0
                Case "1"
                    '飲食持ち帰り可
                    objData(0) = objData(0) + 2
                Case "2"
                    '持ち帰りのみ
                    objData(0) = objData(0) + 3
                Case Else
                    'その他(飲食持ち帰り可)
                    objData(0) = objData(0) + 2
            End Select
            ' --------------------------------------------------------------
            FilePut(pFileNo, objData)

            ' (12) 機能ステータス２
            ReDim objData(0)
            'objData(0) = pArgs.intメニュータイプ
            'ステータス
            objData(0) = pArgs.intメニュータイプ
            '数量加算
            If pArgs.str数量加算.Equals("0") Then
                ' 不加算
                objData(0) = objData(0) + 0
            Else
                ' 加算
                objData(0) = objData(0) + 16
            End If
            '小計割引／割増
            If pArgs.str小計割引割増.Equals("0") Then
                ' 対象
                objData(0) = objData(0) + 0
            Else
                ' 非対象
                objData(0) = objData(0) + 128
            End If
            FilePut(pFileNo, objData)

            ' (13) 機能ステータス３   - [固定値出力]
            ReDim objData(0)
            'objData(0) = 0
            'OES用メニュー
            If pArgs.strOESメニュー.Equals("0") Then
                ' する
                objData(0) = 0
            Else
                ' しない
                objData(0) = 32
            End If
            FilePut(pFileNo, objData)

            ' (14) ＫＰステータス
            '--- (2006.06.16) STN100バージョンアップ対応 出力先個別対応不要 ------------------
            '--- (2006.05.18) 出力先個別対応 ---------------------------------------------
            '--- 厨房端末が存在する場合は、ＫＣＰ設定しない 
            '--- ＫＣＰのみの場合は、設定する
            '--- ハンディ用商品（4000〜6999）は設定する
            ReDim objData(3)
            'If GF_GetAppInfo("TERM_CHECK") = "0" Or _
            '   (CInt(pArgs.str商品コード) >= 4000 And CInt(pArgs.str商品コード) < 8000) Then
            '    objData(0) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 1, 8), 2)
            '    objData(1) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 9, 8), 2)
            '    objData(2) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 17, 8), 2)
            '    objData(3) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 25, 8), 2)
            'Else
            '    objData(0) = "00000000"
            '    objData(1) = "00000000"
            '    objData(2) = "00000000"
            '    objData(3) = "00000000"
            'End If
            objData(0) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 1, 8), 2)
            objData(1) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 9, 8), 2)
            objData(2) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 17, 8), 2)
            objData(3) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 25, 8), 2)
            '-----------------------------------------------------------------------------
            '---------------------------------------------------------------------------------
            FilePut(pFileNo, objData)

            ' (15) ＫＰ印字優先順位   - [固定値出力]
            ReDim objData(0)
            objData(0) = 0
            FilePut(pFileNo, objData)

            ' (16) ＣＣＰステータス   - [固定値出力]
            'ReDim objData(0)
            ''-- (2008.01.30) CCP印字対応 ---------------------
            'objData(0) = 16
            'If Len(Trim$(pCCPItem)) = 0 Then
            '    objData(0) = 16                                               ' CCP印字あり
            'Else
            '    strWork3 = Split(pCCPItem, "/")
            '    If CInt(pArgs.str商品コード) >= CInt(Trim$(strWork3(0))) And _
            '       CInt(pArgs.str商品コード) <= CInt(Trim$(strWork3(1))) Then
            '        objData(0) = "06"                                         ' CCP印字なし
            '    Else
            '        objData(0) = 16                                           ' CCP印字あり
            '    End If
            'End If
            ReDim objData(0)
            ' --- (2013.10.21) 個別CCP印字対応 -----------------
            objData(0) = 16
            If pCCPItem = "0" Then
                objData(0) = "06"                                           ' CCP印字なし
            Else
                objData(0) = 16                                              ' CCP印字あり

            End If
            ' --------------------------------------------------
            FilePut(pFileNo, objData)

            ' (17) 税ステータス       - [固定値出力]
            ReDim objData(0)
            'objData(0) = 0
            objData(0) = pArgs.str税ステータス
            FilePut(pFileNo, objData)

            ' (18) ＳＣＰステータス
            strSP = Split(pArgs.strオプション, ",")
            If strSP.GetUpperBound(0) <> 11 Then
                Exit Function
            End If

            ReDim objData(11)
            objData(0) = CLng(strSP(0))
            objData(1) = CLng(strSP(1))
            objData(2) = CLng(strSP(2))
            objData(3) = CLng(strSP(3))
            objData(4) = CLng(strSP(4))
            objData(5) = CLng(strSP(5))
            objData(6) = CLng(strSP(6))
            objData(7) = CLng(strSP(7))
            objData(8) = CLng(strSP(8))
            objData(9) = CLng(strSP(9))
            objData(10) = CLng(strSP(10))
            objData(11) = CLng(strSP(11))
            FilePut(pFileNo, objData)

            ' (19) KD 表示文字色      - [固定値出力]
            ReDim objData(0)
            objData(0) = 0
            FilePut(pFileNo, objData)

            ' (20) KD 表示文字背景色  - [固定値出力]
            ReDim objData(0)
            objData(0) = 0
            FilePut(pFileNo, objData)

            ' (21) KD オーダー経過時間１ - [固定値出力]
            ReDim objData(0)
            objData(0) = 0
            FilePut(pFileNo, objData)

            ' (22) KD オーダー経過時間２ - [固定値出力]
            ReDim objData(0)
            objData(0) = 0
            FilePut(pFileNo, objData)

            ' (23) 日計/点数          - [固定値出力]
            ReDim objData(4)
            strWork = "000000"
            objData(0) = 0
            objData(1) = CInt(Mid$(strWork, 1, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(4) = (16 * CInt(Mid$(strWork, 6, 1))) + 12
            FilePut(pFileNo, objData)

            ' (24) 日計/金額          - [固定値出力]
            ReDim objData(4)
            strWork = "000000"
            objData(0) = 0
            objData(1) = CInt(Mid$(strWork, 1, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(4) = (16 * CInt(Mid$(strWork, 6, 1))) + 12
            FilePut(pFileNo, objData)

            ' (25) 累計/点数          - [固定値出力]
            ReDim objData(4)
            strWork = "000000"
            objData(0) = 0
            objData(1) = CInt(Mid$(strWork, 1, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(4) = (16 * CInt(Mid$(strWork, 6, 1))) + 12
            FilePut(pFileNo, objData)

            ' (26) 累計/金額          - [固定値出力]
            ReDim objData(4)
            strWork = "000000"
            objData(0) = 0
            objData(1) = CInt(Mid$(strWork, 1, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(4) = (16 * CInt(Mid$(strWork, 6, 1))) + 12
            FilePut(pFileNo, objData)
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_PutFUMENU = True

    End Function

    ' 2016.2.2 OA) CrossiNavi→TECレジ 原価等保持(FUMENUの値を保持)対応のため追加
    Public Function GF_PutFUMENU_FU(ByVal pArgs As typDataFumenu, ByVal pFileNo As Integer, ByVal pOpenItem As String, ByVal pCCPItem As String) As Boolean
        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objData() As Byte
        Dim strWork As String = Nothing
        Dim strSP() As String = Nothing
        Dim strWork2() As String = Nothing

        ' 初期値設定
        GF_PutFUMENU_FU = False

        ' メニューマスタ(FUMENU)出力
        Try
            ' (01) 商品コード
            ReDim objData(1)
            objData(0) = (16 * (CInt(Mid$(pArgs.str商品コード, 1, 1)))) + (CInt(Mid$(pArgs.str商品コード, 2, 1)))
            objData(1) = (16 * (CInt(Mid$(pArgs.str商品コード, 3, 1)))) + (CInt(Mid$(pArgs.str商品コード, 4, 1)))
            FilePut(pFileNo, objData)

            ' (02) 部門コード
            ReDim objData(0)
            objData(0) = (16 * (CInt(Mid$(pArgs.str部門コード, 1, 1)))) + (CInt(Mid$(pArgs.str部門コード, 2, 1)))
            FilePut(pFileNo, objData)

            ' (03) ＰＬＵコード       
            'FilePut(pFileNo, pArgs.byteＰＬＵコード)
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(pArgs.str自社コード.Substring(1, 13)))

            ' (04) 名称１(カナ用)    
            FilePut(pFileNo, pArgs.byte商品名カナ)

            ' (05) 名称２(漢字１用)
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(GF_PadSpace(pArgs.str商品名１, 20)))

            ' (06) 名称３(漢字２用)
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(GF_PadSpace(pArgs.str商品名２, 20)))

            ' (07) 名称４(漢字３用)   - [固定値出力]
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(pArgs.strＨＴＬ名称))

            ' (08) 単価
            ReDim objData(4)
            strWork = System.Math.Abs(pArgs.int単価).ToString("000000").PadLeft(6)
            objData(0) = CInt(Mid$(strWork, 1, 1))
            objData(1) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 6, 1)))
            If pArgs.int単価 >= 0 Then
                objData(4) = 12
            Else
                objData(4) = 13
            End If
            FilePut(pFileNo, objData)

            ' (09) サブ単価           
            'FilePut(pFileNo, pArgs.byteサブ単価)
            ReDim objData(4)
            strWork = System.Math.Abs(pArgs.intサブ単価).ToString("000000").PadLeft(6)
            objData(0) = CInt(Mid$(strWork, 1, 1))
            objData(1) = (16 * CInt(Mid$(strWork, 2, 1))) + CInt(Mid$(strWork, 3, 1))
            objData(2) = (16 * CInt(Mid$(strWork, 4, 1))) + CInt(Mid$(strWork, 5, 1))
            objData(3) = (16 * CInt(Mid$(strWork, 6, 1)))
            If pArgs.int単価 >= 0 Then
                objData(4) = 12
            Else
                objData(4) = 13
            End If
            FilePut(pFileNo, objData)

            ' (10) 原価           
            FilePut(pFileNo, pArgs.byte原価)

            ' (11) 機能ステータス1
            ReDim objData(0)
            'objData(0) = pArgs.int機能ステータス１
            '単価種別
            If pArgs.str単価種別.Equals("0") Then
                ' プリセット
                objData(0) = 0
            Else
                ' オープン
                objData(0) = 4
            End If
            '飲食／持ち帰り
            Select Case pArgs.str飲食持帰
                Case "0"
                    '飲食のみ
                    objData(0) = objData(0) + 0
                Case "1"
                    '飲食持ち帰り可
                    objData(0) = objData(0) + 2
                Case "2"
                    '持ち帰りのみ
                    objData(0) = objData(0) + 3
                Case Else
                    'その他(飲食持ち帰り可)
                    objData(0) = objData(0) + 2
            End Select
            FilePut(pFileNo, objData)

            ' (12) 機能ステータス２
            ReDim objData(0)
            'objData(0) = pArgs.int機能ステータス２
            'ステータス
            objData(0) = pArgs.intメニュータイプ
            '数量加算
            If pArgs.str数量加算.Equals("0") Then
                ' 不加算
                objData(0) = objData(0) + 0
            Else
                ' 加算
                objData(0) = objData(0) + 16
            End If
            '小計割引／割増
            If pArgs.str小計割引割増.Equals("0") Then
                ' 対象
                objData(0) = objData(0) + 0
            Else
                ' 非対象
                objData(0) = objData(0) + 128
            End If
            FilePut(pFileNo, objData)

            ' (13) 機能ステータス３  
            ReDim objData(0)
            'objData(0) = pArgs.int機能ステータス３
            'OES用メニュー
            If pArgs.strOESメニュー.Equals("0") Then
                ' する
                objData(0) = 0
            Else
                ' しない
                objData(0) = 32
            End If
            FilePut(pFileNo, objData)

            ' (14) ＫＰステータス
            ReDim objData(3)
            objData(0) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 1, 8), 2)
            objData(1) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 9, 8), 2)
            objData(2) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 17, 8), 2)
            objData(3) = Convert.ToInt32(Mid$(pArgs.str出力先ＫＰ, 25, 8), 2)
            '----------------------------------------------------------------
            FilePut(pFileNo, objData)

            ' (15) ＫＰ印字優先順位   
            FilePut(pFileNo, pArgs.byteＫＰ印字優先順位)

            ' (16) ＣＣＰステータス   - [固定値出力]
            ReDim objData(0)
            objData(0) = 16
            If pCCPItem = "0" Then
                objData(0) = "06"                                           ' CCP印字なし
            Else
                objData(0) = 16                                              ' CCP印字あり

            End If
            ' --------------------------------------------------
            FilePut(pFileNo, objData)

            ' (17) 税ステータス       
            'FilePut(pFileNo, pArgs.byte税ステータス)
            ReDim objData(0)
            objData(0) = pArgs.str税ステータス
            FilePut(pFileNo, objData)

            ' (18) ＳＣＰステータス
            strSP = Split(pArgs.strオプション, ",")
            If strSP.GetUpperBound(0) <> 11 Then
                Exit Function
            End If

            ReDim objData(11)
            objData(0) = CLng(strSP(0))
            objData(1) = CLng(strSP(1))
            objData(2) = CLng(strSP(2))
            objData(3) = CLng(strSP(3))
            objData(4) = CLng(strSP(4))
            objData(5) = CLng(strSP(5))
            objData(6) = CLng(strSP(6))
            objData(7) = CLng(strSP(7))
            objData(8) = CLng(strSP(8))
            objData(9) = CLng(strSP(9))
            objData(10) = CLng(strSP(10))
            objData(11) = CLng(strSP(11))
            FilePut(pFileNo, objData)

            ' (19) KD 表示文字色      
            FilePut(pFileNo, pArgs.byteKD表示文字色)

            ' (20) KD 表示文字背景色  
            FilePut(pFileNo, pArgs.byteKD表示文字背景色)

            ' (21) KD オーダー経過時間１ 
            FilePut(pFileNo, pArgs.byteKDオーダー経過時間１)

            ' (22) KD オーダー経過時間２ 
            FilePut(pFileNo, pArgs.byteKDオーダー経過時間２)

            ' (23) 日計/点数          
            FilePut(pFileNo, pArgs.byte日計_点数)

            ' (24) 日計/金額         
            FilePut(pFileNo, pArgs.byte日計_金額)

            ' (25) 累計/点数          
            FilePut(pFileNo, pArgs.byte累計_点数)

            ' (26) 累計/金額         
            FilePut(pFileNo, pArgs.byte累計_金額)
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_PutFUMENU_FU = True

    End Function


    Public Function GF_PutFUMENUData_DB() As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtFUMENU As typItemData = Nothing
        Dim udtDummy1 As typItemData = Nothing
        Dim strFPath As String = Nothing
        Dim strOpenItem As String = Nothing
        Dim strCCPItem As String = Nothing
        Dim da As New DataAccess
        Dim tran As SqlCeTransaction

        ' --- (2013.10.21) 個別CCP印字対応 -----------------
        Dim strSQL2 As String
        Dim objData2 As New DataSet()
        Dim objRows2 As DataRow = Nothing
        Dim lngCnt2 As Long
        ' --------------------------------------------------
        Dim strDataflg As String = Nothing      ' 軽減税率項目対応
        Dim strMenuCd As String = Nothing
        Dim salesTaxSwitching As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_PutFUMENUData_DB = False
        salesTaxSwitching = Trim$(GF_GetAppInfo("SALES_TAX_SWITCHING"))

        Try
            ' MC_FUMENU更新区分取得(0:UPDATE/1:INSERT)
            strDataflg = Trim$(GF_GetAppInfo("OES_COMPASS_UPD_KBN"))

            ' データベース接続開始処理
            da.CleateSqlConnection(Trim$(GF_GetAppInfo("OES_CONNECT_STR")))

            ' トランザクション開始
            tran = da.m_SqlConn.BeginTransaction

            '------------------------------
            ' 商品マスタ全件取得
            '------------------------------
            'strSQL = ""
            'strSQL = strSQL & "SELECT TPM010.* "
            'strSQL = strSQL & "     , ISNULL(TPM260.TAXPRICE, 0) AS TAXPRICE "
            'strSQL = strSQL & "  FROM TPM010 LEFT JOIN TPM260 ON TPM010.GOODSCD = TPM260.GOODSCD"

            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
            strSQL = ""
            strSQL = strSQL & "SELECT TPM010.* "
            strSQL = strSQL & " ,TPM013.TECKCPNM3 "
            strSQL = strSQL & " ,TPM013.HTLNM5 "
            strSQL = strSQL & "     , ISNULL(TPM260.TAXPRICE, 0) AS TAXPRICE "
            strSQL = strSQL & "  FROM TPM010 LEFT JOIN TPM260 ON TPM010.GOODSCD = TPM260.GOODSCD"
            strSQL = strSQL & "  LEFT JOIN TPM013 ON TPM010.GOODSCD = TPM013.GOODSCD"
            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<

            If Not GF_GetData(strSQL, objData) Then
                Exit Function
            End If

            ' UPDATEの場合は全データを上書き、INSERTの場合は全データを削除後に新規登録する
            If strDataflg = "1" Then

                '------------------------------
                ' MC_FUMENU - 更新処理
                '------------------------------
                ' メニューマスタの全削除
                If Not DELETE_MC_FUMENU(da, tran) Then
                    Exit Function
                End If

                lngCnt = 0
                lngCnt2 = 0
                'strOpenItem = GF_GetAppInfo("OPENITEM")
                'strCCPItem = GF_GetAppInfo("CCPITEM")

                While lngCnt < objData.Tables("com").Rows.Count
                    If Not GF_GetRows(objData, lngCnt, objRows) Then
                        Exit Function
                    End If
                    ' --- (2013.10.21) 個別CCP印字対応 --------------------------------------------------
                    strSQL2 = ""
                    strSQL2 = strSQL2 & "SELECT ISNULL(TPM250.CCPENABLED,0) AS CCPENABLED"
                    strSQL2 = strSQL2 & "     , TPM600.*"
                    strSQL2 = strSQL2 & "  FROM TPM600 LEFT OUTER JOIN TPM250"
                    strSQL2 = strSQL2 & "    ON TPM600.GOODSCD = TPM250.GOODSCD"
                    strSQL2 = strSQL2 & " WHERE TPM600.GOODSCD = '" & Trim$(objRows("GOODSCD")) & "'"
                    objRows2 = Nothing

                    If Not GF_GetData(strSQL2, objData2) Then
                        Exit Function
                    End If
                    If Not GF_GetRows(objData2, lngCnt2, objRows2) Then
                        strCCPItem = "n"
                    Else
                        strCCPItem = Trim$(objRows2("CCPENABLED"))
                        lngCnt2 = lngCnt2 + 1

                    End If

                    ' ------------------------------------------------------------------------------------

                    udtFUMENU = udtDummy1
                    With udtFUMENU
                        .str商品コード = Trim$(objRows("GOODSCD"))
                        .str部門コード = Trim$(objRows("BUMONCD"))

                        .str商品名１ = Trim$(objRows("GOODSNMJ4"))
                        .str商品名２ = Trim$(objRows("GOODSNMJ4"))

                        If salesTaxSwitching = "0" Then
                            '税込表記時
                            .int単価 = CInt(Trim$(objRows("TAXPRICE")))
                        Else
                            '税別表記時
                            .int単価 = CInt(Trim$(objRows("PRICE")))
                        End If

                        .intメニュータイプ = CInt(Trim$(objRows("STATUS")))

                        .str出力先ＫＰ = Trim$(objRows("KCPSTATUS"))

                        .strオプション = Trim$(objRows("SCPNO01")) & "," & _
                                         Trim$(objRows("SCPNO02")) & "," & _
                                         Trim$(objRows("SCPNO03")) & "," & _
                                         Trim$(objRows("SCPNO04")) & "," & _
                                         Trim$(objRows("SCPNO05")) & "," & _
                                         Trim$(objRows("SCPNO06")) & "," & _
                                         Trim$(objRows("SCPNO07")) & "," & _
                                         Trim$(objRows("SCPNO08")) & "," & _
                                         Trim$(objRows("SCPNO09")) & "," & _
                                         Trim$(objRows("SCPNO10")) & "," & _
                                         Trim$(objRows("SCPNO11")) & "," & _
                                         Trim$(objRows("SCPNO12"))

                        .strＨＴＬ名称 = GF_PadSpace(RTrim$(objRows("HTLNM1")), 5) & _
                                         GF_PadSpace(RTrim$(objRows("HTLNM2")), 5)

                        '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
                        If GF_GetAppInfo("TICKETUSE") = "1" Then
                            .strチケット印字名称 = Trim$(objRows("TECKCPNM3"))
                        End If
                        If GF_GetAppInfo("HTLNMUSE") = "0" Then
                            .strＨＴＬ名称5 = Trim$(objRows("HTLNM5"))
                        End If
                        '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<

                        .strメニューコード = Trim$(objRows2("MENUCD"))

                        .str自社コード = Trim$(objRows2("INSTORECD"))

                        .int軽減税率単価 = Trim$(objRows2("PRICE_RED"))

                        .intサブ単価 = Trim$(objRows2("SUBPRICE"))

                        .int軽減税率サブ単価 = Trim$(objRows2("SUBPRICE_RED"))

                        .str単価種別 = Trim$(objRows2("PRICETYPE"))

                        .str税ステータス = Trim$(objRows2("TAXTYPE"))

                        .str軽減税率税ステータス = Trim$(objRows2("TAXTYPE_RED"))

                        .str数量加算 = Trim$(objRows2("QADDITIONALFLG"))

                        .str小計割引割増 = Trim$(objRows2("DISCOUNTFLG"))

                        .str飲食持帰 = Trim$(objRows2("TAKEOUTTYPE"))

                        .strOESメニュー = Trim$(objRows2("OESMENUFLG"))

                    End With

                    ' ＳＣＰマスタの追加
                    If Not INSERT_MC_FUMENU(da, tran, udtFUMENU, strOpenItem, strCCPItem) Then
                        Exit Function
                    End If

                    lngCnt = lngCnt + 1
                End While

            Else
                ' --- (2019.8.29) UPDATE処理追加 -----------------
                '------------------------------
                ' MC_FUMENU - UPDATE処理 
                '------------------------------
                lngCnt = 0
                'strOpenItem = GF_GetAppInfo("OPENITEM")
                'strCCPItem = GF_GetAppInfo("CCPITEM")

                While lngCnt < objData.Tables("com").Rows.Count
                    If Not GF_GetRows(objData, lngCnt, objRows) Then
                        Exit Function
                    End If

                    ' --- (2013.10.21) 個別CCP印字対応 --------------------------------------------------
                    strSQL2 = ""
                    strSQL2 = strSQL2 & "SELECT ISNULL(TPM250.CCPENABLED,0) AS CCPENABLED"
                    strSQL2 = strSQL2 & "     , TPM600.*"
                    strSQL2 = strSQL2 & "  FROM TPM600 LEFT OUTER JOIN TPM250"
                    strSQL2 = strSQL2 & "    ON TPM600.GOODSCD = TPM250.GOODSCD"
                    strSQL2 = strSQL2 & " WHERE TPM600.GOODSCD = '" & Trim$(objRows("GOODSCD")) & "'"
                    objRows2 = Nothing

                    If Not GF_GetData(strSQL2, objData2) Then
                        Exit Function
                    End If
                    If Not GF_GetRows(objData2, lngCnt2, objRows2) Then
                        strCCPItem = "n"
                    Else
                        strCCPItem = Trim$(objRows2("CCPENABLED"))
                        lngCnt2 = lngCnt2 + 1

                    End If

                    ' ------------------------------------------------------------------------------------

                    udtFUMENU = udtDummy1
                    With udtFUMENU
                        .str商品コード = Trim$(objRows("GOODSCD"))
                        .str部門コード = Trim$(objRows("BUMONCD"))

                        .str商品名１ = Trim$(objRows("GOODSNMJ4"))
                        .str商品名２ = Trim$(objRows("GOODSNMJ4"))

                        If salesTaxSwitching = "0" Then
                            '税込表記時
                            .int単価 = CInt(Trim$(objRows("TAXPRICE")))
                        Else
                            '税別表記時
                            .int単価 = CInt(Trim$(objRows("PRICE")))
                        End If

                        .intメニュータイプ = CInt(Trim$(objRows("STATUS")))

                        .str出力先ＫＰ = Trim$(objRows("KCPSTATUS"))

                        .strオプション = Trim$(objRows("SCPNO01")) & "," & _
                                         Trim$(objRows("SCPNO02")) & "," & _
                                         Trim$(objRows("SCPNO03")) & "," & _
                                         Trim$(objRows("SCPNO04")) & "," & _
                                         Trim$(objRows("SCPNO05")) & "," & _
                                             Trim$(objRows("SCPNO06")) & "," & _
                                             Trim$(objRows("SCPNO07")) & "," & _
                                             Trim$(objRows("SCPNO08")) & "," & _
                                             Trim$(objRows("SCPNO09")) & "," & _
                                             Trim$(objRows("SCPNO10")) & "," & _
                                             Trim$(objRows("SCPNO11")) & "," & _
                                             Trim$(objRows("SCPNO12"))

                        .strＨＴＬ名称 = GF_PadSpace(RTrim$(objRows("HTLNM1")), 5) & _
                                         GF_PadSpace(RTrim$(objRows("HTLNM2")), 5)

                        '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
                        If GF_GetAppInfo("TICKETUSE") = "1" Then
                            .strチケット印字名称 = Trim$(objRows("TECKCPNM3"))
                        End If
                        If GF_GetAppInfo("HTLNMUSE") = "0" Then
                            .strＨＴＬ名称5 = Trim$(objRows("HTLNM5"))
                        End If
                        '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<

                        .strメニューコード = Trim$(objRows2("MENUCD"))

                        .str自社コード = Trim$(objRows2("INSTORECD"))

                        .int軽減税率単価 = Trim$(objRows2("PRICE_RED"))

                        .intサブ単価 = Trim$(objRows2("SUBPRICE"))

                        .int軽減税率サブ単価 = Trim$(objRows2("SUBPRICE_RED"))

                        .str単価種別 = Trim$(objRows2("PRICETYPE"))

                        .str税ステータス = Trim$(objRows2("TAXTYPE"))

                        .str軽減税率税ステータス = Trim$(objRows2("TAXTYPE_RED"))

                        .str数量加算 = Trim$(objRows2("QADDITIONALFLG"))

                        .str小計割引割増 = Trim$(objRows2("DISCOUNTFLG"))

                        .str飲食持帰 = Trim$(objRows2("TAKEOUTTYPE"))

                        .strOESメニュー = Trim$(objRows2("OESMENUFLG"))
                    End With

                    '軽減税率版FScompass使用時は商品コードにはメニューコードを設定する
                    '上記以外の時は商品コードを設定する
                    If GF_GetAppInfo("OES_TOOL_VER") = "2" Then
                        strMenuCd = Trim$(objRows2("MENUCD"))
                    Else
                        strMenuCd = Format$(CLng(Trim$(objRows("GOODSCD"))), "00000000000000")
                    End If

                    If LF_ChkGOODSCD(da, strMenuCd) Then
                        ' MC_FUMENUに対象レコードあり（レコード更新）

                        ' FUMENUの更新
                        If Not UPDATE_MC_FUMENU(da, tran, udtFUMENU, strMenuCd, strCCPItem) Then
                            Exit Function
                        End If

                    Else
                        ' MC_FUMENUに対象レコードなし（レコード新規追加）

                        ' FUMENUの新規追加
                        If Not INSERT_MC_FUMENU(da, tran, udtFUMENU, strOpenItem, strCCPItem) Then
                            Exit Function
                        End If

                    End If

                    lngCnt = lngCnt + 1
                    ' ------------------------------------
                End While
            End If

            tran.Commit()

        Catch
            Exit Function

        Finally
            ' データベース切断処理
            da.CloseConnection()

        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_PutFUMENUData_DB = True

    End Function

    Private Function DELETE_MC_FUMENU(ByRef da As DataAccess, ByRef tran As SqlCeTransaction) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder

        '------------------------------
        ' 初期値設定
        '------------------------------
        DELETE_MC_FUMENU = False

        strSQL.Append("DELETE FROM MC_FUMENU ")

        '------------------------------
        ' SQL実行
        '------------------------------
        If Not da.UpdDataSql(strSQL.ToString, tran) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        DELETE_MC_FUMENU = True

    End Function

    Private Function INSERT_MC_FUMENU(ByRef da As DataAccess, ByRef tran As SqlCeTransaction, ByVal pArgs As typItemData, _
                                      ByVal pOpenItem As String, ByVal pCCPItem As String) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder
        Dim strWork1() As String = Nothing
        Dim strWork2() As String = Nothing
        Dim strWork3() As String = Nothing

        
        '------------------------------
        ' 初期値設定
        '------------------------------
        INSERT_MC_FUMENU = False

        Try
            strWork2 = Split(pArgs.strオプション, ",")
            If strWork2.GetUpperBound(0) <> 11 Then
                Exit Function
            End If

            strSQL.Append("INSERT INTO MC_FUMENU")
            strSQL.Append("           (CompanyCode,")
            strSQL.Append("            GyotaiCode,")
            strSQL.Append("            StoreCode,")
            strSQL.Append("            LastRenewal,")
            strSQL.Append("            Code,")
            strSQL.Append("            RestNo,")
            strSQL.Append("            OwnCompanyCode,")
            strSQL.Append("            LinkDpCode,")
            strSQL.Append("            Name2,")

            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
            If GF_GetAppInfo("TICKETUSE") = "1" Then
                strSQL.Append("            Name3,") 'チケット印字名称使用時
            End If
            strSQL.Append("            Name4,")

            If GF_GetAppInfo("HTLNMUSE") = "0" Then
                strSQL.Append("            Name5,")  'ハンディ使用時
            End If
            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<

            strSQL.Append("            Tanka_TaxIn,")
            strSQL.Append("            SubTanka_TaxIn,")
            strSQL.Append("            TankaFFU1_TaxIn,")
            strSQL.Append("            TankaFFU1_TaxOut,")
            strSQL.Append("            TankaFFU2_TaxIn,")
            strSQL.Append("            TOSts,")
            strSQL.Append("            TankaSts,")
            strSQL.Append("            AddQtySts,")
            strSQL.Append("            StlDiscSts,")
            strSQL.Append("            TaxSts,")
            strSQL.Append("            ScpSts1_No,")
            strSQL.Append("            ScpSts2_No,")
            strSQL.Append("            ScpSts3_No,")
            strSQL.Append("            ScpSts4_No,")
            strSQL.Append("            ScpSts5_No,")
            strSQL.Append("            ScpSts6_No,")
            strSQL.Append("            ScpSts7_No,")
            strSQL.Append("            ScpSts8_No,")
            strSQL.Append("            ScpSts9_No,")
            strSQL.Append("            ScpSts10_No,")
            strSQL.Append("            ScpSts11_No,")
            strSQL.Append("            ScpSts12_No,")
            strSQL.Append("            OESMenuSts,")
            strSQL.Append("            MenuAttr,")
            strSQL.Append("            FreeSts,")
            strSQL.Append("            FreePrtSts,")
            strSQL.Append("            KcpSts1,")
            strSQL.Append("            KcpSts2,")
            strSQL.Append("            KcpSts3,")
            strSQL.Append("            KcpSts4,")
            strSQL.Append("            KcpSts5,")
            strSQL.Append("            KcpSts6,")
            strSQL.Append("            KcpSts7,")
            strSQL.Append("            KcpSts8,")
            strSQL.Append("            KcpSts9,")
            strSQL.Append("            KcpSts10,")
            strSQL.Append("            KcpSts11,")
            strSQL.Append("            KcpSts12,")
            strSQL.Append("            KcpSts13,")
            strSQL.Append("            KcpSts14,")
            strSQL.Append("            KcpSts15,")
            strSQL.Append("            KcpSts16,")
            strSQL.Append("            KcpSts17,")
            strSQL.Append("            KcpSts18,")
            strSQL.Append("            KcpSts19,")
            strSQL.Append("            KcpSts20,")
            strSQL.Append("            KcpSts21,")
            strSQL.Append("            KcpSts22,")
            strSQL.Append("            KcpSts23,")
            strSQL.Append("            KcpSts24,")
            strSQL.Append("            KcpSts25,")
            strSQL.Append("            KcpSts26,")
            strSQL.Append("            KcpSts27,")
            strSQL.Append("            KcpSts28,")
            strSQL.Append("            KcpSts29,")
            strSQL.Append("            KcpSts30,")
            strSQL.Append("            KcpSts31,")
            strSQL.Append("            KcpSts32,")
            strSQL.Append("            CcpPrtSts)")
            strSQL.Append("    VALUES (" & Trim$(GF_GetAppInfo("OES_COMPANY_CD")) & ", ")                 ' 企業コード
            strSQL.Append("            " & Trim$(GF_GetAppInfo("OES_GYOTAI_CD")) & ", ")                  ' 業態コード
            strSQL.Append("            " & Trim$(GF_GetAppInfo("OES_STORE_CD")) & ", ")                   ' 店舗コード
            strSQL.Append("            " & Format$(Now, "yyyyMMddHHmmss") & ", ")                         ' 最終更新日付時刻

            'strSQL.Append("            '" & Format$(CLng(pArgs.str商品コード), "00000000000000") & "', ") ' メニューコード
            If GF_GetAppInfo("OES_TOOL_VER") = "2" Then ' メニューコード
                strSQL.Append("            '" & pArgs.strメニューコード & "', ")
            Else
                strSQL.Append("            '" & Format$(CLng(pArgs.str商品コード), "00000000000000") & "', ")
            End If

            strSQL.Append("            1,")                                                               ' レストラン(固定値)
            'strSQL.Append("            '00000000000000',")                                               ' 自社コード(固定値)
            strSQL.Append("            '" & pArgs.str自社コード & "',")                                   ' 自社コード
            strSQL.Append("            " & CLng(pArgs.str部門コード) & ", ")                              ' リンクＤＰコード
            'strSQL.Append("            '" & pArgs.str商品名１ & "', ")                                    ' 名称２（漢字１用）
            'strSQL.Append("            '" & pArgs.strＨＴＬ名称 & "', ")                                  ' 名称４（漢字３用）

            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
            strSQL.Append("            '" & pArgs.str商品名１ & "', ")                                    ' 名称２（漢字１用）

            If GF_GetAppInfo("TICKETUSE") = "1" Then
                strSQL.Append("            '" & pArgs.strチケット印字名称 & "', ")                       ' 名称３（チケット印字用）
            End If

            strSQL.Append("            '" & pArgs.strＨＴＬ名称 & "', ")                                 ' 名称４（漢字３用）

            If GF_GetAppInfo("HTLNMUSE") = "0" Then
                strSQL.Append("            '" & pArgs.strＨＴＬ名称5 & "', ")                                 ' 名称５（HTL名称(長)用）
            End If
            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<

            strSQL.Append("            " & CLng(pArgs.int単価) * 100 & ", ")                              ' 単価（内税込み）
            strSQL.Append("            " & CLng(pArgs.intサブ単価) * 100 & ", ")                          ' サブ単価（内税込み）

            If GF_GetAppInfo("OES_TOOL_VER") = "2" And GF_GetAppInfo("TEC_REDUCED_TAX_RATE") = "1" Then
                strSQL.Append("            " & CLng(pArgs.str軽減税率税ステータス) & ", ")                ' 軽減税率税ステータス
                strSQL.Append("            " & CLng(pArgs.int軽減税率単価) * 100 & ", ")                  ' 軽減税率単価
                strSQL.Append("            " & CLng(pArgs.int軽減税率サブ単価) * 100 & ", ")              ' 軽減税率サブ単価
            Else
                strSQL.Append("            0, ")                                                          ' 軽減税率税ステータス
                strSQL.Append("            0, ")                                                          ' 軽減税率単価
                strSQL.Append("            0, ")                                                          ' 軽減税率サブ単価
            End If

            'strSQL.Append("            1, ")                                                             ' 持帰ステータス(固定値)
            strSQL.Append("            " & CLng(pArgs.str飲食持帰) & ", ")                                ' 持帰ステータス

            'If Len(Trim$(pOpenItem)) = 0 Then
            '    strSQL.Append("            0, ")                                                         ' 単価ステータス(プリセット)
            'Else
            '    strWork1 = Split(pOpenItem, "/")
            '    If CInt(pArgs.str商品コード) >= CInt(Trim$(strWork1(0))) And _
            '       CInt(pArgs.str商品コード) <= CInt(Trim$(strWork1(1))) Then
            '        strSQL.Append("            1, ")                                                     ' 単価ステータス(オープン)
            '    Else
            '        strSQL.Append("            0, ")                                                     ' 単価ステータス(プリセット)
            '    End If
            'End If
            strSQL.Append("            " & CLng(pArgs.str単価種別) & ", ")                                ' 単価ステータス

            'strSQL.Append("            1, ")                                                             ' 数量加算(固定値)
            strSQL.Append("            " & CLng(pArgs.str数量加算) & ", ")                                ' 数量加算

            strSQL.Append("            " & CLng(pArgs.str小計割引割増) & ", ")                            ' 小計割引

            'strSQL.Append("            0, ")                                                             ' 税ステータス(固定値)
            strSQL.Append("            " & CLng(pArgs.str税ステータス) & ", ")                            ' 税ステータス
            strSQL.Append("            " & CLng(strWork2(0)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ１
            strSQL.Append("            " & CLng(strWork2(1)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ２
            strSQL.Append("            " & CLng(strWork2(2)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ３
            strSQL.Append("            " & CLng(strWork2(3)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ４
            strSQL.Append("            " & CLng(strWork2(4)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ５
            strSQL.Append("            " & CLng(strWork2(5)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ６
            strSQL.Append("            " & CLng(strWork2(6)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ７
            strSQL.Append("            " & CLng(strWork2(7)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ８
            strSQL.Append("            " & CLng(strWork2(8)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ９
            strSQL.Append("            " & CLng(strWork2(9)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ１０
            strSQL.Append("            " & CLng(strWork2(10)) & ", ")                                     ' ＳＣＰ指示ステータスＮｏ１１
            strSQL.Append("            " & CLng(strWork2(11)) & ", ")                                     ' ＳＣＰ指示ステータスＮｏ１２

            strSQL.Append("            " & CLng(pArgs.strOESメニュー) & ", ")                             ' OESメニュー区分

            strSQL.Append("            " & CLng(pArgs.intメニュータイプ) & ", ")                          ' メニュー属性
            strSQL.Append("            0, ")                                                              ' フリー宣言(固定値)
            strSQL.Append("            1, ")                                                              ' フリー宣言メニュー印字(固定値)
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 8, 1)) & ", ")                  ' ＫＰ１ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 7, 1)) & ", ")                  ' ＫＰ２ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 6, 1)) & ", ")                  ' ＫＰ３ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 5, 1)) & ", ")                  ' ＫＰ４ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 4, 1)) & ", ")                  ' ＫＰ５ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 3, 1)) & ", ")                  ' ＫＰ６ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 2, 1)) & ", ")                  ' ＫＰ７ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 1, 1)) & ", ")                  ' ＫＰ８ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 16, 1)) & ", ")                 ' ＫＰ９ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 15, 1)) & ", ")                 ' ＫＰ１０ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 14, 1)) & ", ")                 ' ＫＰ１１ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 13, 1)) & ", ")                 ' ＫＰ１２ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 12, 1)) & ", ")                 ' ＫＰ１３ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 11, 1)) & ", ")                 ' ＫＰ１４ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 10, 1)) & ", ")                 ' ＫＰ１５ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 9, 1)) & ", ")                  ' ＫＰ１６ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 24, 1)) & ", ")                 ' ＫＰ１７ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 23, 1)) & ", ")                 ' ＫＰ１８ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 22, 1)) & ", ")                 ' ＫＰ１９ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 21, 1)) & ", ")                 ' ＫＰ２０ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 20, 1)) & ", ")                 ' ＫＰ２１ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 19, 1)) & ", ")                 ' ＫＰ２２ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 18, 1)) & ", ")                 ' ＫＰ２３ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 17, 1)) & ", ")                 ' ＫＰ２４ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 32, 1)) & ", ")                 ' ＫＰ２５ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 31, 1)) & ", ")                 ' ＫＰ２６ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 30, 1)) & ", ")                 ' ＫＰ２７ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 29, 1)) & ", ")                 ' ＫＰ２８ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 28, 1)) & ", ")                 ' ＫＰ２９ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 27, 1)) & ", ")                 ' ＫＰ３０ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 26, 1)) & ", ")                 ' ＫＰ３１ステータス
            strSQL.Append("            " & CLng(Mid$(pArgs.str出力先ＫＰ, 25, 1)) & ", ")                 ' ＫＰ３２ステータス

            'If Len(Trim$(pCCPItem)) = 0 Then
            '    strSQL.Append("            1) ")                                                          ' ＣＣＰ印字する／しない(する)
            'Else
            '    strWork3 = Split(pCCPItem, "/")
            '    If CInt(pArgs.str商品コード) >= CInt(Trim$(strWork3(0))) And _
            '       CInt(pArgs.str商品コード) <= CInt(Trim$(strWork3(1))) Then
            '        strSQL.Append("            0) ")                                                      ' ＣＣＰ印字する／しない(しない)
            '    Else
            '        strSQL.Append("            1) ")                                                      ' ＣＣＰ印字する／しない(する)
            '    End If
            'End If

            ' --- (2013.10.21) 個別CCP印字対応 ------------

            If pCCPItem = "0" Then
                strSQL.Append("            0) ")                                                          ' ＣＣＰ印字する／しない(しない)
            Else
                strSQL.Append("            1) ")                                                          ' ＣＣＰ印字する／しない(する)
            End If
            ' ---------------------------------------------

            '------------------------------
            ' SQL実行
            '------------------------------
            If Not da.UpdDataSql(strSQL.ToString, tran) Then
                Exit Function
            End If

        Catch
            Exit Function

        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        INSERT_MC_FUMENU = True

    End Function

    '--- (2019.08.29) UPDATE追加対応 ---------------------------
    Private Function UPDATE_MC_FUMENU(ByRef da As DataAccess, ByRef tran As SqlCeTransaction, ByVal pArgs As typItemData, ByVal pMenuCd As String, ByVal pCCPItem As String) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder
        Dim strWork1() As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        UPDATE_MC_FUMENU = False

        Try
            strWork1 = Split(pArgs.strオプション, ",")
            If strWork1.GetUpperBound(0) <> 11 Then
                Exit Function
            End If

            strSQL.Append("UPDATE MC_FUMENU")
            strSQL.Append("   SET LastRenewal = '" & Format$(Now, "yyyyMMddHHmm") & "', ")               ' 最終更新日付時刻
            strSQL.Append(" OwnCompanyCode =           '" & pArgs.str自社コード & "',")                                   ' 自社コード
            strSQL.Append("   LinkDpCode =        " & CLng(pArgs.str部門コード) & ", ")                              ' リンクＤＰコード
            strSQL.Append("  Name2 =          '" & pArgs.str商品名１ & "', ")                                    ' 名称２（漢字１用）
            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 >>>
            If GF_GetAppInfo("TICKETUSE") = "1" Then
                strSQL.Append("  Name3 =          '" & pArgs.strチケット印字名称 & "', ")                                    ' 名称３（チケット印字用）
            End If
            strSQL.Append("  Name4 =        '" & pArgs.strＨＴＬ名称 & "', ")                                  ' 名称４（漢字３用）
            If GF_GetAppInfo("HTLNMUSE") = "0" Then
                strSQL.Append("  Name5 =          '" & pArgs.strＨＴＬ名称5 & "', ")                                    ' 名称５（HTL名称(長)用）
            End If
            '2021.10.28 ﾁｹｯﾄ印字名称・HTL名称追加　ｸﾚｽｺ北陸 <<<

            strSQL.Append("  Tanka_TaxIn =          " & CLng(pArgs.int単価) * 100 & ", ")                              ' 単価（内税込み）
            strSQL.Append("   SubTanka_TaxIn =         " & CLng(pArgs.intサブ単価) * 100 & ", ")                          ' サブ単価（内税込み）

            If GF_GetAppInfo("OES_TOOL_VER") = "2" And GF_GetAppInfo("TEC_REDUCED_TAX_RATE") = "1" Then
                strSQL.Append("   TankaFFU1_TaxIn =         " & CLng(pArgs.str軽減税率税ステータス) & ", ")                ' 軽減税率税ステータス
                strSQL.Append("   TankaFFU1_TaxOut =         " & CLng(pArgs.int軽減税率単価) * 100 & ", ")                  ' 軽減税率単価
                strSQL.Append("    TankaFFU2_TaxIn=        " & CLng(pArgs.int軽減税率サブ単価) * 100 & ", ")              ' 軽減税率サブ単価
            Else
                strSQL.Append("TankaFFU1_TaxIn = 0, ")                                                          ' 軽減税率税ステータス
                strSQL.Append("  TankaFFU1_TaxOut =          0, ")                                                          ' 軽減税率単価
                strSQL.Append("   TankaFFU2_TaxIn =         0, ")                                                          ' 軽減税率サブ単価
            End If

            strSQL.Append("     TOSts =        " & CLng(pArgs.str飲食持帰) & ", ")                                ' 持帰ステータス
            strSQL.Append("     TankaSts =     " & CLng(pArgs.str単価種別) & ", ")                                ' 単価ステータス
            strSQL.Append("  AddQtySts =          " & CLng(pArgs.str数量加算) & ", ")                                ' 数量加算
            strSQL.Append("    StlDiscSts =        " & CLng(pArgs.str小計割引割増) & ", ")                            ' 小計割引
            strSQL.Append("     TaxSts  = " & CLng(pArgs.str税ステータス) & ", ")                            ' 税ステータス
            strSQL.Append("  ScpSts1_No = " & CLng(strWork1(0)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ１
            strSQL.Append("  ScpSts2_No = " & CLng(strWork1(1)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ２
            strSQL.Append("  ScpSts3_No = " & CLng(strWork1(2)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ３
            strSQL.Append("  ScpSts4_No = " & CLng(strWork1(3)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ４
            strSQL.Append("  ScpSts5_No = " & CLng(strWork1(4)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ５
            strSQL.Append("  ScpSts6_No = " & CLng(strWork1(5)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ６
            strSQL.Append("  ScpSts7_No = " & CLng(strWork1(6)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ７
            strSQL.Append("  ScpSts8_No = " & CLng(strWork1(7)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ８
            strSQL.Append("  ScpSts9_No = " & CLng(strWork1(8)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ９
            strSQL.Append("  ScpSts10_No = " & CLng(strWork1(9)) & ", ")                                      ' ＳＣＰ指示ステータスＮｏ１０
            strSQL.Append("  ScpSts11_No = " & CLng(strWork1(10)) & ", ")                                     ' ＳＣＰ指示ステータスＮｏ１１
            strSQL.Append("  ScpSts12_No = " & CLng(strWork1(11)) & ", ")                                     ' ＳＣＰ指示ステータスＮｏ１２
            strSQL.Append("  OESMenuSts =        " & CLng(pArgs.strOESメニュー) & ", ")                             ' OESメニュー区分
            strSQL.Append("  MenuAttr =         " & CLng(pArgs.intメニュータイプ) & ", ")                          ' メニュー属性
            strSQL.Append("  KcpSts1 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 8, 1)) & ", ")                  ' ＫＰ１ステータス
            strSQL.Append("  KcpSts2 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 7, 1)) & ", ")                  ' ＫＰ２ステータス
            strSQL.Append("  KcpSts3 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 6, 1)) & ", ")                  ' ＫＰ３ステータス
            strSQL.Append("  KcpSts4 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 5, 1)) & ", ")                  ' ＫＰ４ステータス
            strSQL.Append("  KcpSts5 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 4, 1)) & ", ")                  ' ＫＰ５ステータス
            strSQL.Append("  KcpSts6 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 3, 1)) & ", ")                  ' ＫＰ６ステータス
            strSQL.Append("  KcpSts7 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 2, 1)) & ", ")                  ' ＫＰ７ステータス
            strSQL.Append("  KcpSts8 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 1, 1)) & ", ")                  ' ＫＰ８ステータス
            strSQL.Append("  KcpSts9 =          " & CLng(Mid$(pArgs.str出力先ＫＰ, 16, 1)) & ", ")                 ' ＫＰ９ステータス
            strSQL.Append("  KcpSts10 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 15, 1)) & ", ")                 ' ＫＰ１０ステータス
            strSQL.Append("  KcpSts11 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 14, 1)) & ", ")                 ' ＫＰ１１ステータス
            strSQL.Append("  KcpSts12 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 13, 1)) & ", ")                 ' ＫＰ１２ステータス
            strSQL.Append("  KcpSts13 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 12, 1)) & ", ")                 ' ＫＰ１３ステータス
            strSQL.Append("  KcpSts14 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 11, 1)) & ", ")                 ' ＫＰ１４ステータス
            strSQL.Append("  KcpSts15 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 10, 1)) & ", ")                 ' ＫＰ１５ステータス
            strSQL.Append("  KcpSts16 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 9, 1)) & ", ")                  ' ＫＰ１６ステータス
            strSQL.Append("  KcpSts17 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 24, 1)) & ", ")                 ' ＫＰ１７ステータス
            strSQL.Append("  KcpSts18 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 23, 1)) & ", ")                 ' ＫＰ１８ステータス
            strSQL.Append("  KcpSts19 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 22, 1)) & ", ")                 ' ＫＰ１９ステータス
            strSQL.Append("  KcpSts20 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 21, 1)) & ", ")                 ' ＫＰ２０ステータス
            strSQL.Append("  KcpSts21 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 20, 1)) & ", ")                 ' ＫＰ２１ステータス
            strSQL.Append("  KcpSts22 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 19, 1)) & ", ")                 ' ＫＰ２２ステータス
            strSQL.Append("  KcpSts23 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 18, 1)) & ", ")                 ' ＫＰ２３ステータス
            strSQL.Append("  KcpSts24 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 17, 1)) & ", ")                 ' ＫＰ２４ステータス
            strSQL.Append("  KcpSts25 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 32, 1)) & ", ")                 ' ＫＰ２５ステータス
            strSQL.Append("  KcpSts26 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 31, 1)) & ", ")                 ' ＫＰ２６ステータス
            strSQL.Append("  KcpSts27 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 30, 1)) & ", ")                 ' ＫＰ２７ステータス
            strSQL.Append("  KcpSts28 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 29, 1)) & ", ")                 ' ＫＰ２８ステータス
            strSQL.Append("  KcpSts29 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 28, 1)) & ", ")                 ' ＫＰ２９ステータス
            strSQL.Append("  KcpSts30 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 27, 1)) & ", ")                 ' ＫＰ３０ステータス
            strSQL.Append("  KcpSts31 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 26, 1)) & ", ")                 ' ＫＰ３１ステータス
            strSQL.Append("  KcpSts32 =         " & CLng(Mid$(pArgs.str出力先ＫＰ, 25, 1)) & ", ")                 ' ＫＰ３２ステータス
            strSQL.Append("  CcpPrtSts =        " & CLng(pCCPItem) & " ")                                          ' ＣＣＰ印字
            strSQL.Append(" WHERE CompanyCode = '" & Trim$(GF_GetAppInfo("OES_COMPANY_CD")) & "' ")     ' 企業コード
            strSQL.Append("   AND GyotaiCode  = '" & Trim$(GF_GetAppInfo("OES_GYOTAI_CD")) & "' ")      ' 業態コード
            strSQL.Append("   AND StoreCode   = '" & Trim$(GF_GetAppInfo("OES_STORE_CD")) & "' ")       ' 店舗コード
            strSQL.Append("   AND Code        = '" & pMenuCd & "' ")                                    ' メニューコード


            '------------------------------
            ' SQL実行
            '------------------------------
            If Not da.UpdDataSql(strSQL.ToString, tran) Then
                Exit Function
            End If

        Catch

            Exit Function

        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        UPDATE_MC_FUMENU = True

    End Function

    Private Function LF_ChkGOODSCD(ByRef da As DataAccess, ByVal pMenuCd As String) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder


        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ChkGOODSCD = False

        strSQL.Append("SELECT Code ")                                                           ' メニューコード
        strSQL.Append("  FROM MC_FUMENU ")
        strSQL.Append(" WHERE CompanyCode = '" & Trim$(GF_GetAppInfo("OES_COMPANY_CD")) & "' ") ' 企業コード
        strSQL.Append("   AND GyotaiCode  = '" & Trim$(GF_GetAppInfo("OES_GYOTAI_CD")) & "' ")  ' 業態コード
        strSQL.Append("   AND StoreCode   = '" & Trim$(GF_GetAppInfo("OES_STORE_CD")) & "' ")   ' 店舗コード
        strSQL.Append("   AND Code        = '" & pMenuCd & "' ")                                ' メニューコード

        '------------------------------
        ' SQL実行
        '------------------------------
        If Not da.GetDataSql(strSQL.ToString) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ChkGOODSCD = True

    End Function
    '---------------------------------------------------------

    '--- (2006.06.13) オプション登録画面対応 ---------------------------
    Public Function GF_PutFSCPData() As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim intFile As Integer
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtFSCP As typSCPData = Nothing
        Dim udtDummy1 As typSCPData = Nothing
        Dim strFPath As String = Nothing

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_PutFSCPData = False

        Try
            '------------------------------
            ' FSCP - OPEN
            '------------------------------
            intFile = FreeFile()
            strFPath = GF_GetAppInfo("OES_PATH") & "\" & GF_GetAppInfo("OES_SCPTBL")
            If System.IO.File.Exists(strFPath) = True Then
                System.IO.File.SetAttributes(strFPath, IO.FileAttributes.Normal)
                System.IO.File.Delete(strFPath)
            End If
            FileOpen(intFile, strFPath, OpenMode.Binary, OpenAccess.Write, OpenShare.LockWrite)

            '------------------------------
            ' ＳＣＰマスタ全件取得
            '------------------------------
            strSQL = ""
            strSQL = strSQL & "SELECT *"
            strSQL = strSQL & "  FROM TPM100"

            If Not GF_GetData(strSQL, objData) Then
                Exit Function
            End If

            '------------------------------
            ' FSCP - 出力処理
            '------------------------------
            lngCnt = 0
            While lngCnt < objData.Tables("com").Rows.Count
                If Not GF_GetRows(objData, lngCnt, objRows) Then
                    Exit Function
                End If

                udtFSCP = udtDummy1
                With udtFSCP
                    .strSCPNo = Trim$(objRows("SCPNO"))

                    .strガイダンス = Trim$(objRows("GUIDE"))

                    .str商品コード = Trim$(objRows("GOODSCD1")) & "," & _
                                     Trim$(objRows("GOODSCD2")) & "," & _
                                     Trim$(objRows("GOODSCD3")) & "," & _
                                     Trim$(objRows("GOODSCD4")) & "," & _
                                     Trim$(objRows("GOODSCD5")) & "," & _
                                     Trim$(objRows("GOODSCD6")) & "," & _
                                     Trim$(objRows("GOODSCD7")) & "," & _
                                     Trim$(objRows("GOODSCD8")) & "," & _
                                     Trim$(objRows("GOODSCD9")) & "," & _
                                     Trim$(objRows("GOODSCD10")) & "," & _
                                     Trim$(objRows("GOODSCD11")) & "," & _
                                     Trim$(objRows("GOODSCD12")) & "," & _
                                     Trim$(objRows("GOODSCD13")) & "," & _
                                     Trim$(objRows("GOODSCD14")) & "," & _
                                     Trim$(objRows("GOODSCD15")) & "," & _
                                     Trim$(objRows("GOODSCD16"))

                End With

                If Not GF_PutFSCP(udtFSCP, intFile) Then
                    FileClose(intFile)
                    Exit Function
                End If

                lngCnt = lngCnt + 1
            End While

            '------------------------------
            ' FSCP - CLOSE
            '------------------------------
            FileClose(intFile)
        Catch
            Exit Function
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_PutFSCPData = True

    End Function

    Public Function GF_PutFSCP(ByVal pArgs As typSCPData, ByVal pFileNo As Integer) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim objData() As Byte
        Dim strWork() As String = Nothing
        Dim lngCnt As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_PutFSCP = False

        Try
            strWork = Split(pArgs.str商品コード, ",")
            If strWork.GetUpperBound(0) <> 15 Then
                Exit Function
            End If

            ' (1) ＳＣＰ
            ReDim objData(0)
            objData(0) = CLng(pArgs.strSCPNo)
            FilePut(pFileNo, objData)

            ' (2) ガイダンス
            FilePut(pFileNo, System.Text.Encoding.GetEncoding(932).GetBytes(GF_PadSpace(pArgs.strガイダンス, 20)))

            ' (3) メニュー１〜１６
            ReDim objData(31)
            For lngCnt = 0 To 15
                strWork(lngCnt) = Format$(CLng(strWork(lngCnt)), "0000")
                objData(lngCnt * 2) = (16 * CInt(Mid$(strWork(lngCnt), 1, 1))) + CInt(Mid$(strWork(lngCnt), 2, 1))
                objData((lngCnt * 2) + 1) = (16 * CInt(Mid$(strWork(lngCnt), 3, 1))) + CInt(Mid$(strWork(lngCnt), 4, 1))
            Next
            FilePut(pFileNo, objData)

        Catch
            Exit Function
        End Try

        GF_PutFSCP = True

    End Function

    ' --------------------------------------------------------------------------------
    ' 　機　　能：ＳＣＰマスタ(MC_FSCP)更新処理
    ' 　機能概要：FScompassのMC_FSCP(SCPマスタ)を更新する
    ' 　引　　数：なし
    ' 　戻 り 値：
    ' 　履　　歴：2012.03.29 ソラン北陸
    ' --------------------------------------------------------------------------------
    Public Function GF_PutFSCPData_DB() As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim da As New DataAccess
        Dim strSQL As String = Nothing
        Dim objData As New DataSet()
        Dim objRows As DataRow = Nothing
        Dim lngCnt As Long
        Dim udtFSCP As typSCPData = Nothing
        Dim udtDummy1 As typSCPData = Nothing
        Dim tran As SqlCeTransaction
        Dim strDataflg As String = Trim$(GF_GetAppInfo("OES_COMPASS_UPD_KBN2"))

        '------------------------------
        ' 初期値設定
        '------------------------------
        GF_PutFSCPData_DB = False

        Try
            ' データベース接続開始処理
            da.CleateSqlConnection(Trim$(GF_GetAppInfo("OES_CONNECT_STR")))

            tran = da.m_SqlConn.BeginTransaction

            '------------------------------
            ' ＳＣＰマスタ全件取得
            '------------------------------
            strSQL = ""
            strSQL = strSQL & "SELECT *"
            strSQL = strSQL & "  FROM TPM100"

            If Not GF_GetData(strSQL, objData) Then
                Exit Function
            End If

            ' UPDATEの場合は全データを上書き、INSERTの場合は全データを削除後に新規登録する
            If strDataflg = "1" Then

                '------------------------------
                ' MC_FSCP - 更新処理
                '------------------------------
                ' ＳＣＰマスタの全削除
                If Not DELETE_MC_FSCP(da, tran) Then
                    Exit Function
                End If

                lngCnt = 0
                While lngCnt < objData.Tables("com").Rows.Count
                    If Not GF_GetRows(objData, lngCnt, objRows) Then
                        Exit Function
                    End If

                    udtFSCP = udtDummy1
                    With udtFSCP
                        .strSCPNo = Trim$(objRows("SCPNO"))

                        .strガイダンス = Trim$(objRows("GUIDE"))

                        .str商品コード = Trim$(objRows("GOODSCD1")) & "," & _
                                         Trim$(objRows("GOODSCD2")) & "," & _
                                         Trim$(objRows("GOODSCD3")) & "," & _
                                         Trim$(objRows("GOODSCD4")) & "," & _
                                         Trim$(objRows("GOODSCD5")) & "," & _
                                         Trim$(objRows("GOODSCD6")) & "," & _
                                         Trim$(objRows("GOODSCD7")) & "," & _
                                         Trim$(objRows("GOODSCD8")) & "," & _
                                         Trim$(objRows("GOODSCD9")) & "," & _
                                         Trim$(objRows("GOODSCD10")) & "," & _
                                         Trim$(objRows("GOODSCD11")) & "," & _
                                         Trim$(objRows("GOODSCD12")) & "," & _
                                         Trim$(objRows("GOODSCD13")) & "," & _
                                         Trim$(objRows("GOODSCD14")) & "," & _
                                         Trim$(objRows("GOODSCD15")) & "," & _
                                         Trim$(objRows("GOODSCD16"))

                    End With

                    ' ＳＣＰマスタの追加
                    If Not INSERT_MC_FSCP(da, tran, udtFSCP) Then
                        Exit Function
                    End If

                    lngCnt = lngCnt + 1
                End While

            Else

                '------------------------------
                ' MC_FSCP - UPDATE処理
                '------------------------------
                lngCnt = 0

                While lngCnt < objData.Tables("com").Rows.Count
                    If Not GF_GetRows(objData, lngCnt, objRows) Then
                        Exit Function
                    End If

                    udtFSCP = udtDummy1
                    With udtFSCP
                        .strSCPNo = Trim$(objRows("SCPNO"))

                        .strガイダンス = Trim$(objRows("GUIDE"))

                        .str商品コード = Trim$(objRows("GOODSCD1")) & "," & _
                                         Trim$(objRows("GOODSCD2")) & "," & _
                                         Trim$(objRows("GOODSCD3")) & "," & _
                                         Trim$(objRows("GOODSCD4")) & "," & _
                                         Trim$(objRows("GOODSCD5")) & "," & _
                                         Trim$(objRows("GOODSCD6")) & "," & _
                                         Trim$(objRows("GOODSCD7")) & "," & _
                                         Trim$(objRows("GOODSCD8")) & "," & _
                                         Trim$(objRows("GOODSCD9")) & "," & _
                                         Trim$(objRows("GOODSCD10")) & "," & _
                                         Trim$(objRows("GOODSCD11")) & "," & _
                                         Trim$(objRows("GOODSCD12")) & "," & _
                                         Trim$(objRows("GOODSCD13")) & "," & _
                                         Trim$(objRows("GOODSCD14")) & "," & _
                                         Trim$(objRows("GOODSCD15")) & "," & _
                                         Trim$(objRows("GOODSCD16"))

                    End With

                    If LF_ChkSCPNO(da, Trim$(objRows("SCPNO"))) Then
                        ' MC_FSCPに対象レコードあり（レコード更新）

                        ' MC_FSCPの更新
                        If Not UPDATE_MC_FSCP(da, tran, udtFSCP) Then
                            Exit Function
                        End If

                    Else
                        ' MC_FSCPに対象レコードなし（レコード新規追加）

                        ' MC_FSCPの追加
                        If Not INSERT_MC_FSCP(da, tran, udtFSCP) Then
                            Exit Function
                        End If

                    End If

                    lngCnt = lngCnt + 1
                End While

            End If

            tran.Commit()

        Catch
            Exit Function

        Finally
            ' データベース切断処理
            da.CloseConnection()
        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        GF_PutFSCPData_DB = True

    End Function

    Private Function DELETE_MC_FSCP(ByRef da As DataAccess, ByRef tran As SqlCeTransaction) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder

        '------------------------------
        ' 初期値設定
        '------------------------------
        DELETE_MC_FSCP = False

        strSQL.Append("DELETE FROM MC_FSCP ")

        '------------------------------
        ' SQL実行
        '------------------------------
        If Not da.UpdDataSql(strSQL.ToString, tran) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        DELETE_MC_FSCP = True

    End Function

    Private Function INSERT_MC_FSCP(ByRef da As DataAccess, ByRef tran As SqlCeTransaction, ByVal pArgs As typSCPData) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder
        Dim strWork() As String = Nothing
        Dim lngCnt As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        INSERT_MC_FSCP = False

        Try
            strWork = Split(pArgs.str商品コード, ",")
            If strWork.GetUpperBound(0) <> 15 Then
                Exit Function
            End If

            strSQL.Append("INSERT INTO MC_FSCP ")
            strSQL.Append("    VALUES (" & Trim$(GF_GetAppInfo("OES_COMPANY_CD")) & ", ")
            strSQL.Append("            " & Trim$(GF_GetAppInfo("OES_GYOTAI_CD")) & ", ")
            strSQL.Append("            " & Trim$(GF_GetAppInfo("OES_STORE_CD")) & ", ")
            strSQL.Append("            " & Format$(Now, "yyyyMMddHHmmss") & ", ")
            strSQL.Append("            " & CLng(pArgs.strSCPNo) & ", ")
            strSQL.Append("            '" & GF_PadSpace(pArgs.strガイダンス, 20) & "', ")

            For lngCnt = 0 To 15
                strSQL.Append("            '" & Format$(CLng(strWork(lngCnt)), "00000000000000") & "', ")
            Next

            '--- (2021.08.16)FScompassNS対応(START) --------
            If Trim$(GF_GetAppInfo("OES_MC_FSCP_32")) = "1" Then
                'FScompassNS連動時はFSCPの項目数は16ではなく32とする
                For lngCnt = 0 To 15
                    strSQL.Append("            '00000000000000', ")
                Next
            End If
            '--- (2021.08.16)FScompassNS対応(END) ----------

            strSQL.Append("            0, ")
            strSQL.Append("            0) ")

            '------------------------------
            ' SQL実行
            '------------------------------
            If Not da.UpdDataSql(strSQL.ToString, tran) Then
                Exit Function
            End If

        Catch
            Exit Function

        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        INSERT_MC_FSCP = True

    End Function

    Private Function LF_ChkSCPNO(ByRef da As DataAccess, ByVal pScpNo As String) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder

        '------------------------------
        ' 初期値設定
        '------------------------------
        LF_ChkSCPNO = False

        strSQL.Append("SELECT ScpNo ")                                                          ' メニューコード
        strSQL.Append("  FROM MC_FSCP ")
        strSQL.Append(" WHERE CompanyCode = '" & Trim$(GF_GetAppInfo("OES_COMPANY_CD")) & "' ") ' 企業コード
        strSQL.Append("   AND GyotaiCode  = '" & Trim$(GF_GetAppInfo("OES_GYOTAI_CD")) & "' ")  ' 業態コード
        strSQL.Append("   AND StoreCode   = '" & Trim$(GF_GetAppInfo("OES_STORE_CD")) & "' ")   ' 店舗コード
        strSQL.Append("   AND ScpNo       = '" & pScpNo & "' ")                                 ' SCPNO

        '------------------------------
        ' SQL実行
        '------------------------------
        If Not da.GetDataSql(strSQL.ToString) Then
            Exit Function
        End If

        '------------------------------
        ' 返却値設定
        '------------------------------
        LF_ChkSCPNO = True

    End Function

    Private Function UPDATE_MC_FSCP(ByRef da As DataAccess, ByRef tran As SqlCeTransaction, ByVal pArgs As typSCPData) As Boolean

        '------------------------------
        ' 内部変数定義
        '------------------------------
        Dim strSQL As New System.Text.StringBuilder
        Dim strWork() As String = Nothing
        Dim lngCnt As Long

        '------------------------------
        ' 初期値設定
        '------------------------------
        UPDATE_MC_FSCP = False

        Try
            strWork = Split(pArgs.str商品コード, ",")
            If strWork.GetUpperBound(0) <> 15 Then
                Exit Function
            End If

            strSQL.Append("UPDATE MC_FSCP ")
            strSQL.Append("   SET LastRenewal = '" & Format$(Now, "yyyyMMddHHmmss") & "' ")             ' 最終更新日付時刻
            strSQL.Append("     , GidName     = '" & GF_PadSpace(pArgs.strガイダンス, 20) & "' ")       ' ガイダンス名

            For lngCnt = 0 To 15
                strSQL.Append("     , MenuCode" & lngCnt + 1 & " = '" & Format$(CLng(strWork(lngCnt)), "00000000000000") & "' ") 'メニューコード１〜１６
            Next

            If Trim$(GF_GetAppInfo("OES_MC_FSCP_32")) = "1" Then
                'FScompassNS連動時はFSCPの項目数は16ではなく32とする
                For lngCnt = 0 To 15
                    strSQL.Append("     , MenuCode" & lngCnt + 17 & " = '00000000000000' ") 'メニューコード１７〜３２
                Next
            End If

            strSQL.Append(" WHERE CompanyCode = '" & Trim$(GF_GetAppInfo("OES_COMPANY_CD")) & "' ")     ' 企業コード
            strSQL.Append("   AND GyotaiCode  = '" & Trim$(GF_GetAppInfo("OES_GYOTAI_CD")) & "' ")      ' 業態コード
            strSQL.Append("   AND StoreCode   = '" & Trim$(GF_GetAppInfo("OES_STORE_CD")) & "' ")       ' 店舗コード
            strSQL.Append("   AND ScpNo       = " & CLng(pArgs.strSCPNo))                               ' SCPNO

            '------------------------------
            ' SQL実行
            '------------------------------
            If Not da.UpdDataSql(strSQL.ToString, tran) Then
                Exit Function
            End If

        Catch

            Exit Function

        End Try

        '------------------------------
        ' 返却値設定
        '------------------------------
        UPDATE_MC_FSCP = True

    End Function

End Module
